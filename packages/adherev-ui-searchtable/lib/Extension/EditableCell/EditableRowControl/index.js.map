{"version":3,"file":"index.js","sources":["Extension/EditableCell/EditableRowControl/index.js"],"sourcesContent":["\"use strict\";\n\nrequire(\"core-js/modules/es.object.define-property.js\");\nrequire(\"core-js/modules/es.number.constructor.js\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar SearchTable_1 = require(\"../../../SearchTable\");\nexports.default = {\n  name: 'adv-searchtable-editable-row-control',\n  props: {\n    rowKey: {\n      type: String\n    },\n    editorRowId: {\n      type: String\n    },\n    rowIndex: {\n      type: Number\n    },\n    record: {\n      type: Object,\n      default: function _default() {\n        return {};\n      }\n    },\n    renderEditorRow: {\n      type: Function\n    },\n    renderSave: {\n      type: Function\n    },\n    renderCancel: {\n      type: Function\n    },\n    onSave: {\n      type: Function\n    },\n    onEditor: {\n      type: Function\n    }\n  },\n  emits: ['renderEditorRow', 'renderSave', 'renderCancel'],\n  inject: ['getFormIns', 'getContext'],\n  methods: {\n    renderDefaultEditorRow: function renderDefaultEditorRow(h) {\n      // return <a>{Intl.tv('编辑行')}</a>;\n      return h(\"a\", [\"\\u7F16\\u8F91\\u884C\"]);\n    },\n    renderDefaultCancel: function renderDefaultCancel(h) {\n      // return <a>{Intl.tv('取消')}</a>;\n      return h(\"a\", [\"\\u53D6\\u6D88\"]);\n    },\n    renderDefaultSave: function renderDefaultSave(h) {\n      // return <a>{Intl.tv('保存')}</a>;\n      return h(\"a\", [\"\\u4FDD\\u5B58\"]);\n    },\n    validateFieldsSuccess: function validateFieldsSuccess(values) {\n      var _this = this;\n      if (this.onSave) {\n        this.onSave(values).then(function () {\n          return _this.updateEditorCellRowData(values);\n        });\n        return;\n      }\n      this.updateEditorCellRowData(values);\n    },\n    updateEditorCellRowData: function updateEditorCellRowData(values) {\n      var _this = this;\n      var _a, _b, _c;\n      var context = (_b = (_a = this.getContext) === null || _a === void 0 ? void 0 : _a.call(this)) === null || _b === void 0 ? void 0 : _b.context;\n      (_c = context === null || context === void 0 ? void 0 : context.updateEditorCellRowData({\n        values: values,\n        record: this.record,\n        rowIndex: this.rowIndex\n      })) === null || _c === void 0 ? void 0 : _c.then(function () {\n        return _this.reset();\n      });\n    },\n    updateRowEdit: function updateRowEdit() {\n      var _a, _b;\n      var context = (_b = (_a = this.getContext) === null || _a === void 0 ? void 0 : _a.call(this)) === null || _b === void 0 ? void 0 : _b.context;\n      if (context) {\n        context.editorRowId = this.record[this.rowKey];\n      }\n    },\n    reset: function reset() {\n      var _a, _b;\n      var context = (_b = (_a = this.getContext) === null || _a === void 0 ? void 0 : _a.call(this)) === null || _b === void 0 ? void 0 : _b.context;\n      if (context) {\n        context.editorRowId = '';\n      }\n    },\n    $onEditor: function $onEditor() {\n      var _this = this;\n      var _a, _b;\n      if (this.onEditor) {\n        (_b = (_a = this.onEditor) === null || _a === void 0 ? void 0 : _a.call(this, this.record[this.rowKey])) === null || _b === void 0 ? void 0 : _b.then(function () {\n          return _this.updateRowEdit();\n        });\n        return;\n      }\n      this.updateRowEdit();\n    }\n  },\n  render: function render(h) {\n    var _this = this;\n    var _a, _b, _c, _d, _e, _f, _g, _h, _j;\n    var _k = this,\n      editorRowId = _k.editorRowId,\n      record = _k.record,\n      rowKey = _k.rowKey;\n    var form = this.getFormIns();\n    return h(\"div\", {\n      \"class\": \"\".concat(SearchTable_1.selectorPrefix, \"-editor-row-control\")\n    }, [editorRowId !== record[rowKey] && h(\"div\", {\n      \"class\": \"\".concat(SearchTable_1.selectorPrefix, \"-editor-row-control-edit\"),\n      \"on\": {\n        \"click\": this.$onEditor\n      }\n    }, [((_b = (_a = this.$slots) === null || _a === void 0 ? void 0 : _a[this.renderEditorRow]) === null || _b === void 0 ? void 0 : _b.call(_a)) || ((_c = this === null || this === void 0 ? void 0 : this.renderEditorRow) === null || _c === void 0 ? void 0 : _c.call(this, h)) || this.renderDefaultEditorRow(h)]), editorRowId === record[rowKey] && h(\"div\", {\n      \"class\": \"\".concat(SearchTable_1.selectorPrefix, \"-editor-row-control-save-cancel\")\n    }, [h(\"div\", {\n      \"class\": \"\".concat(SearchTable_1.selectorPrefix, \"-editor-row-control-save-cancel-item\"),\n      \"on\": {\n        \"click\": function click() {\n          return form === null || form === void 0 ? void 0 : form.validateFields().then(function (values) {\n            return _this.validateFieldsSuccess(values);\n          });\n        }\n      }\n    }, [((_e = (_d = this.$slots) === null || _d === void 0 ? void 0 : _d[this.renderSave]) === null || _e === void 0 ? void 0 : _e.call(_d)) || ((_f = this === null || this === void 0 ? void 0 : this.renderSave) === null || _f === void 0 ? void 0 : _f.call(this, h)) || this.renderDefaultSave(h)]), h(\"div\", {\n      \"class\": \"\".concat(SearchTable_1.selectorPrefix, \"-editor-row-control-save-cancel-item\"),\n      \"on\": {\n        \"click\": this.reset\n      }\n    }, [((_h = (_g = this.$slots) === null || _g === void 0 ? void 0 : _g[this.renderCancel]) === null || _h === void 0 ? void 0 : _h.call(_g)) || ((_j = this === null || this === void 0 ? void 0 : this.renderCancel) === null || _j === void 0 ? void 0 : _j.call(this, h)) || this.renderDefaultCancel(h)])])]);\n  }\n};"],"names":["require","Object","defineProperty","exports","value","SearchTable_1","default","name","props","rowKey","type","String","editorRowId","rowIndex","Number","record","renderEditorRow","Function","renderSave","renderCancel","onSave","onEditor","emits","inject","methods","renderDefaultEditorRow","h","renderDefaultCancel","renderDefaultSave","validateFieldsSuccess","values","_this","this","then","updateEditorCellRowData","context","_b","_a","getContext","call","_c","reset","updateRowEdit","$onEditor","render","_d","_j","_k","form","getFormIns","class","concat","selectorPrefix","on","click","$slots","validateFields","_e","_f","_h","_g"],"mappings":"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"}