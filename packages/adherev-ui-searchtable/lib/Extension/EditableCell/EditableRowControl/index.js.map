{"version":3,"file":"index.js","sources":["Extension/EditableCell/EditableRowControl/index.js"],"sourcesContent":["\"use strict\";\n\nrequire(\"core-js/modules/es.object.define-property.js\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar tslib_1 = require(\"tslib\");\nvar adherev_util_intl_1 = tslib_1.__importDefault(require(\"@baifendian/adherev-util-intl\"));\nvar SearchTable_1 = require(\"../../../SearchTable\");\nexports.default = {\n  name: 'adv-searchtable-editable-row-control',\n  props: {\n    rowKey: {\n      type: String\n    },\n    editorRowId: {\n      type: String\n    },\n    record: {\n      type: Object,\n      default: function _default() {\n        return {};\n      }\n    },\n    renderEditorRow: {\n      type: Function\n    },\n    renderSave: {\n      type: Function\n    },\n    renderCancel: {\n      type: Function\n    },\n    onSave: {\n      type: Function\n    },\n    onEditor: {\n      type: Function\n    }\n  },\n  emits: ['renderEditorRow', 'renderSave', 'renderCancel'],\n  inject: ['getFormIns', 'getContext'],\n  methods: {\n    renderDefaultEditorRow: function renderDefaultEditorRow(h) {\n      return h(\"a\", [adherev_util_intl_1.default.tv('编辑行')]);\n      // return <a>编辑行</a>;\n    },\n\n    renderDefaultCancel: function renderDefaultCancel(h) {\n      return h(\"a\", [adherev_util_intl_1.default.tv('取消')]);\n      // return <a>取消</a>;\n    },\n\n    renderDefaultSave: function renderDefaultSave(h) {\n      return h(\"a\", [adherev_util_intl_1.default.tv('保存')]);\n      // return <a>保存</a>;\n    },\n\n    validateFieldsSuccess: function validateFieldsSuccess(values) {\n      var _this = this;\n      if (this.onSave) {\n        this.onSave(values).then(function () {\n          return _this.updateEditorCellRowData(values);\n        });\n        return;\n      }\n      this.updateEditorCellRowData(values);\n    },\n    updateEditorCellRowData: function updateEditorCellRowData(values) {\n      var _this = this;\n      var _a, _b, _c;\n      var context = (_b = (_a = this.getContext) === null || _a === void 0 ? void 0 : _a.call(this)) === null || _b === void 0 ? void 0 : _b.context;\n      (_c = context === null || context === void 0 ? void 0 : context.updateEditorCellRowData({\n        values: values,\n        record: this.record\n      })) === null || _c === void 0 ? void 0 : _c.then(function () {\n        return _this.reset();\n      });\n    },\n    updateRowEdit: function updateRowEdit() {\n      var _a, _b;\n      var context = (_b = (_a = this.getContext) === null || _a === void 0 ? void 0 : _a.call(this)) === null || _b === void 0 ? void 0 : _b.context;\n      if (context) {\n        context.editorRowId = this.record[this.rowKey];\n      }\n    },\n    reset: function reset() {\n      var _a, _b;\n      var context = (_b = (_a = this.getContext) === null || _a === void 0 ? void 0 : _a.call(this)) === null || _b === void 0 ? void 0 : _b.context;\n      if (context) {\n        context.editorRowId = '';\n      }\n    },\n    $onEditor: function $onEditor() {\n      var _this = this;\n      var _a, _b;\n      if (this.onEditor) {\n        (_b = (_a = this.onEditor) === null || _a === void 0 ? void 0 : _a.call(this, this.record[this.rowKey])) === null || _b === void 0 ? void 0 : _b.then(function () {\n          return _this.updateRowEdit();\n        });\n        return;\n      }\n      this.updateRowEdit();\n    }\n  },\n  render: function render(h) {\n    var _this = this;\n    var _a, _b, _c, _d, _e, _f, _g, _h, _j;\n    var _k = this,\n      editorRowId = _k.editorRowId,\n      record = _k.record,\n      rowKey = _k.rowKey;\n    var form = this.getFormIns();\n    return h(\"div\", {\n      \"class\": \"\".concat(SearchTable_1.selectorPrefix, \"-editor-row-control\")\n    }, [editorRowId !== record[rowKey] && h(\"div\", {\n      \"class\": \"\".concat(SearchTable_1.selectorPrefix, \"-editor-row-control-edit\"),\n      \"on\": {\n        \"click\": this.$onEditor\n      }\n    }, [((_b = (_a = this.$slots) === null || _a === void 0 ? void 0 : _a[this.renderEditorRow]) === null || _b === void 0 ? void 0 : _b.call(_a)) || ((_c = this === null || this === void 0 ? void 0 : this.renderEditorRow) === null || _c === void 0 ? void 0 : _c.call(this)) || this.renderDefaultEditorRow(h)]), editorRowId === record[rowKey] && h(\"div\", {\n      \"class\": \"\".concat(SearchTable_1.selectorPrefix, \"-editor-row-control-save-cancel\")\n    }, [h(\"div\", {\n      \"class\": \"\".concat(SearchTable_1.selectorPrefix, \"-editor-row-control-save-cancel-item\"),\n      \"on\": {\n        \"click\": function click() {\n          return form === null || form === void 0 ? void 0 : form.validateFields().then(function (values) {\n            return _this.validateFieldsSuccess(values);\n          });\n        }\n      }\n    }, [((_e = (_d = this.$slots) === null || _d === void 0 ? void 0 : _d[this.renderSave]) === null || _e === void 0 ? void 0 : _e.call(_d)) || ((_f = this === null || this === void 0 ? void 0 : this.renderSave) === null || _f === void 0 ? void 0 : _f.call(this)) || this.renderDefaultSave(h)]), h(\"div\", {\n      \"class\": \"\".concat(SearchTable_1.selectorPrefix, \"-editor-row-control-save-cancel-item\"),\n      \"on\": {\n        \"click\": this.reset\n      }\n    }, [((_h = (_g = this.$slots) === null || _g === void 0 ? void 0 : _g[this.renderCancel]) === null || _h === void 0 ? void 0 : _h.call(_g)) || ((_j = this === null || this === void 0 ? void 0 : this.renderCancel) === null || _j === void 0 ? void 0 : _j.call(this)) || this.renderDefaultCancel(h)])])]);\n  }\n};"],"names":["require","Object","defineProperty","exports","value","tslib_1","adherev_util_intl_1","__importDefault","SearchTable_1","default","name","props","rowKey","type","String","editorRowId","record","renderEditorRow","Function","renderSave","renderCancel","onSave","onEditor","emits","inject","methods","renderDefaultEditorRow","h","tv","renderDefaultCancel","renderDefaultSave","validateFieldsSuccess","values","_this","this","then","updateEditorCellRowData","context","_b","_a","getContext","call","_c","reset","updateRowEdit","$onEditor","render","_d","_j","_k","form","getFormIns","class","concat","selectorPrefix","on","click","$slots","validateFields","_e","_f","_h","_g"],"mappings":"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"}