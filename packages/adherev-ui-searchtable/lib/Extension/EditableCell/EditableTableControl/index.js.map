{"version":3,"file":"index.js","sources":["Extension/EditableCell/EditableTableControl/index.js"],"sourcesContent":["\"use strict\";\n\nvar _vue = require(\"vue\");\nrequire(\"core-js/modules/es.object.define-property.js\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar tslib_1 = require(\"tslib\");\nvar vue_1 = require(\"vue\");\nvar vue_types_1 = require(\"vue-types\");\nvar adherev_util_intl_1 = tslib_1.__importDefault(require(\"@baifendian/adherev-util-intl\"));\nvar SearchTable_1 = require(\"../../../SearchTable\");\nexports.default = (0, vue_1.defineComponent)({\n  name: 'adv-searchtable-editable-control',\n  props: {\n    rowKey: (0, vue_types_1.string)().def(''),\n    renderEditorTable: (0, vue_types_1.oneOfType)([(0, vue_types_1.string)(), (0, vue_types_1.func)()]),\n    renderSave: (0, vue_types_1.oneOfType)([(0, vue_types_1.string)(), (0, vue_types_1.func)()]),\n    renderCancel: (0, vue_types_1.oneOfType)([(0, vue_types_1.string)(), (0, vue_types_1.func)()]),\n    onEditor: (0, vue_types_1.func)(),\n    onSave: (0, vue_types_1.func)()\n  },\n  emits: ['renderEditorTable', 'renderSave', 'renderCancel'],\n  setup: function setup(props, _a) {\n    var _b, _c, _d;\n    var slots = _a.slots;\n    var context = (_c = (_b = (0, vue_1.inject)('getContext')) === null || _b === void 0 ? void 0 : _b()) === null || _c === void 0 ? void 0 : _c.context;\n    var form = (_d = (0, vue_1.inject)('getFormIns')) === null || _d === void 0 ? void 0 : _d();\n    var setFieldValuesByDataSource = (0, vue_1.inject)('setFieldValuesByDataSource');\n    var renderDefaultSave = function renderDefaultSave() {\n      return (0, _vue.createVNode)(\"a\", null, [adherev_util_intl_1.default.tv('保存')]);\n    };\n    var renderDefaultCancel = function renderDefaultCancel() {\n      return (0, _vue.createVNode)(\"a\", null, [adherev_util_intl_1.default.tv('取消')]);\n    };\n    var renderDefaultEditorTable = function renderDefaultEditorTable() {\n      return (0, _vue.createVNode)(\"a\", null, [adherev_util_intl_1.default.tv('编辑表格')]);\n    };\n    var onEditor = function onEditor() {\n      var _a, _b;\n      if (props.onEditor) {\n        (_b = (_a = props.onEditor) === null || _a === void 0 ? void 0 : _a.call(props)) === null || _b === void 0 ? void 0 : _b.then(function () {\n          return updateTableEdit();\n        });\n        return;\n      }\n      updateTableEdit();\n    };\n    var onSave = function onSave() {\n      var _a, _b;\n      (_b = (_a = form === null || form === void 0 ? void 0 : form.validateFields()) === null || _a === void 0 ? void 0 : _a.then) === null || _b === void 0 ? void 0 : _b.call(_a, function (values) {\n        return validateFieldsSuccess(values);\n      });\n    };\n    var validateFieldsSuccess = function validateFieldsSuccess(values) {\n      if (props.onSave) {\n        props.onSave(values).then(function () {\n          return updateEditorCellTableData(values);\n        });\n        return;\n      }\n      updateEditorCellTableData(values);\n    };\n    var updateEditorCellTableData = function updateEditorCellTableData(changeData) {\n      var _a;\n      (_a = context === null || context === void 0 ? void 0 : context.updateEditorData(changeData)) === null || _a === void 0 ? void 0 : _a.then(onReset);\n    };\n    var updateTableEdit = function updateTableEdit() {\n      if (context) {\n        context.isTableEditor = true;\n      }\n    };\n    var onReset = function onReset() {\n      if (context) {\n        context.isTableEditor = false;\n      }\n      setFieldValuesByDataSource === null || setFieldValuesByDataSource === void 0 ? void 0 : setFieldValuesByDataSource();\n    };\n    return function () {\n      var _a, _b, _c, _d, _e, _f;\n      return (0, _vue.createVNode)(\"div\", {\n        \"class\": \"\".concat(SearchTable_1.selectorPrefix, \"-editor-table-control\")\n      }, [!(context === null || context === void 0 ? void 0 : context.isTableEditor) && (0, _vue.createVNode)(\"div\", {\n        \"class\": \"\".concat(SearchTable_1.selectorPrefix, \"-editor-table-control-edit\"),\n        \"onClick\": onEditor\n      }, [((_a = slots === null || slots === void 0 ? void 0 : slots[props.renderEditorTable]) === null || _a === void 0 ? void 0 : _a.call(slots)) || ((_b = props === null || props === void 0 ? void 0 : props.renderEditorTable) === null || _b === void 0 ? void 0 : _b.call(props)) || (renderDefaultEditorTable === null || renderDefaultEditorTable === void 0 ? void 0 : renderDefaultEditorTable())]), (context === null || context === void 0 ? void 0 : context.isTableEditor) && (0, _vue.createVNode)(\"div\", {\n        \"class\": \"\".concat(SearchTable_1.selectorPrefix, \"-editor-table-control-save-cancel\")\n      }, [(0, _vue.createVNode)(\"div\", {\n        \"class\": \"\".concat(SearchTable_1.selectorPrefix, \"-editor-table-control-save-cancel-item\"),\n        \"onClick\": onSave\n      }, [((_c = slots === null || slots === void 0 ? void 0 : slots[props === null || props === void 0 ? void 0 : props.renderSave]) === null || _c === void 0 ? void 0 : _c.call(slots)) || ((_d = props === null || props === void 0 ? void 0 : props.renderSave) === null || _d === void 0 ? void 0 : _d.call(props)) || renderDefaultSave()]), (0, _vue.createVNode)(\"div\", {\n        \"class\": \"\".concat(SearchTable_1.selectorPrefix, \"-editor-table-control-save-cancel-item\"),\n        \"onClick\": onReset\n      }, [((_e = slots === null || slots === void 0 ? void 0 : slots[props === null || props === void 0 ? void 0 : props.renderCancel]) === null || _e === void 0 ? void 0 : _e.call(slots)) || ((_f = props === null || props === void 0 ? void 0 : props.renderCancel) === null || _f === void 0 ? void 0 : _f.call(props)) || renderDefaultCancel()])])]);\n    };\n  }\n});"],"names":["_vue","require","tslib_1","Object","defineProperty","exports","value","vue_1","vue_types_1","adherev_util_intl_1","__importDefault","SearchTable_1","default","defineComponent","name","props","rowKey","string","def","renderEditorTable","oneOfType","func","renderSave","renderCancel","onEditor","onSave","emits","setup","_a","renderDefaultEditorTable","createVNode","tv","_b","call","then","updateTableEdit","form","validateFields","validateFieldsSuccess","values","updateEditorCellTableData","context","isTableEditor","onReset","setFieldValuesByDataSource","slots","_c","inject","_d","changeData","updateEditorData","_f","class","concat","selectorPrefix","onClick","_e"],"mappings":"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"}