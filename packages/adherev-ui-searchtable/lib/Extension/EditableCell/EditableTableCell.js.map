{"version":3,"file":"EditableTableCell.js","sources":["Extension/EditableCell/EditableTableCell.js"],"sourcesContent":["\"use strict\";\n\nvar _vue = require(\"vue\");\nrequire(\"core-js/modules/es.object.define-property.js\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.useEditableTableCell = void 0;\nvar tslib_1 = require(\"tslib\");\nvar vue_1 = require(\"vue\");\nvar EditableTableCellEdit_1 = tslib_1.__importDefault(require(\"./Edit/EditableTableCellEdit\"));\nvar View_1 = tslib_1.__importDefault(require(\"./View\"));\n/**\n * EditableCell\n * @description 表格整体编辑\n */\nvar useEditableTableCell = function useEditableTableCell(props, _context) {\n  var _a, _b, _c, _d;\n  var getContext = (0, vue_1.inject)('getContext');\n  var context = (_a = getContext === null || getContext === void 0 ? void 0 : getContext()) === null || _a === void 0 ? void 0 : _a.context;\n  var $editableCell = {\n    defaultConfig: {\n      editable: false,\n      defaultStatus: 'view',\n      type: 'input',\n      props: {},\n      formItemProps: {},\n      useTrigger: true,\n      require: true,\n      dataIndex: (_b = props.column) === null || _b === void 0 ? void 0 : _b.dataIndex,\n      useKeepEdit: false\n    }\n  };\n  var status = (0, vue_1.ref)(((_d = (_c = props.column) === null || _c === void 0 ? void 0 : _c.$editable) === null || _d === void 0 ? void 0 : _d.defaultStatus) || 'view');\n  var editableCellEditableConfig = (0, vue_1.computed)(function () {\n    var _a;\n    return tslib_1.__assign(tslib_1.__assign({}, $editableCell.defaultConfig), ((_a = props.column) === null || _a === void 0 ? void 0 : _a.$editable) || {});\n  });\n  var watchHandler1 = (0, vue_1.watch)(function () {\n    var _a;\n    return (_a = context === null || context === void 0 ? void 0 : context.getData) === null || _a === void 0 ? void 0 : _a.call(context);\n  }, function () {\n    status.value = editableCellEditableConfig.value.defaultStatus;\n  });\n  var watchHandler2 = (0, vue_1.watch)(function () {\n    var _a, _b;\n    return (_b = (_a = props.column) === null || _a === void 0 ? void 0 : _a.$editable) === null || _b === void 0 ? void 0 : _b.defaultStatus;\n  }, function () {\n    status.value = editableCellEditableConfig.value.defaultStatus;\n  });\n  (0, vue_1.onBeforeUnmount)(function () {\n    watchHandler1();\n    watchHandler2();\n  });\n  return function (tdVNode) {\n    var res = tdVNode;\n    // 单元格不是可编辑的单元格\n    if (!editableCellEditableConfig.value.editable) {\n      res = tdVNode;\n    }\n    // 始终保持编辑状态\n    else if (editableCellEditableConfig.value.useKeepEdit) {\n      res = (0, vue_1.h)(tdVNode, {}, [(0, _vue.createVNode)(EditableTableCellEdit_1.default, (0, _vue.mergeProps)((0, vue_1.toRaw)(props), {\n        \"editableConfig\": editableCellEditableConfig.value,\n        \"onTriggerChange\": function onTriggerChange() {\n          return status.value = 'view';\n        }\n      }), {\n        default: function _default() {\n          return [tdVNode.children];\n        }\n      })]);\n    }\n    // 查看状态\n    else if (status.value === 'view') {\n      res = (0, vue_1.h)(tdVNode, {}, [(0, _vue.createVNode)(View_1.default, (0, _vue.mergeProps)((0, vue_1.toRaw)(props), {\n        \"editableConfig\": editableCellEditableConfig.value,\n        \"onTriggerChange\": function onTriggerChange() {\n          status.value = 'edit';\n        }\n      }), {\n        default: function _default() {\n          return [tdVNode.children];\n        }\n      })]);\n    }\n    // 编辑状态\n    else if (status.value === 'edit') {\n      res = (0, vue_1.h)(tdVNode, {}, [(0, _vue.createVNode)(EditableTableCellEdit_1.default, (0, _vue.mergeProps)((0, vue_1.toRaw)(props), {\n        \"editableConfig\": editableCellEditableConfig.value,\n        \"onTriggerChange\": function onTriggerChange() {\n          status.value = 'view';\n        }\n      }), {\n        default: function _default() {\n          return [tdVNode.children];\n        }\n      })]);\n    }\n    return res;\n  };\n};\nexports.useEditableTableCell = useEditableTableCell;"],"names":["_vue","require","tslib_1","Object","defineProperty","exports","value","useEditableTableCell","vue_1","EditableTableCellEdit_1","__importDefault","View_1","props","_context","getContext","inject","context","_a","$editableCell","defaultConfig","editable","defaultStatus","type","formItemProps","useTrigger","dataIndex","_b","column","useKeepEdit","status","ref","_d","_c","$editable","editableCellEditableConfig","computed","__assign","watchHandler1","watch","getData","call","watchHandler2","onBeforeUnmount","tdVNode","res","h","createVNode","default","mergeProps","toRaw","editableConfig","onTriggerChange","children"],"mappings":"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"}