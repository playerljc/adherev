"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault"),_babelHelperVueJsxMergeProps=_interopRequireDefault(require("@vue/babel-helper-vue-jsx-merge-props")),tslib_1=(require("core-js/modules/es.object.define-property.js"),require("core-js/modules/es.number.constructor.js"),require("core-js/modules/es.array.reduce.js"),require("core-js/modules/es.object.to-string.js"),Object.defineProperty(exports,"__esModule",{value:!0}),require("tslib")),ant_design_vue_1=require("ant-design-vue"),moment_1=tslib_1.__importDefault(require("moment")),SearchTable_1=require("../../../SearchTable"),EventTypes_1=tslib_1.__importDefault(require("../EventTypes")),FormItemGenerator_1=tslib_1.__importDefault(require("./FormItemGenerator"));exports.default={props:{rowIndex:{type:Number},record:{type:Object},column:{type:Object},columns:{type:Array},editableConfig:{type:Object}},emits:["triggerChange"],inject:["getEditableRowFormIns","getContext"],methods:{updateEditorCellData:function(){var e,t=this.editableConfig.dataIndex,r=this.record,i=this.getValue();return i instanceof moment_1.default?null==(e=null==(e=null==(e=this.getContext)?void 0:e.call(this))?void 0:e.context)?void 0:e.updateEditorCellDateData({record:r,dataIndex:t,value:i}):null==(e=null==(e=null==(e=this.getContext)?void 0:e.call(this))?void 0:e.context)?void 0:e.updateEditorCellDate({record:r,dataIndex:t,value:i})},renderFormItem:function(){var r=this,e=this.editableConfig,t=e.useKeepEdit,i=e.dataIndex,l=e.type,n=e.render,a=e.dictName,e=e.renderChildren,o=this.rowIndex,d=this.record,u=this.getEditableRowFormIns(),t=tslib_1.__assign(tslib_1.__assign({autoFocus:!t},this.editableConfig.props),EventTypes_1.default.reduce(function(e,t){return e[t]=function(e){r.editableConfig.props[t]&&r.editableConfig.props[t](e,{form:u,dataIndex:i,rowIndex:o,updateEditorCellData:function(){return r.updateEditorCellData()}})},e},{})),l=FormItemGenerator_1.default.render({type:l,props:t,dictName:a,renderChildren:e,form:u,dataIndex:i,rowIndex:o}),t=null==(e=null==(a=null==(t=this.getContext)?void 0:t.call(this))?void 0:a.context)?void 0:e.$scopedSlots,a={value:null==d?void 0:d[i],record:d,dataIndex:i,rowIndex:o,form:u,updateEditorCellData:function(){return r.updateEditorCellData()},children:l};return(null==(e=null==t?void 0:t[n])?void 0:e.call(t,a))||(null==n?void 0:n(a))||l},onSaveTrigger:function(){var t=this,e=this.editableConfig,r=e.dataIndex,i=e.onSave,l=this.rowIndex,n=this.record,e=this.getEditableRowFormIns(),a=this.getValue();null!=e&&e.validateFields().then(function(e){i?null!=(e=i({value:a,values:e,record:n,dataIndex:r,rowIndex:l}))&&e.then(function(){return t.$emit("triggerChange")}):t.$emit("triggerChange")})},renderDefaultSaveTrigger:function(){return h(ant_design_vue_1.Icon,{attrs:{type:"check"}})},onCancelTrigger:function(){var e=this,t=this.editableConfig,r=t.dataIndex,t=t.onBeforeCancel,i=this.rowIndex,l=this.record,n=this.getValue();t?null!=(t=t({value:n,record:l,dataIndex:r,rowIndex:i}))&&t.then(function(){return e.$emit("triggerChange")}):this.$emit("triggerChange")},renderDefaultCancelTrigger:function(){return h(ant_design_vue_1.Icon,{attrs:{type:"close"}})},getValue:function(){var e;return null==(e=null==(e=this.getEditableRowFormIns)?void 0:e.call(this))?void 0:e.getFieldValue(this.editableConfig.dataIndex)}},render:function(){var e=this,t=this.editableConfig,r=t.useTrigger,i=t.useKeepEdit,l=t.renderSaveTrigger,n=t.renderCancelTrigger,a=t.dataIndex,o=t.type,d=t.render,u=t.rules,t=t.formItemProps,s=this.record,c=this.rowIndex,g=null==(g=null==(g=this.getContext)?void 0:g.call(this))?void 0:g.context,g=null==g?void 0:g.$scopedSlots,v=this.getEditableRowFormIns(),v={value:null==s?void 0:s[a],record:s,dataIndex:a,rowIndex:c,form:v,updateEditorCellData:function(){return e.updateEditorCellData()}},f={value:null==s?void 0:s[a],record:s,dataIndex:a,rowIndex:c},s={value:null==s?void 0:s[a],record:s,dataIndex:a,rowIndex:c};return h("div",{class:"".concat(SearchTable_1.selectorPrefix,"-editablecell-edit")},[h("div",{class:"".concat(SearchTable_1.selectorPrefix,"-editablecell-edit-inner")},[h(ant_design_vue_1.Form.Item,(0,_babelHelperVueJsxMergeProps.default)([{attrs:{name:a,rules:u}},t||{}]),["custom"!==o?this.renderFormItem():(null==(c=null==g?void 0:g[d])?void 0:c.call(g,v))||(null==d?void 0:d(v))])]),!!r&&!i&&h("div",{class:"".concat(SearchTable_1.selectorPrefix,"-editablecell-edit-trigger")},[h("div",{class:"".concat(SearchTable_1.selectorPrefix,"-editablecell-edit-trigger-inner")},[h("div",{class:"".concat(SearchTable_1.selectorPrefix,"-editablecell-edit-trigger-save"),on:{click:this.onSaveTrigger}},[(null==(a=null==g?void 0:g[l])?void 0:a.call(g,f))||(null==l?void 0:l(f))||this.renderDefaultSaveTrigger()]),h("div",{class:"".concat(SearchTable_1.selectorPrefix,"-editablecell-edit-trigger-cancel"),on:{click:this.onCancelTrigger}},[(null==(u=null==g?void 0:g[n])?void 0:u.call(g,s))||(null==n?void 0:n(s))||this.renderDefaultCancelTrigger()])])])])}};
//# sourceMappingURL=EditableCellEdit.js.map
