"use strict";var _vue=require("vue"),tslib_1=(require("core-js/modules/es.object.define-property.js"),require("core-js/modules/es.array.reduce.js"),require("core-js/modules/es.object.to-string.js"),require("core-js/modules/es.object.keys.js"),require("core-js/modules/es.array.concat.js"),Object.defineProperty(exports,"__esModule",{value:!0}),require("tslib")),ant_design_vue_1=require("ant-design-vue"),dayjs_1=tslib_1.__importDefault(require("dayjs")),vue_1=require("vue"),vue_types_1=require("vue-types"),icons_vue_1=require("@ant-design/icons-vue"),SearchTable_1=require("../../../SearchTable"),FormItemGenerator_1=tslib_1.__importDefault(require("./FormItemGenerator"));exports.default=(0,vue_1.defineComponent)({props:{rowIndex:(0,vue_types_1.number)(),record:(0,vue_types_1.object)().def({}),column:(0,vue_types_1.object)().def({}),columns:(0,vue_types_1.array)().def([]),editableConfig:(0,vue_types_1.object)()},emits:["triggerChange"],setup:function(i,e){function o(){var e,l=tslib_1.__assign({autoFocus:!(null!=(l=null==i?void 0:i.editableConfig)&&l.useKeepEdit)},(null==(l=null==i?void 0:i.editableConfig)?void 0:l.props)||{}),n=Object.keys((null==(n=null==i?void 0:i.editableConfig)?void 0:n.listeners)||{}).reduce(function(e,d){return e[d]=function(e){var l,n;null!=(n=null==(n=i.editableConfig)?void 0:(l=n.listeners)[d])&&n.call(l,e,{form:c,dataIndex:null==(n=null==i?void 0:i.editableConfig)?void 0:n.dataIndex,rowIndex:null==i?void 0:i.rowIndex,updateEditorCellData:function(){return C()}})},e},{}),d=FormItemGenerator_1.default.render({type:null==(d=null==i?void 0:i.editableConfig)?void 0:d.type,props:l,listeners:n,dictName:null==(d=null==i?void 0:i.editableConfig)?void 0:d.dictName,renderChildren:null==(l=null==i?void 0:i.editableConfig)?void 0:l.renderChildren,dataIndex:null==(n=null==i?void 0:i.editableConfig)?void 0:n.dataIndex,rowIndex:null==i?void 0:i.rowIndex,initialValue:g,name:_,form:c,context:v}),n={value:null==(l=null==i?void 0:i.record)?void 0:l[null==(n=null==i?void 0:i.editableConfig)?void 0:n.dataIndex],record:null==i?void 0:i.record,dataIndex:null==(l=null==i?void 0:i.editableConfig)?void 0:l.dataIndex,rowIndex:null==i?void 0:i.rowIndex,updateEditorCellData:function(){return C()},children:d,form:c};return(null==(l=null==a?void 0:a[null==(l=null==i?void 0:i.editableConfig)?void 0:l.render])?void 0:l.call(a,n))||(null==(e=null==(l=null==i?void 0:i.editableConfig)?void 0:l.render)?void 0:e.call(l,n))||d}function r(){var e,d=n();null!=(e=null==i?void 0:i.editableConfig)&&e.onSave?null!=c&&c.validateFields().then(function(e){var l,n;null!=(n=null==(l=null==(n=null==i?void 0:i.editableConfig)?void 0:n.onSave)?void 0:l.call(n,{value:d,values:e,record:null==i?void 0:i.record,dataIndex:null==(l=null==i?void 0:i.editableConfig)?void 0:l.dataIndex,rowIndex:null==i?void 0:i.rowIndex}))&&n.then(function(){t("triggerChange")})}):t("triggerChange")}function u(){var e,l=null==(l=null==i?void 0:i.record)?void 0:l[null==(l=null==i?void 0:i.editableConfig)?void 0:l.dataIndex];v.formData[_]=l,null!=(e=null==i?void 0:i.editableConfig)&&e.onBeforeCancel?null!=(l=null==(e=null==i?void 0:i.editableConfig)?void 0:e.onBeforeCancel({value:l,record:null==i?void 0:i.record,dataIndex:null==(e=null==i?void 0:i.editableConfig)?void 0:e.dataIndex,rowIndex:null==i?void 0:i.rowIndex}))&&l.then(function(){return t("triggerChange")}):t("triggerChange")}var t=e.emit,a=e.slots,e=(0,vue_1.inject)("getContext"),v=null==(e=null==e?void 0:e())?void 0:e.context,c=null==(e=(0,vue_1.inject)("getFormIns"))?void 0:e(),s={value:null==(e=null==i?void 0:i.record)?void 0:e[null==(e=null==i?void 0:i.editableConfig)?void 0:e.dataIndex],record:i.record,dataIndex:null==(e=null==i?void 0:i.editableConfig)?void 0:e.dataIndex,rowIndex:null==i?void 0:i.rowIndex},f={value:null==(e=null==i?void 0:i.record)?void 0:e[null==(e=null==i?void 0:i.editableConfig)?void 0:e.dataIndex],record:null==i?void 0:i.record,dataIndex:null==(e=null==i?void 0:i.editableConfig)?void 0:e.dataIndex,rowIndex:null==i?void 0:i.rowIndex},g=null==v?void 0:v.valueToFormItemValue({type:null==(e=null==i?void 0:i.editableConfig)?void 0:e.type,record:i.record,dataIndex:null==(e=null==i?void 0:i.editableConfig)?void 0:e.dataIndex}),b={initialValue:g,value:null==(e=null==i?void 0:i.record)?void 0:e[null==(e=null==i?void 0:i.editableConfig)?void 0:e.dataIndex],record:null==i?void 0:i.record,dataIndex:null==(e=null==i?void 0:i.editableConfig)?void 0:e.dataIndex,rowIndex:null==i?void 0:i.rowIndex,form:c,updateEditorCellData:function(){return C()}},C=function(){var e=n(),l={record:null==i?void 0:i.record,dataIndex:null==(l=null==i?void 0:i.editableConfig)?void 0:l.dataIndex,value:e,rowIndex:null==i?void 0:i.rowIndex};return e instanceof dayjs_1.default?null==v?void 0:v.updateEditorCellDateData(l):null==v?void 0:v.updateEditorCellDate(l)},n=function(){return v.formData[_]},_="".concat(null==(e=null==i?void 0:i.editableConfig)?void 0:e.dataIndex,"_").concat(null==i?void 0:i.rowIndex);return function(){var e,l,n,d;return(0,_vue.createVNode)("div",{class:"".concat(SearchTable_1.selectorPrefix,"-editablecell-edit")},[(0,_vue.createVNode)("div",{class:"".concat(SearchTable_1.selectorPrefix,"-editablecell-edit-inner")},[(0,_vue.createVNode)(ant_design_vue_1.Form.Item,(0,_vue.mergeProps)({name:_,rules:null==(d=null==i?void 0:i.editableConfig)?void 0:d.rules},(null==(d=null==i?void 0:i.editableConfig)?void 0:d.formItemProps)||{}),{default:function(){return["custom"!==(null==(e=null==i?void 0:i.editableConfig)?void 0:e.type)?null===o?void 0:o():(null==(e=null==a?void 0:a[null==(e=null==i?void 0:i.editableConfig)?void 0:e.render])?void 0:e.call(a,b))||(null==(l=null==(e=null==i?void 0:i.editableConfig)?void 0:e.render)?void 0:l.call(e,b))]}})]),!(null==(d=null==i?void 0:i.editableConfig)||!d.useTrigger)&&!(null!=(d=null==i?void 0:i.editableConfig)&&d.useKeepEdit)&&(0,_vue.createVNode)("div",{class:"".concat(SearchTable_1.selectorPrefix,"-editablecell-edit-trigger")},[(0,_vue.createVNode)("div",{class:"".concat(SearchTable_1.selectorPrefix,"-editablecell-edit-trigger-inner")},[(0,_vue.createVNode)("div",{class:"".concat(SearchTable_1.selectorPrefix,"-editablecell-edit-trigger-save"),onClick:r},[(null==(d=null==a?void 0:a[null==(d=null==i?void 0:i.editableConfig)?void 0:d.renderSaveTrigger])?void 0:d.call(a,s))||(null==(n=null==(d=null==i?void 0:i.editableConfig)?void 0:d.renderSaveTrigger)?void 0:n.call(d,s))||(0,_vue.createVNode)(icons_vue_1.CheckOutlined,null,null)]),(0,_vue.createVNode)("div",{class:"".concat(SearchTable_1.selectorPrefix,"-editablecell-edit-trigger-cancel"),onClick:u},[(null==(d=null==a?void 0:a[null==(n=null==i?void 0:i.editableConfig)?void 0:n.renderCancelTrigger])?void 0:d.call(a,f))||(null==(d=null==(n=null==i?void 0:i.editableConfig)?void 0:n.renderCancelTrigger)?void 0:d.call(n,f))||(0,_vue.createVNode)(icons_vue_1.CloseOutlined,null,null)])])])])}}});
//# sourceMappingURL=EditableCellEdit.js.map
