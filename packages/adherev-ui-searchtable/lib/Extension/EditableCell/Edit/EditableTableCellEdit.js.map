{"version":3,"file":"EditableTableCellEdit.js","sources":["Extension/EditableCell/Edit/EditableTableCellEdit.js"],"sourcesContent":["\"use strict\";\n\nrequire(\"core-js/modules/es.object.define-property.js\");\nrequire(\"core-js/modules/es.number.constructor.js\");\nrequire(\"core-js/modules/es.array.concat.js\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar tslib_1 = require(\"tslib\");\nvar ant_design_vue_1 = require(\"ant-design-vue\");\nvar SearchTable_1 = require(\"../../../SearchTable\");\nvar FormItemGenerator_1 = tslib_1.__importDefault(require(\"./FormItemGenerator\"));\n/**\n * EditableTableCellEdit\n * @description 可编辑单元格的编辑状态\n */\nexports.default = {\n  props: {\n    rowIndex: {\n      type: Number\n    },\n    record: {\n      type: Object\n    },\n    column: {\n      type: Object\n    },\n    columns: {\n      type: Array\n    },\n    editableConfig: {\n      type: Object\n    }\n  },\n  emits: ['triggerChange'],\n  inject: ['getFormIns', 'getContext'],\n  methods: {\n    /**\n     * renderFormItem\n     */\n    renderFormItem: function renderFormItem(h) {\n      var _a, _b, _c, _d;\n      var _e = this.editableConfig,\n        useKeepEdit = _e.useKeepEdit,\n        dataIndex = _e.dataIndex,\n        type = _e.type,\n        render = _e.render,\n        dictName = _e.dictName,\n        renderChildren = _e.renderChildren;\n      var _f = this,\n        rowIndex = _f.rowIndex,\n        record = _f.record;\n      var form = this.getFormIns();\n      var formItemNodeProps = tslib_1.__assign({\n        autoFocus: !useKeepEdit\n      }, this.editableConfig.props);\n      var formItemNode = FormItemGenerator_1.default.render(h, {\n        type: type,\n        props: formItemNodeProps,\n        dictName: dictName,\n        renderChildren: renderChildren,\n        form: form,\n        dataIndex: dataIndex,\n        rowIndex: rowIndex\n      });\n      var $scopedSlots = (_c = (_b = (_a = this.getContext) === null || _a === void 0 ? void 0 : _a.call(this)) === null || _b === void 0 ? void 0 : _b.context) === null || _c === void 0 ? void 0 : _c.$scopedSlots;\n      var renderArgs = {\n        value: record === null || record === void 0 ? void 0 : record[dataIndex],\n        record: record,\n        dataIndex: dataIndex,\n        rowIndex: rowIndex,\n        form: form,\n        children: formItemNode\n      };\n      return ((_d = $scopedSlots === null || $scopedSlots === void 0 ? void 0 : $scopedSlots[render]) === null || _d === void 0 ? void 0 : _d.call($scopedSlots, renderArgs)) || (render === null || render === void 0 ? void 0 : render(renderArgs)) || formItemNode;\n    },\n    /**\n     * renderDefaultSaveTrigger\n     * @description 渲染缺省的保存句柄\n     */\n    renderDefaultSaveTrigger: function renderDefaultSaveTrigger(h) {\n      return h(ant_design_vue_1.Icon, {\n        \"attrs\": {\n          \"type\": \"check\"\n        }\n      });\n    },\n    /**\n     * renderDefaultCancelTrigger\n     * @description 渲染缺省的取消句柄\n     */\n    renderDefaultCancelTrigger: function renderDefaultCancelTrigger(h) {\n      return h(ant_design_vue_1.Icon, {\n        \"attrs\": {\n          \"type\": \"close\"\n        }\n      });\n    },\n    /**\n     * onSaveTrigger\n     * @description 点击了保存句柄\n     */\n    onSaveTrigger: function onSaveTrigger() {\n      var _this = this;\n      var _a = this.editableConfig,\n        dataIndex = _a.dataIndex,\n        onSave = _a.onSave;\n      var _b = this,\n        rowIndex = _b.rowIndex,\n        record = _b.record;\n      var form = this.getFormIns();\n      var value = this.getValue();\n      if (onSave) {\n        form === null || form === void 0 ? void 0 : form.validateFields().then(function (values) {\n          var _a;\n          (_a = onSave({\n            value: value,\n            values: values,\n            record: record,\n            dataIndex: dataIndex,\n            rowIndex: rowIndex\n          })) === null || _a === void 0 ? void 0 : _a.then(function () {\n            _this.$emit('triggerChange');\n          });\n        });\n        return;\n      }\n      this.$emit('triggerChange');\n    },\n    /**\n     * onCancelTrigger\n     * @description 点击了cancel句柄\n     */\n    onCancelTrigger: function onCancelTrigger() {\n      var _this = this;\n      var _a;\n      var _b = this.editableConfig,\n        dataIndex = _b.dataIndex,\n        onBeforeCancel = _b.onBeforeCancel;\n      var _c = this,\n        rowIndex = _c.rowIndex,\n        record = _c.record;\n      var value = this.getValue();\n      if (onBeforeCancel) {\n        (_a = onBeforeCancel({\n          value: value,\n          record: record,\n          dataIndex: dataIndex,\n          rowIndex: rowIndex\n        })) === null || _a === void 0 ? void 0 : _a.then(function () {\n          return _this.$emit('triggerChange');\n        });\n        return;\n      }\n      this.$emit('triggerChange');\n    },\n    /**\n     * getValue\n     */\n    getValue: function getValue() {\n      var _a, _b;\n      return (_b = (_a = this.getFormIns) === null || _a === void 0 ? void 0 : _a.call(this)) === null || _b === void 0 ? void 0 : _b.getFieldValue(\"\".concat(this.editableConfig.dataIndex, \"_\").concat(this.rowIndex));\n    }\n  },\n  render: function render(h) {\n    var _a, _b, _c, _d, _e;\n    var _f = this.editableConfig,\n      useTrigger = _f.useTrigger,\n      useKeepEdit = _f.useKeepEdit,\n      renderSaveTrigger = _f.renderSaveTrigger,\n      renderCancelTrigger = _f.renderCancelTrigger,\n      dataIndex = _f.dataIndex,\n      type = _f.type,\n      render = _f.render,\n      rules = _f.rules,\n      formItemProps = _f.formItemProps;\n    var _g = this,\n      record = _g.record,\n      rowIndex = _g.rowIndex;\n    var context = (_b = (_a = this.getContext) === null || _a === void 0 ? void 0 : _a.call(this)) === null || _b === void 0 ? void 0 : _b.context;\n    var $scopedSlots = context === null || context === void 0 ? void 0 : context.$scopedSlots;\n    var form = this.getFormIns();\n    var getFieldDecorator = form.getFieldDecorator;\n    var renderArgs = {\n      value: record === null || record === void 0 ? void 0 : record[dataIndex],\n      record: record,\n      dataIndex: dataIndex,\n      rowIndex: rowIndex,\n      form: form\n    };\n    var renderSaveTriggerArgs = {\n      value: record === null || record === void 0 ? void 0 : record[dataIndex],\n      record: record,\n      dataIndex: dataIndex,\n      rowIndex: rowIndex\n    };\n    var renderCancelTriggerArgs = {\n      value: record === null || record === void 0 ? void 0 : record[dataIndex],\n      record: record,\n      dataIndex: dataIndex,\n      rowIndex: rowIndex\n    };\n    return h(\"div\", {\n      \"class\": \"\".concat(SearchTable_1.selectorPrefix, \"-editablecell-edit\")\n    }, [h(\"div\", {\n      \"class\": \"\".concat(SearchTable_1.selectorPrefix, \"-editablecell-edit-inner\")\n    }, [h(ant_design_vue_1.Form.Item, [getFieldDecorator(\"\".concat(dataIndex, \"_\").concat(rowIndex), tslib_1.__assign({\n      rules: rules,\n      initialValue: context === null || context === void 0 ? void 0 : context.valueToFormItemValue({\n        type: type,\n        record: record,\n        dataIndex: dataIndex\n      })\n    }, formItemProps || {}))(type !== 'custom' ? this.renderFormItem(h) : ((_c = $scopedSlots === null || $scopedSlots === void 0 ? void 0 : $scopedSlots[render]) === null || _c === void 0 ? void 0 : _c.call($scopedSlots, renderArgs)) || (render === null || render === void 0 ? void 0 : render(renderArgs)))])]), !!useTrigger && !useKeepEdit && h(\"div\", {\n      \"class\": \"\".concat(SearchTable_1.selectorPrefix, \"-editablecell-edit-trigger\")\n    }, [h(\"div\", {\n      \"class\": \"\".concat(SearchTable_1.selectorPrefix, \"-editablecell-edit-trigger-inner\")\n    }, [h(\"div\", {\n      \"class\": \"\".concat(SearchTable_1.selectorPrefix, \"-editablecell-edit-trigger-save\"),\n      \"on\": {\n        \"click\": this.onSaveTrigger\n      }\n    }, [((_d = $scopedSlots === null || $scopedSlots === void 0 ? void 0 : $scopedSlots[renderSaveTrigger]) === null || _d === void 0 ? void 0 : _d.call($scopedSlots, renderSaveTriggerArgs)) || (renderSaveTrigger === null || renderSaveTrigger === void 0 ? void 0 : renderSaveTrigger(renderSaveTriggerArgs)) || this.renderDefaultSaveTrigger(h)]), h(\"div\", {\n      \"class\": \"\".concat(SearchTable_1.selectorPrefix, \"-editablecell-edit-trigger-cancel\"),\n      \"on\": {\n        \"click\": this.onCancelTrigger\n      }\n    }, [((_e = $scopedSlots === null || $scopedSlots === void 0 ? void 0 : $scopedSlots[renderCancelTrigger]) === null || _e === void 0 ? void 0 : _e.call($scopedSlots, renderCancelTriggerArgs)) || (renderCancelTrigger === null || renderCancelTrigger === void 0 ? void 0 : renderCancelTrigger(renderCancelTriggerArgs)) || this.renderDefaultCancelTrigger(h)])])])]);\n  }\n};"],"names":["require","Object","defineProperty","exports","value","tslib_1","ant_design_vue_1","SearchTable_1","FormItemGenerator_1","__importDefault","default","props","rowIndex","type","Number","record","column","columns","Array","editableConfig","emits","inject","methods","renderFormItem","h","_e","this","useKeepEdit","dataIndex","render","dictName","renderChildren","form","getFormIns","formItemNodeProps","__assign","autoFocus","formItemNode","$scopedSlots","_c","_b","_a","getContext","call","context","renderArgs","children","_d","renderDefaultSaveTrigger","Icon","attrs","renderDefaultCancelTrigger","onSaveTrigger","_this","onSave","getValue","validateFields","then","values","$emit","onCancelTrigger","onBeforeCancel","getFieldValue","concat","_f","useTrigger","renderSaveTrigger","renderCancelTrigger","rules","formItemProps","getFieldDecorator","renderSaveTriggerArgs","renderCancelTriggerArgs","class","selectorPrefix","Form","Item","initialValue","valueToFormItemValue","on","click"],"mappings":"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"}