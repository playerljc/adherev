{"version":3,"file":"DragSortBody.js","sources":["Extension/DragSort/RowDragSort/DragSortBody.js"],"sourcesContent":["// export default {\n//   methods: {\n//     onUseDragSortRowBodyEnd(e) {\n//       // newDraggableIndex\n//       // newIndex\n//       // oldDraggableIndex\n//       // oldIndex\n//       this.getContext?.()\n//         ?.context.moveRow(e.oldDraggableIndex, e.newDraggableIndex)\n//         .then(() => {});\n//     },\n//     /**\n//      * useDragSortRowBody\n//      * @param tbodyVNode\n//      */\n//     useDragSortRowBody(tbodyVNode: VNode): VNode | null {\n//       const bodyConfig = this.props.bodyConfig;\n//\n//       return (\n//         <Draggable\n//           {...(bodyConfig?.$bodyDragSort?.draggableProps || {})}\n//           tag=\"tbody\"\n//           class={classNames(\n//             `${selectorPrefix}-search-row-drag-sort-table`,\n//             tbodyVNode?.props?.class,\n//           )}\n//           draggable={\n//             bodyConfig?.$bodyDragSort?.canDrag?.()\n//               ? `.${selectorPrefix}-row-drag-sort-draggable-item`\n//               : false\n//           }\n//           // handle={`.${selectorPrefix}-row-drag-sort-handle`}\n//           onEnd={this.onUseDragSortRowBodyEnd}\n//         >\n//           {tbodyVNode.children}\n//         </Draggable>\n//       );\n//     },\n//   },\n// };\nimport classNames from 'classnames';\n// import Draggable from 'vuedraggable';\nimport Sortable from 'sortablejs';\nimport { cloneVNode, inject, onMounted, ref } from 'vue';\nimport { selectorPrefix } from '../../../SearchTable';\nexport default (function (props) {\n  var _a, _b, _c;\n  var getContext = inject('getContext');\n  var context = (_a = getContext === null || getContext === void 0 ? void 0 : getContext()) === null || _a === void 0 ? void 0 : _a.context;\n  var bodyConfig = (_c = (_b = context.onBody) === null || _b === void 0 ? void 0 : _b.call(context)) === null || _c === void 0 ? void 0 : _c.bodyConfig;\n  var tbodyRef = ref();\n  var onUseDragSortRowBodyEnd = function onUseDragSortRowBodyEnd(e) {\n    var _a, _b, _c;\n    // newDraggableIndex\n    // newIndex\n    // oldDraggableIndex\n    // oldIndex\n    (_c = (_b = (_a = context === null || context === void 0 ? void 0 : context.moveRow) === null || _a === void 0 ? void 0 : _a.call(context, e.oldDraggableIndex, e.newDraggableIndex)) === null || _b === void 0 ? void 0 : _b.then) === null || _c === void 0 ? void 0 : _c.call(_b, function () {});\n  };\n  onMounted(function () {\n    var _a, _b;\n    if (!tbodyRef.value) return;\n    Sortable.create(tbodyRef.value, {\n      onEnd: onUseDragSortRowBodyEnd,\n      draggable: ((_b = (_a = bodyConfig === null || bodyConfig === void 0 ? void 0 : bodyConfig.$bodyDragSort) === null || _a === void 0 ? void 0 : _a.canDrag) === null || _b === void 0 ? void 0 : _b.call(_a)) ? \".\".concat(selectorPrefix, \"-row-drag-sort-draggable-item\") : false\n    });\n  });\n  return function (tbodyVNode) {\n    var _a, _b;\n    var targetTbodyVNode = cloneVNode(tbodyVNode, {\n      ref: tbodyRef,\n      class: classNames((_a = tbodyVNode === null || tbodyVNode === void 0 ? void 0 : tbodyVNode.props) === null || _a === void 0 ? void 0 : _a.class, \"\".concat(selectorPrefix, \"-search-row-drag-sort-table\"), (_b = tbodyVNode === null || tbodyVNode === void 0 ? void 0 : tbodyVNode.props) === null || _b === void 0 ? void 0 : _b.class)\n    });\n    return (\n      /*<Draggable\n        {...(bodyConfig?.$bodyDragSort?.draggableProps || {})}\n        tag=\"tbody\"\n        class={classNames(`${selectorPrefix}-search-row-drag-sort-table`, tbodyVNode?.props?.class)}\n        draggable={\n          bodyConfig?.$bodyDragSort?.canDrag?.()\n            ? `.${selectorPrefix}-row-drag-sort-draggable-item`\n            : false\n        }\n        // handle={`.${selectorPrefix}-row-drag-sort-handle`}\n        onEnd={onUseDragSortRowBodyEnd}\n        list={tbodyVNode?.children?.[0]?.[1]?.children || []}\n        v-slots={{\n          item: (params) => (params || {})?.element,\n        }}\n      />*/\n      targetTbodyVNode\n    );\n  };\n});"],"names":["classNames","Sortable","cloneVNode","inject","onMounted","ref","selectorPrefix","props","onUseDragSortRowBodyEnd","e","_b","_c","_a","context","moveRow","call","oldDraggableIndex","newDraggableIndex","then","getContext","bodyConfig","onBody","tbodyRef","value","create","onEnd","draggable","$bodyDragSort","canDrag","concat","tbodyVNode","class"],"mappings":"OAwCOA,eAAgB,oBAEhBC,aAAc,oBACZC,WAAYC,OAAQC,UAAWC,GAAgB,KAAL,aAC1CC,cAA4C,KAAtB,sCAChB,SAAWC,GAMM,SAA1BC,EAA2DC,GAC7D,IAAQC,EAKR,OAACC,EAAK,OAACD,EAAK,OAACE,EAAKC,MAAAA,EAAyC,KAAA,EAASA,EAAQC,SAAqC,KAAA,EAASF,EAAGG,KAAKF,EAASJ,EAAEO,kBAAmBP,EAAEQ,iBAAiB,GAA+B,KAAA,EAASP,EAAGQ,OAA2CP,EAAGI,KAAKL,EAAI,YAAc,CACrS,CAZA,IACIS,EAAahB,OAAO,YAAY,EAChCU,EAAU,OAACD,EAAKO,MAAAA,EAA+C,KAAA,EAASA,EAAW,GAA+B,KAAA,EAASP,EAAGC,QAC9HO,EAAa,OAACT,EAAK,OAACD,EAAKG,EAAQQ,QAAoC,KAAA,EAASX,EAAGK,KAAKF,CAAO,GAA+B,KAAA,EAASF,EAAGS,WACxIE,EAAWjB,IAAI,EAiBnB,OARAD,UAAU,WACR,IAAIQ,EAAIF,EACHY,EAASC,OACdtB,SAASuB,OAAOF,EAASC,MAAO,CAC9BE,MAAOjB,EACPkB,UAAW,EAAC,OAAChB,EAAK,OAACE,EAAKQ,MAAAA,EAA+C,KAAA,EAASA,EAAWO,eAA2C,KAAA,EAASf,EAAGgB,UAA8ClB,CAAAA,EAAGK,KAAKH,CAAE,IAAK,IAAIiB,OAAOvB,eAAgB,+BAA+B,CAC3Q,CAAC,CACH,CAAC,EACM,SAAUwB,GACf,IAAQpB,EAKR,OAJuBR,WAAW4B,EAAY,CAC5CzB,IAAKiB,EACLS,MAAO/B,WAAW,OAACY,EAAKkB,MAAAA,EAA+C,KAAA,EAASA,EAAWvB,OAAmC,KAAA,EAASK,EAAGmB,MAAO,GAAGF,OAAOvB,eAAgB,6BAA6B,EAAG,OAACI,EAAKoB,MAAAA,EAA+C,KAAA,EAASA,EAAWvB,OAAmC,KAAA,EAASG,EAAGqB,KAAK,CAC1U,CAAC,CAoBH,CACD"}