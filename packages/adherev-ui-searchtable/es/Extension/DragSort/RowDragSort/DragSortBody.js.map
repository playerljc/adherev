{"version":3,"file":"DragSortBody.js","sources":["Extension/DragSort/RowDragSort/DragSortBody.js"],"sourcesContent":["import { __assign } from \"tslib\";\n// export default {\n//   methods: {\n//     onUseDragSortRowBodyEnd(e) {\n//       // newDraggableIndex\n//       // newIndex\n//       // oldDraggableIndex\n//       // oldIndex\n//       this.getContext?.()\n//         ?.context.moveRow(e.oldDraggableIndex, e.newDraggableIndex)\n//         .then(() => {});\n//     },\n//     /**\n//      * useDragSortRowBody\n//      * @param tbodyVNode\n//      */\n//     useDragSortRowBody(tbodyVNode: VNode): VNode | null {\n//       const bodyConfig = this.props.bodyConfig;\n//\n//       return (\n//         <Draggable\n//           {...(bodyConfig?.$bodyDragSort?.draggableProps || {})}\n//           tag=\"tbody\"\n//           class={classNames(\n//             `${selectorPrefix}-search-row-drag-sort-table`,\n//             tbodyVNode?.props?.class,\n//           )}\n//           draggable={\n//             bodyConfig?.$bodyDragSort?.canDrag?.()\n//               ? `.${selectorPrefix}-row-drag-sort-draggable-item`\n//               : false\n//           }\n//           // handle={`.${selectorPrefix}-row-drag-sort-handle`}\n//           onEnd={this.onUseDragSortRowBodyEnd}\n//         >\n//           {tbodyVNode.children}\n//         </Draggable>\n//       );\n//     },\n//   },\n// };\nimport classNames from 'classnames';\n// import Draggable from 'vuedraggable';\nimport Sortable from 'sortablejs';\nimport { cloneVNode, inject, onMounted, ref } from 'vue';\nimport { selectorPrefix } from '../../../SearchTable';\nexport default (function (props) {\n  var _a, _b, _c;\n  var getContext = inject('getContext');\n  var context = (_a = getContext === null || getContext === void 0 ? void 0 : getContext()) === null || _a === void 0 ? void 0 : _a.context;\n  var bodyConfig = (_c = (_b = context.onBody) === null || _b === void 0 ? void 0 : _b.call(context)) === null || _c === void 0 ? void 0 : _c.bodyConfig;\n  var tbodyRef = ref();\n  var onUseDragSortRowBodyEnd = function onUseDragSortRowBodyEnd(e) {\n    var _a, _b, _c;\n    // newDraggableIndex\n    // newIndex\n    // oldDraggableIndex\n    // oldIndex\n    (_c = (_b = (_a = context === null || context === void 0 ? void 0 : context.moveRow) === null || _a === void 0 ? void 0 : _a.call(context, e.oldDraggableIndex, e.newDraggableIndex)) === null || _b === void 0 ? void 0 : _b.then) === null || _c === void 0 ? void 0 : _c.call(_b, function () {});\n  };\n  onMounted(function () {\n    var _a, _b, _c;\n    if (!tbodyRef.value) return;\n    Sortable.create(tbodyRef.value, __assign(__assign({\n      draggable: ((_b = (_a = bodyConfig === null || bodyConfig === void 0 ? void 0 : bodyConfig.$bodyDragSort) === null || _a === void 0 ? void 0 : _a.canDrag) === null || _b === void 0 ? void 0 : _b.call(_a)) ? \".\".concat(selectorPrefix, \"-row-drag-sort-draggable-item\") : false\n    }, ((_c = bodyConfig === null || bodyConfig === void 0 ? void 0 : bodyConfig.$bodyDragSort) === null || _c === void 0 ? void 0 : _c.draggableProps) || {}), {\n      onEnd: function onEnd(e) {\n        var _a, _b, _c, _d, _e, _f, _g;\n        if ((_b = (_a = bodyConfig === null || bodyConfig === void 0 ? void 0 : bodyConfig.$bodyDragSort) === null || _a === void 0 ? void 0 : _a.draggableProps) === null || _b === void 0 ? void 0 : _b.onEnd) {\n          (_g = (_f = (_e = (_d = (_c = bodyConfig === null || bodyConfig === void 0 ? void 0 : bodyConfig.$bodyDragSort) === null || _c === void 0 ? void 0 : _c.draggableProps) === null || _d === void 0 ? void 0 : _d.onEnd) === null || _e === void 0 ? void 0 : _e.call(_d, e)) === null || _f === void 0 ? void 0 : _f.then) === null || _g === void 0 ? void 0 : _g.call(_f, function () {\n            onUseDragSortRowBodyEnd(e);\n          });\n        } else {\n          onUseDragSortRowBodyEnd(e);\n        }\n      }\n    }));\n  });\n  return function (tbodyVNode) {\n    var _a, _b;\n    var targetTbodyVNode = cloneVNode(tbodyVNode, {\n      ref: tbodyRef,\n      class: classNames((_a = tbodyVNode === null || tbodyVNode === void 0 ? void 0 : tbodyVNode.props) === null || _a === void 0 ? void 0 : _a.class, \"\".concat(selectorPrefix, \"-search-row-drag-sort-table\"), (_b = tbodyVNode === null || tbodyVNode === void 0 ? void 0 : tbodyVNode.props) === null || _b === void 0 ? void 0 : _b.class)\n    });\n    return (\n      /*<Draggable\n        {...(bodyConfig?.$bodyDragSort?.draggableProps || {})}\n        tag=\"tbody\"\n        class={classNames(`${selectorPrefix}-search-row-drag-sort-table`, tbodyVNode?.props?.class)}\n        draggable={\n          bodyConfig?.$bodyDragSort?.canDrag?.()\n            ? `.${selectorPrefix}-row-drag-sort-draggable-item`\n            : false\n        }\n        // handle={`.${selectorPrefix}-row-drag-sort-handle`}\n        onEnd={onUseDragSortRowBodyEnd}\n        list={tbodyVNode?.children?.[0]?.[1]?.children || []}\n        v-slots={{\n          item: (params) => (params || {})?.element,\n        }}\n      />*/\n      targetTbodyVNode\n    );\n  };\n});"],"names":["__assign","classNames","Sortable","cloneVNode","inject","onMounted","ref","selectorPrefix","props","onUseDragSortRowBodyEnd","e","_b","_c","_a","context","moveRow","call","oldDraggableIndex","newDraggableIndex","then","getContext","bodyConfig","onBody","tbodyRef","value","create","draggable","$bodyDragSort","canDrag","concat","draggableProps","onEnd","_f","_g","_e","_d","tbodyVNode","class"],"mappings":"OAASA,QAAuB,KAAP,eAyClBC,eAAgB,oBAEhBC,aAAc,oBACZC,WAAYC,OAAQC,UAAWC,GAAgB,KAAL,aAC1CC,cAA4C,KAAtB,sCAChB,SAAWC,GAMM,SAA1BC,EAA2DC,GAC7D,IAAQC,EAKR,OAACC,EAAK,OAACD,EAAK,OAACE,EAAKC,MAAAA,EAAyC,KAAA,EAASA,EAAQC,SAAqC,KAAA,EAASF,EAAGG,KAAKF,EAASJ,EAAEO,kBAAmBP,EAAEQ,iBAAiB,GAA+B,KAAA,EAASP,EAAGQ,OAA2CP,EAAGI,KAAKL,EAAI,YAAc,CACrS,CAZA,IACIS,EAAahB,OAAO,YAAY,EAChCU,EAAU,OAACD,EAAKO,MAAAA,EAA+C,KAAA,EAASA,EAAW,GAA+B,KAAA,EAASP,EAAGC,QAC9HO,EAAa,OAACT,EAAK,OAACD,EAAKG,EAAQQ,QAAoC,KAAA,EAASX,EAAGK,KAAKF,CAAO,GAA+B,KAAA,EAASF,EAAGS,WACxIE,EAAWjB,IAAI,EA2BnB,OAlBAD,UAAU,WACR,IAAIQ,EAAQD,EACPW,EAASC,OACdtB,SAASuB,OAAOF,EAASC,MAAOxB,SAASA,SAAS,CAChD0B,UAAW,EAAC,OAACf,EAAK,OAACE,EAAKQ,MAAAA,EAA+C,KAAA,EAASA,EAAWM,eAA2C,KAAA,EAASd,EAAGe,UAA8CjB,CAAAA,EAAGK,KAAKH,CAAE,IAAK,IAAIgB,OAAOtB,eAAgB,+BAA+B,CAC3Q,GAAI,OAACK,EAAKS,MAAAA,EAA+C,KAAA,EAASA,EAAWM,eAA2C,KAAA,EAASf,EAAGkB,iBAAmB,EAAE,EAAG,CAC1JC,MAAO,SAAerB,GACpB,IAAwBsB,EAAIC,EACxB,OAACtB,EAAK,OAACE,EAAKQ,MAAAA,EAA+C,KAAA,EAASA,EAAWM,eAA2C,KAAA,EAASd,EAAGiB,iBAAqDnB,EAAGoB,MAChM,OAACE,EAAK,OAACD,EAAK,OAACE,EAAK,OAACC,EAAK,OAACvB,EAAKS,MAAAA,EAA+C,KAAA,EAASA,EAAWM,eAA2C,KAAA,EAASf,EAAGkB,gBAA4C,KAAA,EAASK,EAAGJ,OAAmC,KAAA,EAASG,EAAGlB,KAAKmB,EAAIzB,CAAC,GAA+B,KAAA,EAASsB,EAAGb,OAA2Cc,EAAGjB,KAAKgB,EAAI,WACzWvB,EAAwBC,CAAC,CAC3B,CAAC,EAEDD,EAAwBC,CAAC,CAE7B,CACF,CAAC,CAAC,CACJ,CAAC,EACM,SAAU0B,GACf,IAAQzB,EAKR,OAJuBR,WAAWiC,EAAY,CAC5C9B,IAAKiB,EACLc,MAAOpC,WAAW,OAACY,EAAKuB,MAAAA,EAA+C,KAAA,EAASA,EAAW5B,OAAmC,KAAA,EAASK,EAAGwB,MAAO,GAAGR,OAAOtB,eAAgB,6BAA6B,EAAG,OAACI,EAAKyB,MAAAA,EAA+C,KAAA,EAASA,EAAW5B,OAAmC,KAAA,EAASG,EAAG0B,KAAK,CAC1U,CAAC,CAoBH,CACD"}