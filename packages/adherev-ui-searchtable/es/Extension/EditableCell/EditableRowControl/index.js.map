{"version":3,"file":"index.js","sources":["Extension/EditableCell/EditableRowControl/index.js"],"sourcesContent":["import Intl from '@baifendian/adherev-util-intl';\nimport { selectorPrefix } from '../../../SearchTable';\nexport default {\n  name: 'adv-searchtable-editable-row-control',\n  props: {\n    rowKey: {\n      type: String\n    },\n    editorRowId: {\n      type: String\n    },\n    record: {\n      type: Object,\n      default: function _default() {\n        return {};\n      }\n    },\n    renderEditorRow: {\n      type: Function\n    },\n    renderSave: {\n      type: Function\n    },\n    renderCancel: {\n      type: Function\n    },\n    onSave: {\n      type: Function\n    },\n    onEditor: {\n      type: Function\n    }\n  },\n  emits: ['renderEditorRow', 'renderSave', 'renderCancel'],\n  inject: ['getFormIns', 'getContext'],\n  methods: {\n    renderDefaultEditorRow: function renderDefaultEditorRow(h) {\n      return h(\"a\", [Intl.tv('编辑行')]);\n      // return <a>编辑行</a>;\n    },\n\n    renderDefaultCancel: function renderDefaultCancel(h) {\n      return h(\"a\", [Intl.tv('取消')]);\n      // return <a>取消</a>;\n    },\n\n    renderDefaultSave: function renderDefaultSave(h) {\n      return h(\"a\", [Intl.tv('保存')]);\n      // return <a>保存</a>;\n    },\n\n    validateFieldsSuccess: function validateFieldsSuccess(values) {\n      var _this = this;\n      if (this.onSave) {\n        this.onSave(values).then(function () {\n          return _this.updateEditorCellRowData(values);\n        });\n        return;\n      }\n      this.updateEditorCellRowData(values);\n    },\n    updateEditorCellRowData: function updateEditorCellRowData(values) {\n      var _this = this;\n      var _a, _b, _c;\n      var context = (_b = (_a = this.getContext) === null || _a === void 0 ? void 0 : _a.call(this)) === null || _b === void 0 ? void 0 : _b.context;\n      (_c = context === null || context === void 0 ? void 0 : context.updateEditorCellRowData({\n        values: values,\n        record: this.record\n      })) === null || _c === void 0 ? void 0 : _c.then(function () {\n        return _this.reset();\n      });\n    },\n    updateRowEdit: function updateRowEdit() {\n      var _a, _b;\n      var context = (_b = (_a = this.getContext) === null || _a === void 0 ? void 0 : _a.call(this)) === null || _b === void 0 ? void 0 : _b.context;\n      if (context) {\n        context.editorRowId = this.record[this.rowKey];\n      }\n    },\n    reset: function reset() {\n      var _a, _b;\n      var context = (_b = (_a = this.getContext) === null || _a === void 0 ? void 0 : _a.call(this)) === null || _b === void 0 ? void 0 : _b.context;\n      if (context) {\n        context.editorRowId = '';\n      }\n    },\n    $onEditor: function $onEditor() {\n      var _this = this;\n      var _a, _b;\n      if (this.onEditor) {\n        (_b = (_a = this.onEditor) === null || _a === void 0 ? void 0 : _a.call(this, this.record[this.rowKey])) === null || _b === void 0 ? void 0 : _b.then(function () {\n          return _this.updateRowEdit();\n        });\n        return;\n      }\n      this.updateRowEdit();\n    }\n  },\n  render: function render(h) {\n    var _this = this;\n    var _a, _b, _c, _d, _e, _f, _g, _h, _j;\n    var _k = this,\n      editorRowId = _k.editorRowId,\n      record = _k.record,\n      rowKey = _k.rowKey;\n    var form = this.getFormIns();\n    return h(\"div\", {\n      \"class\": \"\".concat(selectorPrefix, \"-editor-row-control\")\n    }, [editorRowId !== record[rowKey] && h(\"div\", {\n      \"class\": \"\".concat(selectorPrefix, \"-editor-row-control-edit\"),\n      \"on\": {\n        \"click\": this.$onEditor\n      }\n    }, [((_b = (_a = this.$slots) === null || _a === void 0 ? void 0 : _a[this.renderEditorRow]) === null || _b === void 0 ? void 0 : _b.call(_a)) || ((_c = this === null || this === void 0 ? void 0 : this.renderEditorRow) === null || _c === void 0 ? void 0 : _c.call(this)) || this.renderDefaultEditorRow(h)]), editorRowId === record[rowKey] && h(\"div\", {\n      \"class\": \"\".concat(selectorPrefix, \"-editor-row-control-save-cancel\")\n    }, [h(\"div\", {\n      \"class\": \"\".concat(selectorPrefix, \"-editor-row-control-save-cancel-item\"),\n      \"on\": {\n        \"click\": function click() {\n          return form === null || form === void 0 ? void 0 : form.validateFields().then(function (values) {\n            return _this.validateFieldsSuccess(values);\n          });\n        }\n      }\n    }, [((_e = (_d = this.$slots) === null || _d === void 0 ? void 0 : _d[this.renderSave]) === null || _e === void 0 ? void 0 : _e.call(_d)) || ((_f = this === null || this === void 0 ? void 0 : this.renderSave) === null || _f === void 0 ? void 0 : _f.call(this)) || this.renderDefaultSave(h)]), h(\"div\", {\n      \"class\": \"\".concat(selectorPrefix, \"-editor-row-control-save-cancel-item\"),\n      \"on\": {\n        \"click\": this.reset\n      }\n    }, [((_h = (_g = this.$slots) === null || _g === void 0 ? void 0 : _g[this.renderCancel]) === null || _h === void 0 ? void 0 : _h.call(_g)) || ((_j = this === null || this === void 0 ? void 0 : this.renderCancel) === null || _j === void 0 ? void 0 : _j.call(this)) || this.renderDefaultCancel(h)])])]);\n  }\n};"],"names":["Intl","selectorPrefix","name","props","rowKey","type","String","editorRowId","record","Object","default","renderEditorRow","Function","renderSave","renderCancel","onSave","onEditor","emits","inject","methods","renderDefaultEditorRow","h","tv","renderDefaultCancel","renderDefaultSave","validateFieldsSuccess","values","_this","this","then","updateEditorCellRowData","context","_b","_a","getContext","call","_c","reset","updateRowEdit","$onEditor","render","_d","_j","_k","form","getFormIns","class","concat","on","click","$slots","validateFields","_e","_f","_h","_g"],"mappings":"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"}