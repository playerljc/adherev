{"version":3,"file":"EditableTableCell.js","sources":["Extension/EditableCell/EditableTableCell.js"],"sourcesContent":["import { createVNode as _createVNode, mergeProps as _mergeProps } from \"vue\";\nimport { __assign } from \"tslib\";\nimport { computed, h, inject, onBeforeUnmount, ref, toRaw, watch } from \"vue\";\nimport EditableTableCellEdit from './Edit/EditableTableCellEdit';\nimport EditableCellView from './View';\n/**\n * EditableCell\n * @description 表格整体编辑\n */\nexport var useEditableTableCell = function useEditableTableCell(props, _context) {\n  var _a, _b, _c, _d;\n  var getContext = inject('getContext');\n  var context = (_a = getContext === null || getContext === void 0 ? void 0 : getContext()) === null || _a === void 0 ? void 0 : _a.context;\n  var $editableCell = {\n    defaultConfig: {\n      editable: false,\n      defaultStatus: 'view',\n      type: 'input',\n      props: {},\n      formItemProps: {},\n      useTrigger: true,\n      require: true,\n      dataIndex: (_b = props.column) === null || _b === void 0 ? void 0 : _b.dataIndex,\n      useKeepEdit: false\n    }\n  };\n  var status = ref(((_d = (_c = props.column) === null || _c === void 0 ? void 0 : _c.$editable) === null || _d === void 0 ? void 0 : _d.defaultStatus) || 'view');\n  var editableCellEditableConfig = computed(function () {\n    var _a;\n    return __assign(__assign({}, $editableCell.defaultConfig), ((_a = props.column) === null || _a === void 0 ? void 0 : _a.$editable) || {});\n  });\n  var watchHandler1 = watch(function () {\n    var _a;\n    return (_a = context === null || context === void 0 ? void 0 : context.getData) === null || _a === void 0 ? void 0 : _a.call(context);\n  }, function () {\n    status.value = editableCellEditableConfig.value.defaultStatus;\n  });\n  var watchHandler2 = watch(function () {\n    var _a, _b;\n    return (_b = (_a = props.column) === null || _a === void 0 ? void 0 : _a.$editable) === null || _b === void 0 ? void 0 : _b.defaultStatus;\n  }, function () {\n    status.value = editableCellEditableConfig.value.defaultStatus;\n  });\n  onBeforeUnmount(function () {\n    watchHandler1();\n    watchHandler2();\n  });\n  return function (tdVNode) {\n    var res = tdVNode;\n    // 单元格不是可编辑的单元格\n    if (!editableCellEditableConfig.value.editable) {\n      res = tdVNode;\n    }\n    // 始终保持编辑状态\n    else if (editableCellEditableConfig.value.useKeepEdit) {\n      res = h(tdVNode, {}, [_createVNode(EditableTableCellEdit, _mergeProps(toRaw(props), {\n        \"editableConfig\": editableCellEditableConfig.value,\n        \"onTriggerChange\": function onTriggerChange() {\n          return status.value = 'view';\n        }\n      }), {\n        default: function _default() {\n          return [tdVNode.children];\n        }\n      })]);\n    }\n    // 查看状态\n    else if (status.value === 'view') {\n      res = h(tdVNode, {}, [_createVNode(EditableCellView, _mergeProps(toRaw(props), {\n        \"editableConfig\": editableCellEditableConfig.value,\n        \"onTriggerChange\": function onTriggerChange() {\n          status.value = 'edit';\n        }\n      }), {\n        default: function _default() {\n          return [tdVNode.children];\n        }\n      })]);\n    }\n    // 编辑状态\n    else if (status.value === 'edit') {\n      res = h(tdVNode, {}, [_createVNode(EditableTableCellEdit, _mergeProps(toRaw(props), {\n        \"editableConfig\": editableCellEditableConfig.value,\n        \"onTriggerChange\": function onTriggerChange() {\n          status.value = 'view';\n        }\n      }), {\n        default: function _default() {\n          return [tdVNode.children];\n        }\n      })]);\n    }\n    return res;\n  };\n};"],"names":["_createVNode","_mergeProps","__assign","computed","h","inject","onBeforeUnmount","ref","toRaw","watch","EditableTableCellEdit","EditableCellView","useEditableTableCell","props","_context","getContext","context","_a","$editableCell","defaultConfig","editable","defaultStatus","type","formItemProps","useTrigger","require","dataIndex","_b","column","useKeepEdit","status","_d","_c","$editable","editableCellEditableConfig","watchHandler1","getData","call","value","watchHandler2","tdVNode","res","editableConfig","onTriggerChange","default","children"],"mappings":"OAAwBA,4BAA4BC,yBAAwB,KAAL,aAC9DC,QAAuB,KAAP,eAChBC,SAAUC,EAAGC,OAAQC,gBAAiBC,IAAKC,MAAOC,KAAkB,KAAL,aACjEC,0BAA2B,sCAC3BC,qBAAsB,SAKtB,IAAIC,qBAAuB,SAA8BC,EAAOC,GACrE,IACIC,EAAaV,OAAO,YAAY,EAChCW,EAAU,OAACC,EAAKF,MAAAA,EAA+C,KAAA,EAASA,EAAW,GAA+B,KAAA,EAASE,EAAGD,QAC9HE,EAAgB,CAClBC,cAAe,CACbC,SAAU,CAAA,EACVC,cAAe,OACfC,KAAM,QACNT,MAAO,GACPU,cAAe,GACfC,WAAY,CAAA,EACZC,QAAS,CAAA,EACTC,UAAW,OAACC,EAAKd,EAAMe,QAAoC,KAAA,EAASD,EAAGD,UACvEG,YAAa,CAAA,CACf,CACF,EACIC,EAASvB,KAAK,OAACwB,EAAK,OAACC,EAAKnB,EAAMe,QAAoC,KAAA,EAASI,EAAGC,WAAuC,KAAA,EAASF,EAAGV,gBAAkB,MAAM,EAC3Ja,EAA6B/B,SAAS,WACxC,IAAIc,EACJ,OAAOf,SAASA,SAAS,GAAIgB,EAAcC,aAAa,GAAI,OAACF,EAAKJ,EAAMe,QAAoC,KAAA,EAASX,EAAGgB,YAAc,EAAE,CAC1I,CAAC,EACGE,EAAgB1B,MAAM,WACxB,IAAIQ,EACJ,OAAO,OAACA,EAAKD,MAAAA,EAAyC,KAAA,EAASA,EAAQoB,SAAqC,KAAA,EAASnB,EAAGoB,KAAKrB,CAAO,CACtI,EAAG,WACDc,EAAOQ,MAAQJ,EAA2BI,MAAMjB,aAClD,CAAC,EACGkB,EAAgB9B,MAAM,WACxB,IAAQkB,EACR,OAAO,OAACA,EAAK,OAACV,EAAKJ,EAAMe,QAAoC,KAAA,EAASX,EAAGgB,WAAuC,KAAA,EAASN,EAAGN,aAC9H,EAAG,WACDS,EAAOQ,MAAQJ,EAA2BI,MAAMjB,aAClD,CAAC,EAKD,OAJAf,gBAAgB,WACd6B,EAAc,EACdI,EAAc,CAChB,CAAC,EACM,SAAUC,GACf,IAAIC,EAAMD,EA4CV,OA1CKN,EAA2BI,MAAMlB,SAI7Bc,EAA2BI,MAAMT,YACxCY,EAAMrC,EAAEoC,EAAS,GAAI,CAACxC,aAAaU,sBAAuBT,YAAYO,MAAMK,CAAK,EAAG,CAClF6B,eAAkBR,EAA2BI,MAC7CK,gBAAmB,WACjB,OAAOb,EAAOQ,MAAQ,MACxB,CACF,CAAC,EAAG,CACFM,QAAS,WACP,MAAO,CAACJ,EAAQK,SAClB,CACF,CAAC,EAAE,EAGqB,SAAjBf,EAAOQ,MACdG,EAAMrC,EAAEoC,EAAS,GAAI,CAACxC,aAAaW,iBAAkBV,YAAYO,MAAMK,CAAK,EAAG,CAC7E6B,eAAkBR,EAA2BI,MAC7CK,gBAAmB,WACjBb,EAAOQ,MAAQ,MACjB,CACF,CAAC,EAAG,CACFM,QAAS,WACP,MAAO,CAACJ,EAAQK,SAClB,CACF,CAAC,EAAE,EAGqB,SAAjBf,EAAOQ,QACdG,EAAMrC,EAAEoC,EAAS,GAAI,CAACxC,aAAaU,sBAAuBT,YAAYO,MAAMK,CAAK,EAAG,CAClF6B,eAAkBR,EAA2BI,MAC7CK,gBAAmB,WACjBb,EAAOQ,MAAQ,MACjB,CACF,CAAC,EAAG,CACFM,QAAS,WACP,MAAO,CAACJ,EAAQK,SAClB,CACF,CAAC,EAAE,GAvCHJ,EAAMD,EAyCDC,CACT,CACF,SArFW7B,oBAqFV"}