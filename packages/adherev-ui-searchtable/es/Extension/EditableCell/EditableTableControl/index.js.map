{"version":3,"file":"index.js","sources":["Extension/EditableCell/EditableTableControl/index.js"],"sourcesContent":["import { createVNode as _createVNode } from \"vue\";\nimport { defineComponent, inject } from 'vue';\nimport { func, oneOfType, string } from 'vue-types';\nimport Intl from '@baifendian/adherev-util-intl';\nimport { selectorPrefix } from '../../../SearchTable';\nexport default defineComponent({\n  name: 'adv-searchtable-editable-control',\n  props: {\n    rowKey: string().def(''),\n    renderEditorTable: oneOfType([string(), func()]),\n    renderSave: oneOfType([string(), func()]),\n    renderCancel: oneOfType([string(), func()]),\n    onEditor: func(),\n    onSave: func()\n  },\n  emits: ['renderEditorTable', 'renderSave', 'renderCancel'],\n  setup: function setup(props, _a) {\n    var _b, _c, _d;\n    var slots = _a.slots;\n    var context = (_c = (_b = inject('getContext')) === null || _b === void 0 ? void 0 : _b()) === null || _c === void 0 ? void 0 : _c.context;\n    var form = (_d = inject('getFormIns')) === null || _d === void 0 ? void 0 : _d();\n    var setFieldValuesByDataSource = inject('setFieldValuesByDataSource');\n    var renderDefaultSave = function renderDefaultSave() {\n      return _createVNode(\"a\", null, [Intl.tv('保存')]);\n    };\n    var renderDefaultCancel = function renderDefaultCancel() {\n      return _createVNode(\"a\", null, [Intl.tv('取消')]);\n    };\n    var renderDefaultEditorTable = function renderDefaultEditorTable() {\n      return _createVNode(\"a\", null, [Intl.tv('编辑表格')]);\n    };\n    var onEditor = function onEditor() {\n      var _a, _b;\n      if (props.onEditor) {\n        (_b = (_a = props.onEditor) === null || _a === void 0 ? void 0 : _a.call(props)) === null || _b === void 0 ? void 0 : _b.then(function () {\n          return updateTableEdit();\n        });\n        return;\n      }\n      updateTableEdit();\n    };\n    var onSave = function onSave() {\n      var _a, _b;\n      (_b = (_a = form === null || form === void 0 ? void 0 : form.validateFields()) === null || _a === void 0 ? void 0 : _a.then) === null || _b === void 0 ? void 0 : _b.call(_a, function (values) {\n        return validateFieldsSuccess(values);\n      });\n    };\n    var validateFieldsSuccess = function validateFieldsSuccess(values) {\n      if (props.onSave) {\n        props.onSave(values).then(function () {\n          return updateEditorCellTableData(values);\n        });\n        return;\n      }\n      updateEditorCellTableData(values);\n    };\n    var updateEditorCellTableData = function updateEditorCellTableData(changeData) {\n      var _a;\n      (_a = context === null || context === void 0 ? void 0 : context.updateEditorData(changeData)) === null || _a === void 0 ? void 0 : _a.then(onReset);\n    };\n    var updateTableEdit = function updateTableEdit() {\n      if (context) {\n        context.isTableEditor = true;\n      }\n    };\n    var onReset = function onReset() {\n      if (context) {\n        context.isTableEditor = false;\n      }\n      setFieldValuesByDataSource === null || setFieldValuesByDataSource === void 0 ? void 0 : setFieldValuesByDataSource();\n    };\n    return function () {\n      var _a, _b, _c, _d, _e, _f;\n      return _createVNode(\"div\", {\n        \"class\": \"\".concat(selectorPrefix, \"-editor-table-control\")\n      }, [!(context === null || context === void 0 ? void 0 : context.isTableEditor) && _createVNode(\"div\", {\n        \"class\": \"\".concat(selectorPrefix, \"-editor-table-control-edit\"),\n        \"onClick\": onEditor\n      }, [((_a = slots === null || slots === void 0 ? void 0 : slots[props.renderEditorTable]) === null || _a === void 0 ? void 0 : _a.call(slots)) || ((_b = props === null || props === void 0 ? void 0 : props.renderEditorTable) === null || _b === void 0 ? void 0 : _b.call(props)) || (renderDefaultEditorTable === null || renderDefaultEditorTable === void 0 ? void 0 : renderDefaultEditorTable())]), (context === null || context === void 0 ? void 0 : context.isTableEditor) && _createVNode(\"div\", {\n        \"class\": \"\".concat(selectorPrefix, \"-editor-table-control-save-cancel\")\n      }, [_createVNode(\"div\", {\n        \"class\": \"\".concat(selectorPrefix, \"-editor-table-control-save-cancel-item\"),\n        \"onClick\": onSave\n      }, [((_c = slots === null || slots === void 0 ? void 0 : slots[props === null || props === void 0 ? void 0 : props.renderSave]) === null || _c === void 0 ? void 0 : _c.call(slots)) || ((_d = props === null || props === void 0 ? void 0 : props.renderSave) === null || _d === void 0 ? void 0 : _d.call(props)) || renderDefaultSave()]), _createVNode(\"div\", {\n        \"class\": \"\".concat(selectorPrefix, \"-editor-table-control-save-cancel-item\"),\n        \"onClick\": onReset\n      }, [((_e = slots === null || slots === void 0 ? void 0 : slots[props === null || props === void 0 ? void 0 : props.renderCancel]) === null || _e === void 0 ? void 0 : _e.call(slots)) || ((_f = props === null || props === void 0 ? void 0 : props.renderCancel) === null || _f === void 0 ? void 0 : _f.call(props)) || renderDefaultCancel()])])]);\n    };\n  }\n});"],"names":["_createVNode","defineComponent","inject","func","oneOfType","string","Intl","selectorPrefix","name","props","rowKey","def","renderEditorTable","renderSave","renderCancel","onEditor","onSave","emits","setup","_a","renderDefaultEditorTable","tv","_b","call","then","updateTableEdit","form","validateFields","validateFieldsSuccess","values","updateEditorCellTableData","context","isTableEditor","onReset","setFieldValuesByDataSource","slots","_c","_d","changeData","updateEditorData","_f","class","concat","onClick","_e"],"mappings":"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"}