{"version":3,"file":"index.js","sources":["Extension/EditableCell/EditableTableControl/index.js"],"sourcesContent":["import Intl from '@baifendian/adherev-util-intl';\nimport { selectorPrefix } from '../../../SearchTable';\nexport default {\n  name: 'adv-searchtable-editable-control',\n  props: {\n    rowKey: {\n      type: String\n    },\n    renderEditorTable: {\n      type: Function\n    },\n    renderSave: {\n      type: Function\n    },\n    renderCancel: {\n      type: Function\n    },\n    onEditor: {\n      type: Function\n    },\n    onSave: {\n      type: Function\n    }\n  },\n  emits: ['renderEditorTable', 'renderSave', 'renderCancel'],\n  inject: ['getFormIns', 'getContext'],\n  methods: {\n    renderDefaultSave: function renderDefaultSave(h) {\n      return h(\"a\", [Intl.tv('保存')]);\n      // return <a>保存</a>;\n    },\n\n    renderDefaultCancel: function renderDefaultCancel(h) {\n      return h(\"a\", [Intl.tv('取消')]);\n      // return <a>取消</a>;\n    },\n\n    renderDefaultEditorTable: function renderDefaultEditorTable(h) {\n      return h(\"a\", [Intl.tv('编辑表格')]);\n      // return <a>编辑表格</a>;\n    },\n\n    $onEditor: function $onEditor() {\n      var _this = this;\n      var _a, _b;\n      if (this.onEditor) {\n        (_b = (_a = this.onEditor) === null || _a === void 0 ? void 0 : _a.call(this)) === null || _b === void 0 ? void 0 : _b.then(function () {\n          return _this.updateTableEdit();\n        });\n        return;\n      }\n      this.updateTableEdit();\n    },\n    $onSave: function $onSave() {\n      var _this = this;\n      var _a, _b, _c;\n      var form = (_a = this.getFormIns) === null || _a === void 0 ? void 0 : _a.call(this);\n      (_c = (_b = form === null || form === void 0 ? void 0 : form.validateFields()) === null || _b === void 0 ? void 0 : _b.then) === null || _c === void 0 ? void 0 : _c.call(_b, function (values) {\n        return _this.validateFieldsSuccess(values);\n      });\n    },\n    validateFieldsSuccess: function validateFieldsSuccess(values) {\n      var _this = this;\n      if (this.onSave) {\n        this.onSave(values).then(function () {\n          return _this.updateEditorCellTableData(values);\n        });\n        return;\n      }\n      this.updateEditorCellTableData(values);\n    },\n    updateEditorCellTableData: function updateEditorCellTableData(changeData) {\n      var _this = this;\n      var _a, _b, _c;\n      var context = (_b = (_a = this.getContext) === null || _a === void 0 ? void 0 : _a.call(this)) === null || _b === void 0 ? void 0 : _b.context;\n      (_c = context === null || context === void 0 ? void 0 : context.updateEditorData(changeData)) === null || _c === void 0 ? void 0 : _c.then(function () {\n        return _this.reset();\n      });\n    },\n    updateTableEdit: function updateTableEdit() {\n      var _a, _b;\n      var context = (_b = (_a = this.getContext) === null || _a === void 0 ? void 0 : _a.call(this)) === null || _b === void 0 ? void 0 : _b.context;\n      if (context) {\n        context.isTableEditor = true;\n      }\n    },\n    reset: function reset() {\n      var _a, _b;\n      var context = (_b = (_a = this.getContext) === null || _a === void 0 ? void 0 : _a.call(this)) === null || _b === void 0 ? void 0 : _b.context;\n      if (context) {\n        context.isTableEditor = false;\n      }\n    }\n  },\n  render: function render(h) {\n    var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l;\n    var context = (_a = this.getContext) === null || _a === void 0 ? void 0 : _a.call(this).context;\n    return h(\"div\", {\n      \"class\": \"\".concat(selectorPrefix, \"-editor-table-control\")\n    }, [!(context === null || context === void 0 ? void 0 : context.isTableEditor) && h(\"div\", {\n      \"class\": \"\".concat(selectorPrefix, \"-editor-table-control-edit\"),\n      \"on\": {\n        \"click\": this.$onEditor\n      }\n    }, [((_c = (_b = this.$slots) === null || _b === void 0 ? void 0 : _b[this.renderEditorTable]) === null || _c === void 0 ? void 0 : _c.call(_b)) || ((_d = this.renderEditorTable) === null || _d === void 0 ? void 0 : _d.call(this, h)) || ((_e = this.renderDefaultEditorTable) === null || _e === void 0 ? void 0 : _e.call(this, h))]), (context === null || context === void 0 ? void 0 : context.isTableEditor) && h(\"div\", {\n      \"class\": \"\".concat(selectorPrefix, \"-editor-table-control-save-cancel\")\n    }, [h(\"div\", {\n      \"class\": \"\".concat(selectorPrefix, \"-editor-table-control-save-cancel-item\"),\n      \"on\": {\n        \"click\": this.$onSave\n      }\n    }, [((_g = (_f = this.$slots) === null || _f === void 0 ? void 0 : _f[this.renderSave]) === null || _g === void 0 ? void 0 : _g.call(_f)) || ((_h = this.renderSave) === null || _h === void 0 ? void 0 : _h.call(this, h)) || this.renderDefaultSave(h)]), h(\"div\", {\n      \"class\": \"\".concat(selectorPrefix, \"-editor-table-control-save-cancel-item\"),\n      \"on\": {\n        \"click\": this.reset\n      }\n    }, [((_k = (_j = this.$slots) === null || _j === void 0 ? void 0 : _j[this.renderCancel]) === null || _k === void 0 ? void 0 : _k.call(_j)) || ((_l = this.renderCancel) === null || _l === void 0 ? void 0 : _l.call(this, h)) || this.renderDefaultCancel(h)])])]);\n  }\n};"],"names":["Intl","selectorPrefix","name","props","rowKey","type","String","renderEditorTable","Function","renderSave","renderCancel","onEditor","onSave","emits","inject","methods","renderDefaultSave","h","tv","renderDefaultCancel","renderDefaultEditorTable","$onEditor","_b","_this","this","_a","call","then","updateTableEdit","$onSave","_c","form","getFormIns","validateFields","values","validateFieldsSuccess","updateEditorCellTableData","changeData","context","getContext","updateEditorData","reset","isTableEditor","render","_j","_k","class","concat","on","click","$slots","_d","_e","_g","_f","_h","_l"],"mappings":"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"}