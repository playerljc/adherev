import _Form from"ant-design-vue/es/form";import _CloseOutlined from"@ant-design/icons-vue/es/icons/CloseOutlined";import _CheckOutlined from"@ant-design/icons-vue/es/icons/CheckOutlined";import{mergeProps as _mergeProps,createVNode as _createVNode}from"vue";import"core-js/modules/es.array.concat.js";import{__assign}from"tslib";import{defineComponent,inject}from"vue";import{array,number,object}from"vue-types";import{selectorPrefix}from"../../../SearchTable";import FormItemGenerator from"./FormItemGenerator";export default defineComponent({props:{rowIndex:number(),record:object(),column:object(),columns:array().def([]),editableConfig:object()},emits:["triggerChange"],setup:function(d,e){function i(){var e,l,n=__assign({autoFocus:!(null!=(n=null==d?void 0:d.editableConfig)&&n.useKeepEdit)},(null==(n=null==d?void 0:d.editableConfig)?void 0:n.props)||{}),n=FormItemGenerator.render({type:null==(o=null==d?void 0:d.editableConfig)?void 0:o.type,props:n,dictName:null==(o=null==d?void 0:d.editableConfig)?void 0:o.dictName,renderChildren:null==(n=null==d?void 0:d.editableConfig)?void 0:n.renderChildren,dataIndex:null==(o=null==d?void 0:d.editableConfig)?void 0:o.dataIndex,rowIndex:null==d?void 0:d.rowIndex,initialValue:s,name:m,form:c,context:v}),o={value:null==(o=null==d?void 0:d.record)?void 0:o[null==(o=null==d?void 0:d.editableConfig)?void 0:o.dataIndex],record:null==d?void 0:d.record,dataIndex:null==(o=null==d?void 0:d.editableConfig)?void 0:o.dataIndex,rowIndex:null==d?void 0:d.rowIndex,children:n,form:c};return(null==(e=null==u?void 0:u[null==(e=null==d?void 0:d.editableConfig)?void 0:e.render])?void 0:e.call(u,o))||(null==(l=null==(e=null==d?void 0:d.editableConfig)?void 0:e.render)?void 0:l.call(e,o))||n}function r(){var e,o=l();null!=(e=null==d?void 0:d.editableConfig)&&e.onSave?null!=c&&c.validateFields().then(function(e){var l,n;null!=(n=null==(l=null==(n=null==d?void 0:d.editableConfig)?void 0:n.onSave)?void 0:l.call(n,{value:o,values:e,record:null==d?void 0:d.record,dataIndex:null==(l=null==d?void 0:d.editableConfig)?void 0:l.dataIndex,rowIndex:null==d?void 0:d.rowIndex}))&&n.then(function(){a("triggerChange")})}):a("triggerChange")}function t(){var e,l,n=null==(n=null==d?void 0:d.record)?void 0:n[null==(n=null==d?void 0:d.editableConfig)?void 0:n.dataIndex];v.formData[m]=n,null!=(l=null==d?void 0:d.editableConfig)&&l.onBeforeCancel?null!=(l=null==(e=null==(l=null==d?void 0:d.editableConfig)?void 0:l.onBeforeCancel)?void 0:e.call(l,{value:n,record:null==d?void 0:d.record,dataIndex:null==(e=null==d?void 0:d.editableConfig)?void 0:e.dataIndex,rowIndex:null==d?void 0:d.rowIndex}))&&l.then(function(){return a("triggerChange")}):a("triggerChange")}function l(){return v.formData[m]}var a=e.emit,u=e.slots,e=inject("getContext"),v=null==(e=null==e?void 0:e())?void 0:e.context,c=inject("getFormIns")(),g={value:null==(e=d.record)?void 0:e[null==(e=null==d?void 0:d.editableConfig)?void 0:e.dataIndex],record:d.record,dataIndex:null==(e=null==d?void 0:d.editableConfig)?void 0:e.dataIndex,rowIndex:d.rowIndex},f={value:null==(e=d.record)?void 0:e[null==(e=null==d?void 0:d.editableConfig)?void 0:e.dataIndex],record:d.record,dataIndex:null==(e=null==d?void 0:d.editableConfig)?void 0:e.dataIndex,rowIndex:d.rowIndex},s=null==v?void 0:v.valueToFormItemValue({type:null==(e=null==d?void 0:d.editableConfig)?void 0:e.type,record:d.record,dataIndex:null==(e=null==d?void 0:d.editableConfig)?void 0:e.dataIndex}),C={initialValue:s,value:null==(e=d.record)?void 0:e[null==(e=null==d?void 0:d.editableConfig)?void 0:e.dataIndex],record:d.record,dataIndex:null==(e=null==d?void 0:d.editableConfig)?void 0:e.dataIndex,rowIndex:d.rowIndex,form:c},m="".concat(null==(e=null==d?void 0:d.editableConfig)?void 0:e.dataIndex,"_").concat(null==d?void 0:d.rowIndex);return function(){var e,l,n,o;return _createVNode("div",{class:"".concat(selectorPrefix,"-editablecell-edit")},[_createVNode("div",{class:"".concat(selectorPrefix,"-editablecell-edit-inner")},[_createVNode(_Form.Item,_mergeProps({name:"".concat(null==(o=null==d?void 0:d.editableConfig)?void 0:o.dataIndex,"_").concat(d.rowIndex),rules:null==(o=null==d?void 0:d.editableConfig)?void 0:o.rules},(null==(o=null==d?void 0:d.editableConfig)?void 0:o.formItemProps)||{}),{default:function(){return["custom"!==(null==(e=null==d?void 0:d.editableConfig)?void 0:e.type)?null===i?void 0:i():(null==(e=null==u?void 0:u[null==(e=null==d?void 0:d.editableConfig)?void 0:e.render])?void 0:e.call(u,C))||(null==(l=null==(e=null==d?void 0:d.editableConfig)?void 0:e.render)?void 0:l.call(e,C))]}})]),!(null==(o=null==d?void 0:d.editableConfig)||!o.useTrigger)&&!(null!=(o=null==d?void 0:d.editableConfig)&&o.useKeepEdit)&&_createVNode("div",{class:"".concat(selectorPrefix,"-editablecell-edit-trigger")},[_createVNode("div",{class:"".concat(selectorPrefix,"-editablecell-edit-trigger-inner")},[_createVNode("div",{class:"".concat(selectorPrefix,"-editablecell-edit-trigger-save"),onClick:r},[(null==(o=null==u?void 0:u[null==(o=null==d?void 0:d.editableConfig)?void 0:o.renderSaveTrigger])?void 0:o.call(u,g))||(null==(n=null==(o=null==d?void 0:d.editableConfig)?void 0:o.renderSaveTrigger)?void 0:n.call(o,g))||_createVNode(_CheckOutlined,null,null)]),_createVNode("div",{class:"".concat(selectorPrefix,"-editablecell-edit-trigger-cancel"),onClick:t},[(null==(o=null==u?void 0:u[null==(n=null==d?void 0:d.editableConfig)?void 0:n.renderCancelTrigger])?void 0:o.call(u,f))||(null==(o=null==(n=null==d?void 0:d.editableConfig)?void 0:n.renderCancelTrigger)?void 0:o.call(n,f))||_createVNode(_CloseOutlined,null,null)])])])])}}});
//# sourceMappingURL=EditableTableCellEdit.js.map
