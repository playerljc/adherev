import{createVNode as _createVNode,mergeProps as _mergeProps}from"vue";import{__assign}from"tslib";import{computed,h,inject,onBeforeUnmount,ref,toRaw,watch}from"vue";import EditableCellEdit from"./Edit/EditableCellEdit";import EditableCellView from"./View";var useEditableCell=function(l,e){var t=inject("getContext"),n=null==(t=null==t?void 0:t())?void 0:t.context,i=inject("setActiveValue"),u={defaultConfig:{editable:!1,defaultStatus:"view",type:"input",props:{},formItemProps:{},useTrigger:!0,require:!0,dataIndex:null==(t=l.column)?void 0:t.dataIndex,useKeepEdit:!1}},a=ref((null==(t=null==(t=l.column)?void 0:t.$editable)?void 0:t.defaultStatus)||"view"),o=computed(function(){var e;return __assign(__assign({},u.defaultConfig),(null==(e=l.column)?void 0:e.$editable)||{})}),r=watch(function(){return null==n?void 0:n.getData()},function(){a.value=o.value.defaultStatus}),d=watch(function(){var e;return null==(e=null==(e=l.column)?void 0:e.$editable)?void 0:e.defaultStatus},function(){a.value=o.value.defaultStatus});return onBeforeUnmount(function(){r(),d()}),function(e){var t=e;return o.value.editable?o.value.useKeepEdit?t=h(e,{},[_createVNode(EditableCellEdit,_mergeProps(toRaw(l),{editableConfig:o.value,onTriggerChange:function(){null!=i&&i(""),a.value="view"}}),{default:function(){return[e.children]}})]):"view"===a.value?t=h(e,{},[_createVNode(EditableCellView,_mergeProps(toRaw(l),{editableConfig:o.value,onTriggerChange:function(){null!=i&&i(l.record[l.column.dataIndex]),a.value="edit"}}),{default:function(){return[e.children]}})]):"edit"===a.value&&(t=h(e,{},[_createVNode(EditableCellEdit,_mergeProps(toRaw(l),{editableConfig:o.value,onTriggerChange:function(){null!=i&&i(""),a.value="view"}}),{default:function(){return[e.children]}})])):t=e,t}};export{useEditableCell};
//# sourceMappingURL=EditableCell.js.map
