{"version":3,"file":"jdcategorytab.js","sources":["jdcategorytab.js"],"sourcesContent":["import { createVNode as _createVNode } from \"vue\";\nimport \"core-js/modules/es.array.find-index.js\";\nimport \"core-js/modules/es.array.from.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport classNames from 'classnames';\nimport IScroll from 'iscroll/build/iscroll';\nimport { computed, defineComponent, nextTick, onMounted, provide, ref, watch } from 'vue';\nimport { array, func, object, string } from 'vue-types';\nvar selectorPrefix = 'adherev-ui-jdcategorytab';\nvar props = {\n  className: string().def(''),\n  menuClassName: string().def(''),\n  menuStyle: object().def({}),\n  menuInnerClassName: string().def(''),\n  menuInnerStyle: object().def({}),\n  tabClassName: string().def(''),\n  tabStyle: object().def({}),\n  menuItemClassName: string().def(''),\n  menuItemStyle: object().def({}),\n  menuData: array().def([]),\n  defaultActiveKey: string().def(''),\n  onBeforeChange: func()\n};\nexport default defineComponent({\n  name: 'adv-jdcategorytab',\n  props: props,\n  slots: ['menuItem'],\n  emits: ['change'],\n  setup: function setup(props, _a) {\n    var slots = _a.slots,\n      emit = _a.emit,\n      expose = _a.expose;\n    var activeKey = ref(props.defaultActiveKey);\n    var menuEl = ref(null);\n    var menuInnerEl = ref(null);\n    var scroll = null;\n    var ease = IScroll.utils.ease;\n    var getMenuClassName = computed(function () {\n      return classNames(\"\".concat(selectorPrefix, \"-menu\"), props.menuClassName || '');\n    });\n    var getMenuInnerClassName = computed(function () {\n      return classNames(\"\".concat(selectorPrefix, \"-menu-inner\"), props.menuInnerClassName || '');\n    });\n    var getTabClassName = computed(function () {\n      return classNames(\"\".concat(selectorPrefix, \"-tab\"), props.tabClassName || '');\n    });\n    var getMenuItemClassName = computed(function () {\n      return function (curKey) {\n        return classNames(\"\".concat(selectorPrefix, \"-menu-item\"), activeKey.value === curKey ? 'active' : null, props.menuItemClassName || '');\n      };\n    });\n    var initMenuScroll = function initMenuScroll() {\n      scroll = new IScroll(menuEl.value, {\n        mouseWheel: true,\n        click: true\n      });\n      menuEl.value.addEventListener('touchmove', function (e) {\n        e.preventDefault();\n      });\n    };\n    var findElByKey = function findElByKey(key) {\n      var _a;\n      var index = props.menuData.findIndex(function (t) {\n        return t.key === key;\n      });\n      var arr = Array.from((_a = menuInnerEl.value) === null || _a === void 0 ? void 0 : _a.querySelectorAll(\".\".concat(selectorPrefix, \"-menu-item\")));\n      if (arr.length) {\n        return arr[index];\n      }\n      return null;\n    };\n    var scrollTo = function scrollTo(key, time, easing) {\n      easing = easing || ease.circular;\n      var isCan = true;\n      if (props.onBeforeChange) {\n        isCan = props.onBeforeChange(activeKey.value, key);\n      }\n      if (!isCan) return;\n      scroll.scrollToElement(findElByKey(key), time, null, null, easing);\n      setTimeout(function () {\n        activeKey.value = key;\n        nextTick(function () {\n          emit('change', key);\n        });\n      }, time);\n    };\n    var renderMenu = function renderMenu() {\n      return props.menuData.map(function (data) {\n        return _createVNode(\"li\", {\n          \"key\": data.key,\n          \"class\": getMenuItemClassName.value(data.key),\n          \"style\": props.menuItemStyle\n        }, [_createVNode(\"a\", {\n          \"onClick\": function onClick() {\n            return scrollTo(data.key);\n          }\n        }, [slots.menuItem ? slots.menuItem(data) : data.name])]);\n      });\n    };\n    watch(function () {\n      return props.defaultActiveKey;\n    }, function (newActiveKey) {\n      activeKey.value = newActiveKey;\n    });\n    onMounted(function () {\n      initMenuScroll();\n    });\n    provide('activeKey', activeKey);\n    expose({\n      scrollTo: scrollTo\n    });\n    return function () {\n      return _createVNode(\"div\", {\n        \"class\": selectorPrefix\n      }, [_createVNode(\"div\", {\n        \"class\": getMenuClassName.value,\n        \"style\": props.menuStyle,\n        \"ref\": menuEl\n      }, [_createVNode(\"ul\", {\n        \"class\": getMenuInnerClassName.value,\n        \"style\": props.menuInnerStyle,\n        \"ref\": menuInnerEl\n      }, [renderMenu()])]), _createVNode(\"ul\", {\n        \"class\": getTabClassName.value,\n        \"style\": props.tabStyle\n      }, [slots.default ? slots.default() : null])]);\n    };\n  }\n});"],"names":["_createVNode","classNames","IScroll","computed","defineComponent","nextTick","onMounted","provide","ref","watch","array","func","object","string","selectorPrefix","props","className","def","menuClassName","menuStyle","menuInnerClassName","menuInnerStyle","tabClassName","tabStyle","menuItemClassName","menuItemStyle","menuData","defaultActiveKey","onBeforeChange","name","slots","emits","setup","_a","scrollTo","key","time","easing","ease","circular","arr","isCan","activeKey","value","scroll","scrollToElement","index","findIndex","t","Array","from","menuInnerEl","querySelectorAll","concat","length","setTimeout","emit","expose","menuEl","utils","getMenuClassName","getMenuInnerClassName","getTabClassName","getMenuItemClassName","curKey","newActiveKey","mouseWheel","click","addEventListener","e","preventDefault","class","style","map","data","onClick","menuItem","default"],"mappings":"OAAwBA,2BAAyB,KAAL,YACrC,+CACA,yCACA,8CACA,yCACAC,eAAgB,oBAChBC,YAAa,+BACXC,SAAUC,gBAAiBC,SAAUC,UAAWC,QAASC,IAAKC,KAAkB,KAAL,aAC3EC,MAAOC,KAAMC,OAAQC,MAAyB,KAAX,YAC5C,IAAIC,eAAiB,2BACjBC,MAAQ,CACVC,UAAWH,OAAO,EAAEI,IAAI,EAAE,EAC1BC,cAAeL,OAAO,EAAEI,IAAI,EAAE,EAC9BE,UAAWP,OAAO,EAAEK,IAAI,EAAE,EAC1BG,mBAAoBP,OAAO,EAAEI,IAAI,EAAE,EACnCI,eAAgBT,OAAO,EAAEK,IAAI,EAAE,EAC/BK,aAAcT,OAAO,EAAEI,IAAI,EAAE,EAC7BM,SAAUX,OAAO,EAAEK,IAAI,EAAE,EACzBO,kBAAmBX,OAAO,EAAEI,IAAI,EAAE,EAClCQ,cAAeb,OAAO,EAAEK,IAAI,EAAE,EAC9BS,SAAUhB,MAAM,EAAEO,IAAI,EAAE,EACxBU,iBAAkBd,OAAO,EAAEI,IAAI,EAAE,EACjCW,eAAgBjB,KAAK,CACvB,iBACeP,gBAAgB,CAC7ByB,KAAM,oBACNd,MAAOA,MACPe,MAAO,CAAC,YACRC,MAAO,CAAC,UACRC,MAAO,SAAejB,EAAOkB,GA2CZ,SAAXC,EAA6BC,EAAKC,EAAMC,GAC1CA,EAASA,GAAUC,EAAKC,SACxB,IAbqCJ,EAKjCK,EAQAC,EAAQ,CAAA,GAEVA,EADE1B,EAAMa,eACAb,EAAMa,eAAec,EAAUC,MAAOR,CAAG,EAE9CM,KACLG,EAAOC,iBAlB8BV,EAkBFA,EAhB/BW,EAAQ/B,EAAMW,SAASqB,UAAU,SAAUC,GAC7C,OAAOA,EAAEb,MAAQA,CACnB,CAAC,GACGK,EAAMS,MAAMC,KAAK,OAACjB,EAAKkB,EAAYR,OAAmC,KAAA,EAASV,EAAGmB,iBAAiB,IAAIC,OAAOvC,eAAgB,YAAY,CAAC,CAAC,GACxIwC,OACCd,EAAIM,GAEN,MASkCV,EAAM,KAAM,KAAMC,CAAM,EACjEkB,WAAW,WACTb,EAAUC,MAAQR,EAClB9B,SAAS,WACPmD,EAAK,SAAUrB,CAAG,CACpB,CAAC,CACH,EAAGC,CAAI,EACT,CAxDA,IAAIN,EAAQG,EAAGH,MACb0B,EAAOvB,EAAGuB,KACVC,EAASxB,EAAGwB,OACVf,EAAYlC,IAAIO,EAAMY,gBAAgB,EACtC+B,EAASlD,IAAI,IAAI,EACjB2C,EAAc3C,IAAI,IAAI,EACtBoC,EAAS,KACTN,EAAOpC,QAAQyD,MAAMrB,KACrBsB,EAAmBzD,SAAS,WAC9B,OAAOF,WAAW,GAAGoD,OAAOvC,eAAgB,OAAO,EAAGC,EAAMG,eAAiB,EAAE,CACjF,CAAC,EACG2C,EAAwB1D,SAAS,WACnC,OAAOF,WAAW,GAAGoD,OAAOvC,eAAgB,aAAa,EAAGC,EAAMK,oBAAsB,EAAE,CAC5F,CAAC,EACG0C,EAAkB3D,SAAS,WAC7B,OAAOF,WAAW,GAAGoD,OAAOvC,eAAgB,MAAM,EAAGC,EAAMO,cAAgB,EAAE,CAC/E,CAAC,EACGyC,EAAuB5D,SAAS,WAClC,OAAO,SAAU6D,GACf,OAAO/D,WAAW,GAAGoD,OAAOvC,eAAgB,YAAY,EAAG4B,EAAUC,QAAUqB,EAAS,SAAW,KAAMjD,EAAMS,mBAAqB,EAAE,CACxI,CACF,CAAC,EA6DD,OAZAf,MAAM,WACJ,OAAOM,EAAMY,gBACf,EAAG,SAAUsC,GACXvB,EAAUC,MAAQsB,CACpB,CAAC,EACD3D,UAAU,WApDRsC,EAAS,IAAI1C,QAAQwD,EAAOf,MAAO,CACjCuB,WAAY,CAAA,EACZC,MAAO,CAAA,CACT,CAAC,EACDT,EAAOf,MAAMyB,iBAAiB,YAAa,SAAUC,GACnDA,EAAEC,eAAe,CACnB,CAAC,CAgDH,CAAC,EACD/D,QAAQ,YAAamC,CAAS,EAC9Be,EAAO,CACLvB,SAAUA,CACZ,CAAC,EACM,WACL,OAAOlC,aAAa,MAAO,CACzBuE,MAASzD,cACX,EAAG,CAACd,aAAa,MAAO,CACtBuE,MAASX,EAAiBjB,MAC1B6B,MAASzD,EAAMI,UACfX,IAAOkD,CACT,EAAG,CAAC1D,aAAa,KAAM,CACrBuE,MAASV,EAAsBlB,MAC/B6B,MAASzD,EAAMM,eACfb,IAAO2C,CACT,EAAG,CAnCIpC,EAAMW,SAAS+C,IAAI,SAAUC,GAClC,OAAO1E,aAAa,KAAM,CACxBmC,IAAOuC,EAAKvC,IACZoC,MAASR,EAAqBpB,MAAM+B,EAAKvC,GAAG,EAC5CqC,MAASzD,EAAMU,aACjB,EAAG,CAACzB,aAAa,IAAK,CACpB2E,QAAW,WACT,OAAOzC,EAASwC,EAAKvC,GAAG,CAC1B,CACF,EAAG,CAACL,EAAM8C,SAAW9C,EAAM8C,SAASF,CAAI,EAAIA,EAAK7C,KAAK,EAAE,CAC1D,CAAC,EAyBgB,EAAE,EAAG7B,aAAa,KAAM,CACvCuE,MAAST,EAAgBnB,MACzB6B,MAASzD,EAAMQ,QACjB,EAAG,CAACO,EAAM+C,QAAU/C,EAAM+C,QAAQ,EAAI,KAAK,EAAE,CAC/C,CACF,CACF,CAAC"}