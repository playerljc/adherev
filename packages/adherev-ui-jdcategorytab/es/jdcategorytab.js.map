{"version":3,"file":"jdcategorytab.js","sources":["jdcategorytab.js"],"sourcesContent":["import { createVNode as _createVNode } from \"vue\";\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.string.split.js\";\nimport \"core-js/modules/es.array.find-index.js\";\nimport \"core-js/modules/es.array.from.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport classNames from 'classnames'; // @ts-ignore\n\nimport IScroll from 'iscroll/build/iscroll';\nimport { computed, defineComponent, nextTick, onMounted, provide, ref, watch } from 'vue';\nimport { array, func, object, string } from 'vue-types';\nvar selectorPrefix = 'adherev-ui-jdcategorytab';\nvar props = {\n  className: string().def(''),\n  menuClassName: string().def(''),\n  menuStyle: object().def({}),\n  menuInnerClassName: string().def(''),\n  menuInnerStyle: object().def({}),\n  tabClassName: string().def(''),\n  tabStyle: object().def({}),\n  menuItemClassName: string().def(''),\n  menuItemStyle: object().def({}),\n  menuData: array().def([]),\n  defaultActiveKey: string().def(''),\n  onBeforeChange: func()\n};\nexport default defineComponent({\n  name: 'adv-jdcategorytab',\n  props: props,\n  slots: ['menuItem'],\n  emits: ['change'],\n  setup: function setup(props, _a) {\n    var slots = _a.slots,\n        emit = _a.emit,\n        expose = _a.expose;\n    var activeKey = ref(props.defaultActiveKey);\n    var menuEl = ref(null);\n    var menuInnerEl = ref(null);\n    var scroll = null;\n    var ease = IScroll.utils.ease;\n    var getMenuClassName = computed(function () {\n      return classNames(\"\".concat(selectorPrefix, \"-menu\"), props.menuClassName.split(/\\s+/));\n    });\n    var getMenuInnerClassName = computed(function () {\n      return classNames(\"\".concat(selectorPrefix, \"-menu-inner\"), props.menuInnerClassName.split(/\\s+/));\n    });\n    var getTabClassName = computed(function () {\n      return classNames(\"\".concat(selectorPrefix, \"-tab\"), props.tabClassName.split(/\\s+/));\n    });\n    var getMenuItemClassName = computed(function () {\n      return function (curKey) {\n        return classNames(\"\".concat(selectorPrefix, \"-menu-item\"), activeKey.value === curKey ? 'active' : null, props.menuItemClassName.split(/\\s+/));\n      };\n    });\n\n    var initMenuScroll = function initMenuScroll() {\n      scroll = new IScroll(menuEl.value, {\n        mouseWheel: true,\n        click: true\n      });\n      menuEl.value.addEventListener('touchmove', function (e) {\n        e.preventDefault();\n      });\n    };\n\n    var findElByKey = function findElByKey(key) {\n      var _a;\n\n      var index = props.menuData.findIndex(function (t) {\n        return t.key === key;\n      });\n      var arr = Array.from((_a = menuInnerEl.value) === null || _a === void 0 ? void 0 : _a.querySelectorAll(\".\".concat(selectorPrefix, \"-menu-item\")));\n\n      if (arr.length) {\n        return arr[index];\n      }\n\n      return null;\n    };\n\n    var scrollTo = function scrollTo(key, time, easing) {\n      easing = easing || ease.circular;\n      var isCan = true;\n\n      if (props.onBeforeChange) {\n        isCan = props.onBeforeChange(activeKey.value, key);\n      }\n\n      if (!isCan) return;\n      scroll.scrollToElement(findElByKey(key), time, null, null, easing);\n      setTimeout(function () {\n        activeKey.value = key;\n        nextTick(function () {\n          emit('change', key);\n        });\n      }, time);\n    };\n\n    var renderMenu = function renderMenu() {\n      return props.menuData.map(function (data) {\n        return (// @ts-ignore\n          _createVNode(\"li\", {\n            \"key\": data.key,\n            \"class\": getMenuItemClassName.value(data.key),\n            \"style\": props.menuItemStyle\n          }, [_createVNode(\"a\", {\n            \"onClick\": function onClick() {\n              scrollTo(data.key);\n            }\n          }, [slots.menuItem ? slots.menuItem(data) : data.name])])\n        );\n      });\n    };\n\n    watch(function () {\n      return props.defaultActiveKey;\n    }, function (newActiveKey) {\n      activeKey.value = newActiveKey;\n    });\n    onMounted(function () {\n      initMenuScroll();\n    });\n    provide('activeKey', activeKey);\n    expose({\n      scrollTo: scrollTo\n    });\n    return function () {\n      return _createVNode(\"div\", {\n        \"class\": selectorPrefix\n      }, [_createVNode(\"div\", {\n        \"class\": getMenuClassName.value,\n        \"style\": props.menuStyle,\n        \"ref\": menuEl\n      }, [_createVNode(\"ul\", {\n        \"class\": getMenuInnerClassName.value,\n        \"style\": props.menuInnerStyle,\n        \"ref\": menuInnerEl\n      }, [renderMenu()])]), _createVNode(\"ul\", {\n        \"class\": getTabClassName.value,\n        \"style\": props.tabStyle\n      }, [slots.default ? slots.default() : null])]);\n    };\n  }\n});"],"names":["_createVNode","classNames","IScroll","computed","defineComponent","nextTick","onMounted","provide","ref","watch","array","func","object","string","selectorPrefix","props","className","def","menuClassName","menuStyle","menuInnerClassName","menuInnerStyle","tabClassName","tabStyle","menuItemClassName","menuItemStyle","menuData","defaultActiveKey","onBeforeChange","name","slots","emits","setup","_a","scrollTo","key","time","easing","ease","circular","arr","isCan","activeKey","value","scroll","scrollToElement","index","findIndex","t","Array","from","menuInnerEl","querySelectorAll","concat","length","setTimeout","emit","expose","menuEl","utils","getMenuClassName","split","getMenuInnerClassName","getTabClassName","getMenuItemClassName","curKey","newActiveKey","mouseWheel","click","addEventListener","e","preventDefault","class","style","map","data","onClick","menuItem","default"],"mappings":"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"}