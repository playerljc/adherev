{"version":3,"file":"notification.js","sources":["notification.js"],"sourcesContent":["import { createVNode as _createVNode, Fragment as _Fragment } from \"vue\";\nimport \"core-js/modules/es.object.assign.js\";\nimport \"core-js/modules/es.array.join.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.promise.js\";\nimport { v1 } from 'uuid';\nimport { createApp, h } from 'vue';\nimport Util from '@baifendian/adherev-util';\nvar selectorPrefix = 'adherev-ui-notification';\n/**\n * Notification\n * @class Notification\n * @classdesc Notification\n */\n\nvar Notification =\n/** @class */\nfunction () {\n  function Notification(container, config) {\n    this.config = {\n      style: 'material',\n      type: 'top'\n    }; // 存放所有的notification\n\n    this.notifications = {};\n    this.key = false;\n    this.container = container;\n    this.config = Object.assign(this.config, config);\n    this.createInnerContainer();\n    this.init();\n    this.initEvents();\n  }\n  /**\n   * createInnerContainer\n   * @private\n   */\n\n\n  Notification.prototype.createInnerContainer = function () {\n    var _a;\n\n    var innerContainer = this.container.querySelector(\".\".concat(selectorPrefix));\n\n    if (innerContainer) {\n      (_a = innerContainer === null || innerContainer === void 0 ? void 0 : innerContainer.parentElement) === null || _a === void 0 ? void 0 : _a.removeChild(innerContainer);\n    }\n\n    this.innerContainer = document.createElement('div');\n    this.innerContainer.className = selectorPrefix;\n    this.notificationContainer = document.createElement('ul');\n    this.innerContainer.appendChild(this.notificationContainer);\n    this.container.appendChild(this.innerContainer);\n  };\n  /**\n   * init\n   * @private\n   */\n\n\n  Notification.prototype.init = function () {\n    var config = this.config;\n    if (!this.innerContainer) return;\n    this.innerContainer.classList.remove([selectorPrefix].concat([config.type === 'top' ? 'bottom' : 'top', config.style]).join('-'));\n    this.innerContainer.classList.add([selectorPrefix].concat([config.type, config.style]).join('-'));\n  };\n  /**\n   * initEvents\n   * @private\n   */\n\n\n  Notification.prototype.initEvents = function () {\n    var self = this;\n    if (!this.notificationContainer) return;\n    this.notificationContainer.addEventListener('click', function (e) {\n      var _a, _b;\n\n      if (e.target.classList.contains('closeBtn')) {\n        var topDom = (_a = Util.getTopDom) === null || _a === void 0 ? void 0 : _a.call(Util, e.target, \"\".concat(selectorPrefix, \"-item\"));\n\n        if (topDom) {\n          self.closeNotification.call(self, (_b = topDom === null || topDom === void 0 ? void 0 : topDom.dataset) === null || _b === void 0 ? void 0 : _b.id);\n        }\n      }\n    });\n  };\n  /**\n   * closeNotification - 点击删除通知\n   * closeNotification\n   * @param {string} id\n   * @access private\n   */\n\n\n  Notification.prototype.closeNotification = function (id) {\n    var self = this;\n    if (self.key) return;\n    self.key = true;\n    var n = self.notifications[id];\n\n    function transitionendAction() {\n      var _a;\n\n      n.removeEventListener('transitionend', transitionendAction);\n      (_a = self === null || self === void 0 ? void 0 : self.notificationContainer) === null || _a === void 0 ? void 0 : _a.removeChild(n);\n      self.key = false; // closeAfter\n\n      self.trigger('onCloseAfter', n);\n    } // closeBefore\n\n\n    self.trigger('onCloseBefore', n);\n    n.addEventListener('transitionend', transitionendAction);\n    n.style.overflow = 'hidden';\n    n.querySelector('.info').style.opacity = '0';\n    n.style.height = '0';\n  };\n  /**\n   * buildCustom\n   * @param config\n   * @return Promise<String>\n   * @private\n   */\n\n\n  Notification.prototype.buildCustom = function (config) {\n    var _this = this;\n\n    return new Promise(function (resolve) {\n      var closed = config.closed,\n          children = config.children;\n      var id = v1();\n      var n = document.createElement('li');\n      n.className = \"\".concat(selectorPrefix, \"-item\");\n      n.dataset.id = id;\n      var self = _this;\n      createApp({\n        mounted: function mounted() {\n          resolve(self.build(id, n));\n        },\n        render: function render() {\n          var _a, _b;\n\n          return _createVNode(_Fragment, null, [_createVNode(\"div\", {\n            \"class\": \"info\"\n          }, [((_a = Util.isObject) === null || _a === void 0 ? void 0 : _a.call(Util, children)) ? h(children) : ((_b = Util.isFunction) === null || _b === void 0 ? void 0 : _b.call(Util, children)) ? children() : children || '']), closed ? _createVNode(\"span\", {\n            \"class\": \"closeBtn\"\n          }, null) : null]);\n        }\n      }).mount(n);\n    });\n  };\n  /**\n   * buildStandard\n   * @param config\n   * @return Promise<string>\n   * @private\n   */\n\n\n  Notification.prototype.buildStandard = function (config) {\n    var _this = this;\n\n    return new Promise(function (resolve) {\n      var _a = config.headerLabel,\n          headerLabel = _a === void 0 ? '' : _a,\n          _b = config.headerIcon,\n          headerIcon = _b === void 0 ? '' : _b,\n          _c = config.title,\n          title = _c === void 0 ? '' : _c,\n          _d = config.text,\n          text = _d === void 0 ? '' : _d,\n          _e = config.icon,\n          icon = _e === void 0 ? '' : _e,\n          _f = config.closed,\n          closed = _f === void 0 ? true : _f,\n          _g = config.datetime,\n          datetime = _g === void 0 ? '' : _g;\n      var id = v1();\n      var n = document.createElement('li');\n      n.className = \"\".concat(selectorPrefix, \"-item\");\n      n.dataset.id = id;\n      var self = _this;\n      createApp({\n        mounted: function mounted() {\n          resolve(self.build(id, n));\n        },\n        render: function render() {\n          var _a, _b, _c, _d, _e, _f, _g, _h;\n\n          return _createVNode(_Fragment, null, [_createVNode(\"div\", {\n            \"class\": \"info\"\n          }, [_createVNode(\"div\", {\n            \"class\": \"\".concat(selectorPrefix, \"-standard-header\")\n          }, [_createVNode(\"div\", {\n            \"class\": \"\".concat(selectorPrefix, \"-standard-header-icon\")\n          }, [headerIcon ? _createVNode(\"img\", {\n            \"src\": headerIcon,\n            \"alt\": \"\"\n          }, null) : null]), _createVNode(\"div\", {\n            \"class\": \"\".concat(selectorPrefix, \"-standard-header-label\")\n          }, [((_a = Util.isObject) === null || _a === void 0 ? void 0 : _a.call(Util, headerLabel)) ? h(headerLabel) : ((_b = Util.isFunction) === null || _b === void 0 ? void 0 : _b.call(Util, headerLabel)) ? headerLabel() : headerLabel || ''])]), _createVNode(\"div\", {\n            \"class\": \"\".concat(selectorPrefix, \"-standard-content\")\n          }, [_createVNode(\"div\", {\n            \"class\": \"\".concat(selectorPrefix, \"-standard-content-media-l\")\n          }, [icon ? _createVNode(\"img\", {\n            \"src\": icon,\n            \"alt\": \"\"\n          }, null) : null]), _createVNode(\"div\", {\n            \"class\": \"\".concat(selectorPrefix, \"-standard-content-row\")\n          }, [_createVNode(\"div\", {\n            \"class\": \"\".concat(selectorPrefix, \"-standard-content-row-title\")\n          }, [((_c = Util.isObject) === null || _c === void 0 ? void 0 : _c.call(Util, title)) ? h(title) : ((_d = Util.isFunction) === null || _d === void 0 ? void 0 : _d.call(Util, title)) ? title() : title || '']), _createVNode(\"div\", {\n            \"class\": \"\".concat(selectorPrefix, \"-standard-content-row-text\")\n          }, [((_e = Util.isObject) === null || _e === void 0 ? void 0 : _e.call(Util, text)) ? h(text) : ((_f = Util.isFunction) === null || _f === void 0 ? void 0 : _f.call(Util, text)) ? text() : text || ''])]), _createVNode(\"div\", {\n            \"class\": \"\".concat(selectorPrefix, \"-standard-content-media-r\")\n          }, [((_g = Util.isObject) === null || _g === void 0 ? void 0 : _g.call(Util, datetime)) ? h(datetime) : ((_h = Util.isFunction) === null || _h === void 0 ? void 0 : _h.call(Util, datetime)) ? datetime() : datetime || ''])])]), closed ? _createVNode(\"span\", {\n            \"class\": \"closeBtn\"\n          }, null) : null]);\n        }\n      }).mount(n);\n    });\n  };\n  /**\n   * build\n   * @param id\n   * @param n\n   * @return string\n   * @private\n   */\n\n\n  Notification.prototype.build = function (id, n) {\n    var _a;\n\n    var self = this;\n    this.notifications[id] = n;\n    (_a = this === null || this === void 0 ? void 0 : this.notificationContainer) === null || _a === void 0 ? void 0 : _a.appendChild(n);\n    self.trigger('onCreate', n);\n    n.style.height = 'auto';\n    var targetHeight = n.clientHeight; // 会有最小高度的限制\n\n    if (self.config.style === 'material') {\n      if (targetHeight < 40) {\n        targetHeight = 40;\n      }\n    } else if (self.config.style === 'ios') {\n      if (targetHeight < 70) {\n        targetHeight = 70;\n      }\n    }\n\n    n.style.height = '0';\n    setTimeout(function () {\n      n.style.height = \"\".concat(targetHeight, \"px\");\n      n.querySelector('.info').style.opacity = '1';\n      self.trigger('onShow', n);\n    }, 100);\n    return id;\n  };\n  /**\n   * trigger\n   * @param action\n   * @param params\n   * @private\n   */\n\n\n  Notification.prototype.trigger = function (action, params) {\n    if (this.config[action]) {\n      this.config[action](params);\n    }\n  };\n  /**\n   * show\n   * @param {Object} config\n   * @return Promise<string>\n   */\n\n\n  Notification.prototype.show = function (config) {\n    return this.buildCustom(config);\n  };\n  /**\n   * showStandard\n   * @param {Object} config\n   * @return Promise<string>\n   */\n\n\n  Notification.prototype.showStandard = function (config) {\n    return this.buildStandard(config);\n  };\n  /**\n   * close\n   * @param {string} id\n   */\n\n\n  Notification.prototype.close = function (id) {\n    this.closeNotification(id);\n  };\n\n  return Notification;\n}();\n\nexport { Notification };\nvar NotificationFactory = {\n  /**\n   * build\n   * @param container\n   * @param config\n   * @return Notification\n   */\n  build: function build(container, config) {\n    return new Notification(container, config);\n  }\n};\n/**\n * NotificationFactory\n */\n\nexport default NotificationFactory;"],"names":["_createVNode","_Fragment","v1","createApp","h","Util","selectorPrefix","Notification","container","config","this","style","type","notifications","key","Object","assign","createInnerContainer","init","initEvents","prototype","_a","innerContainer","querySelector","concat","parentElement","removeChild","document","createElement","className","notificationContainer","appendChild","classList","remove","join","add","self","addEventListener","e","topDom","target","contains","getTopDom","call","closeNotification","_b","dataset","id","n","trigger","transitionendAction","removeEventListener","overflow","opacity","height","buildCustom","_this","Promise","resolve","closed","children","mounted","build","render","class","isObject","isFunction","mount","buildStandard","headerLabel","headerIcon","_c","title","_d","text","_e","icon","_f","_g","datetime","_h","src","alt","targetHeight","clientHeight","setTimeout","action","params","show","showStandard","close","NotificationFactory"],"mappings":"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"}