{"version":3,"file":"notification.js","sources":["notification.js"],"sourcesContent":["\"use strict\";\n\nrequire(\"core-js/modules/es.object.define-property.js\");\n\nrequire(\"core-js/modules/es.object.assign.js\");\n\nrequire(\"core-js/modules/es.array.join.js\");\n\nrequire(\"core-js/modules/es.array.concat.js\");\n\nrequire(\"core-js/modules/es.object.to-string.js\");\n\nrequire(\"core-js/modules/es.promise.js\");\n\nvar __importDefault = void 0 && (void 0).__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar vue_1 = __importDefault(require(\"vue\"));\n\nvar vue_fragment_1 = require(\"vue-fragment\");\n\nvar uuid_1 = require(\"uuid\");\n\nvar adherev_util_1 = __importDefault(require(\"@baifendian/adherev-util\"));\n\nvar selectorPrefix = 'adherev-ui-notification';\n/**\n * Notification\n * @class Notification\n * @classdesc Notification\n */\n\nvar Notification =\n/** @class */\nfunction () {\n  function Notification(container, config) {\n    this.config = {\n      style: 'material',\n      type: 'top'\n    }; // 存放所有的notification\n\n    this.notifications = {};\n    this.key = false;\n    this.container = container;\n    this.config = Object.assign(this.config, config);\n    this.createInnerContainer();\n    this.init();\n    this.initEvents();\n  }\n  /**\n   * createInnerContainer\n   * @private\n   */\n\n\n  Notification.prototype.createInnerContainer = function () {\n    var innerContainer = this.container.querySelector(\".\" + selectorPrefix);\n\n    if (innerContainer) {\n      innerContainer.parentElement.removeChild(innerContainer);\n    }\n\n    this.innerContainer = document.createElement('div');\n    this.innerContainer.className = selectorPrefix;\n    this.notificationContainer = document.createElement('ul');\n    this.innerContainer.appendChild(this.notificationContainer);\n    this.container.appendChild(this.innerContainer);\n  };\n  /**\n   * init\n   * @private\n   */\n\n\n  Notification.prototype.init = function () {\n    var config = this.config;\n    this.innerContainer.classList.remove([selectorPrefix].concat([config.type === 'top' ? 'bottom' : 'top', config.style]).join('-'));\n    this.innerContainer.classList.add([selectorPrefix].concat([config.type, config.style]).join('-'));\n  };\n  /**\n   * initEvents\n   * @private\n   */\n\n\n  Notification.prototype.initEvents = function () {\n    var self = this;\n    this.notificationContainer.addEventListener('click', function (e) {\n      if (e.target.classList.contains('closeBtn')) {\n        var topDom = adherev_util_1.default.getTopDom(e.target, selectorPrefix + \"-item\");\n        self.closeNotification.call(self, topDom.dataset.id);\n      }\n    });\n  };\n  /**\n   * closeNotification - 点击删除通知\n   * closeNotification\n   * @param {string} id\n   * @access private\n   */\n\n\n  Notification.prototype.closeNotification = function (id) {\n    var self = this;\n    if (self.key) return;\n    self.key = true;\n    var n = self.notifications[id];\n\n    function transitionendAction() {\n      n.removeEventListener('transitionend', transitionendAction);\n      self.notificationContainer.removeChild(n);\n      self.key = false; // closeAfter\n\n      self.trigger('onCloseAfter', n);\n    } // closeBefore\n\n\n    self.trigger('onCloseBefore', n);\n    n.addEventListener('transitionend', transitionendAction);\n    n.style.overflow = 'hidden';\n    n.querySelector('.info').style.opacity = '0';\n    n.style.height = '0';\n  };\n  /**\n   * buildCustom\n   * @param config\n   * @return Promise<String>\n   * @private\n   */\n\n\n  Notification.prototype.buildCustom = function (config) {\n    var _this = this;\n\n    return new Promise(function (resolve) {\n      var closed = config.closed,\n          children = config.children;\n      var id = uuid_1.v1();\n      var n = document.createElement('li');\n      n.className = selectorPrefix + \"-item\";\n      n.dataset.id = id;\n      var div = document.createElement('div');\n      n.appendChild(div);\n      var self = _this;\n      new vue_1.default({\n        mounted: function mounted() {\n          resolve(self.build(id, n));\n        },\n        render: function render(h) {\n          return h(vue_fragment_1.Fragment, [h(\"div\", {\n            \"class\": \"info\"\n          }, [adherev_util_1.default.isObject(children) ? h(children) : adherev_util_1.default.isFunction(children) ? children(h) : children || '']), closed ? h(\"span\", {\n            \"class\": \"closeBtn\"\n          }) : null]);\n        }\n      }).$mount(div);\n    });\n  };\n  /**\n   * buildStandard\n   * @param config\n   * @return Promise<string>\n   * @private\n   */\n\n\n  Notification.prototype.buildStandard = function (config) {\n    var _this = this;\n\n    return new Promise(function (resolve) {\n      var _a = config.headerLabel,\n          headerLabel = _a === void 0 ? '' : _a,\n          _b = config.headerIcon,\n          headerIcon = _b === void 0 ? '' : _b,\n          _c = config.title,\n          title = _c === void 0 ? '' : _c,\n          _d = config.text,\n          text = _d === void 0 ? '' : _d,\n          _e = config.icon,\n          icon = _e === void 0 ? '' : _e,\n          _f = config.closed,\n          closed = _f === void 0 ? true : _f,\n          _g = config.datetime,\n          datetime = _g === void 0 ? '' : _g;\n      var id = uuid_1.v1();\n      var n = document.createElement('li');\n      n.className = selectorPrefix + \"-item\";\n      n.dataset.id = id;\n      var div = document.createElement('div');\n      n.appendChild(div);\n      var self = _this;\n      new vue_1.default({\n        mounted: function mounted() {\n          resolve(self.build(id, n));\n        },\n        render: function render(h) {\n          return h(vue_fragment_1.Fragment, [h(\"div\", {\n            \"class\": \"info\"\n          }, [h(\"div\", {\n            \"class\": selectorPrefix + \"-standard-header\"\n          }, [h(\"div\", {\n            \"class\": selectorPrefix + \"-standard-header-icon\"\n          }, [headerIcon ? h(\"img\", {\n            \"attrs\": {\n              \"src\": headerIcon,\n              \"alt\": \"\"\n            }\n          }) : null]), h(\"div\", {\n            \"class\": selectorPrefix + \"-standard-header-label\"\n          }, [adherev_util_1.default.isObject(headerLabel) ? h(headerLabel) : adherev_util_1.default.isFunction(headerLabel) ? headerLabel(h) : headerLabel || ''])]), h(\"div\", {\n            \"class\": selectorPrefix + \"-standard-content\"\n          }, [h(\"div\", {\n            \"class\": selectorPrefix + \"-standard-content-media-l\"\n          }, [icon ? h(\"img\", {\n            \"attrs\": {\n              \"src\": icon,\n              \"alt\": \"\"\n            }\n          }) : null]), h(\"div\", {\n            \"class\": selectorPrefix + \"-standard-content-row\"\n          }, [h(\"div\", {\n            \"class\": selectorPrefix + \"-standard-content-row-title\"\n          }, [adherev_util_1.default.isObject(title) ? h(title) : adherev_util_1.default.isFunction(title) ? title(h) : title || '']), h(\"div\", {\n            \"class\": selectorPrefix + \"-standard-content-row-text\"\n          }, [adherev_util_1.default.isObject(text) ? h(text) : adherev_util_1.default.isFunction(text) ? text(h) : text || ''])]), h(\"div\", {\n            \"class\": selectorPrefix + \"-standard-content-media-r\"\n          }, [adherev_util_1.default.isObject(datetime) ? h(datetime) : adherev_util_1.default.isFunction(datetime) ? datetime(h) : datetime || ''])])]), closed ? h(\"span\", {\n            \"class\": \"closeBtn\"\n          }) : null]);\n        }\n      }).$mount(div);\n    });\n  };\n  /**\n   * build\n   * @param id\n   * @param n\n   * @return string\n   * @private\n   */\n\n\n  Notification.prototype.build = function (id, n) {\n    var self = this;\n    this.notifications[id] = n;\n    this.notificationContainer.appendChild(n); // onCreate\n\n    self.trigger('onCreate', n);\n    n.style.height = 'auto';\n    var targetHeight = n.clientHeight; // 会有最小高度的限制\n\n    if (self.config.style === 'material') {\n      if (targetHeight < 40) {\n        targetHeight = 40;\n      }\n    } else if (self.config.style === 'ios') {\n      if (targetHeight < 70) {\n        targetHeight = 70;\n      }\n    }\n\n    n.style.height = '0';\n    setTimeout(function () {\n      n.style.height = targetHeight + \"px\";\n      n.querySelector('.info').style.opacity = '1';\n      self.trigger('onShow', n);\n    }, 100);\n    return id;\n  };\n  /**\n   * trigger\n   * @param action\n   * @param params\n   * @private\n   */\n\n\n  Notification.prototype.trigger = function (action, params) {\n    if (this.config[action]) {\n      this.config[action](params);\n    }\n  };\n  /**\n   * show\n   * @param {Object} config\n   * @return Promise<string>\n   */\n\n\n  Notification.prototype.show = function (config) {\n    return this.buildCustom(config);\n  };\n  /**\n   * showStandard\n   * @param {Object} config\n   * @return Promise<string>\n   */\n\n\n  Notification.prototype.showStandard = function (config) {\n    return this.buildStandard(config);\n  };\n  /**\n   * close\n   * @param {string} id\n   */\n\n\n  Notification.prototype.close = function (id) {\n    this.closeNotification(id);\n  };\n\n  return Notification;\n}();\n/**\n * NotificationFactory\n */\n\n\nexports.default = {\n  /**\n   * build\n   * @param container\n   * @param config\n   * @return Notification\n   */\n  build: function build(container, config) {\n    return new Notification(container, config);\n  }\n};"],"names":["require","__importDefault","mod","__esModule","default","Object","defineProperty","exports","value","vue_1","vue_fragment_1","uuid_1","adherev_util_1","selectorPrefix","Notification","container","config","this","style","type","notifications","key","assign","createInnerContainer","init","initEvents","prototype","innerContainer","querySelector","parentElement","removeChild","document","createElement","className","notificationContainer","appendChild","classList","remove","concat","join","add","self","addEventListener","e","target","contains","topDom","getTopDom","closeNotification","call","dataset","id","n","trigger","transitionendAction","removeEventListener","overflow","opacity","height","buildCustom","_this","Promise","resolve","closed","children","v1","div","mounted","build","render","h","Fragment","class","isObject","isFunction","$mount","buildStandard","_a","headerLabel","_b","headerIcon","_c","title","_d","text","_e","icon","_f","_g","datetime","attrs","src","alt","targetHeight","clientHeight","setTimeout","action","params","show","showStandard","close"],"mappings":"aAEAA,QAAQ,gDAERA,QAAQ,uCAERA,QAAQ,oCAERA,QAAQ,sCAERA,QAAQ,0CAERA,QAAQ,iCAER,IAAIC,gBAAwD,SAAUC,GACpE,OAAOA,GAAOA,EAAIC,WAAaD,EAAM,CACnCE,QAAWF,IAIfG,OAAOC,eAAeC,QAAS,aAAc,CAC3CC,OAAO,IAGT,IAAIC,MAAQR,gBAAgBD,QAAQ,QAEhCU,eAAiBV,QAAQ,gBAEzBW,OAASX,QAAQ,QAEjBY,eAAiBX,gBAAgBD,QAAQ,6BAEzCa,eAAiB,0BAOjBC,aAEJ,WACE,SAASA,EAAaC,EAAWC,GAC/BC,KAAKD,OAAS,CACZE,MAAO,WACPC,KAAM,OAGRF,KAAKG,cAAgB,GACrBH,KAAKI,KAAM,EACXJ,KAAKF,UAAYA,EACjBE,KAAKD,OAASX,OAAOiB,OAAOL,KAAKD,OAAQA,GACzCC,KAAKM,uBACLN,KAAKO,OACLP,KAAKQ,aAyQP,OAjQAX,EAAaY,UAAUH,qBAAuB,WAC5C,IAAII,EAAiBV,KAAKF,UAAUa,cAAc,IAAMf,gBAEpDc,GACFA,EAAeE,cAAcC,YAAYH,GAG3CV,KAAKU,eAAiBI,SAASC,cAAc,OAC7Cf,KAAKU,eAAeM,UAAYpB,eAChCI,KAAKiB,sBAAwBH,SAASC,cAAc,MACpDf,KAAKU,eAAeQ,YAAYlB,KAAKiB,uBACrCjB,KAAKF,UAAUoB,YAAYlB,KAAKU,iBAQlCb,EAAaY,UAAUF,KAAO,WAC5B,IAAIR,EAASC,KAAKD,OAClBC,KAAKU,eAAeS,UAAUC,OAAO,CAACxB,gBAAgByB,OAAO,CAAiB,QAAhBtB,EAAOG,KAAiB,SAAW,MAAOH,EAAOE,QAAQqB,KAAK,MAC5HtB,KAAKU,eAAeS,UAAUI,IAAI,CAAC3B,gBAAgByB,OAAO,CAACtB,EAAOG,KAAMH,EAAOE,QAAQqB,KAAK,OAQ9FzB,EAAaY,UAAUD,WAAa,WAClC,IAAIgB,EAAOxB,KACXA,KAAKiB,sBAAsBQ,iBAAiB,QAAS,SAAUC,GACzDA,EAAEC,OAAOR,UAAUS,SAAS,cAC1BC,EAASlC,eAAeR,QAAQ2C,UAAUJ,EAAEC,OAAQ/B,eAAiB,SACzE4B,EAAKO,kBAAkBC,KAAKR,EAAMK,EAAOI,QAAQC,QAYvDrC,EAAaY,UAAUsB,kBAAoB,SAAUG,GACnD,IAGIC,EAHAX,EAAOxB,KACPwB,EAAKpB,MACToB,EAAKpB,KAAM,EACP+B,EAAIX,EAAKrB,cAAc+B,GAW3BV,EAAKY,QAAQ,gBAAiBD,GAC9BA,EAAEV,iBAAiB,gBAVnB,SAASY,IACPF,EAAEG,oBAAoB,gBAAiBD,GACvCb,EAAKP,sBAAsBJ,YAAYsB,GACvCX,EAAKpB,KAAM,EAEXoB,EAAKY,QAAQ,eAAgBD,KAM/BA,EAAElC,MAAMsC,SAAW,SACnBJ,EAAExB,cAAc,SAASV,MAAMuC,QAAU,IACzCL,EAAElC,MAAMwC,OAAS,MAUnB5C,EAAaY,UAAUiC,YAAc,SAAU3C,GAC7C,IAAI4C,EAAQ3C,KAEZ,OAAO,IAAI4C,QAAQ,SAAUC,GAC3B,IAAIC,EAAS/C,EAAO+C,OAChBC,EAAWhD,EAAOgD,SAClBb,EAAKxC,OAAOsD,KACZb,EAAIrB,SAASC,cAAc,MAC/BoB,EAAEnB,UAAYpB,eAAiB,QAC/BuC,EAAEF,QAAQC,GAAKA,EACf,IAAIe,EAAMnC,SAASC,cAAc,OACjCoB,EAAEjB,YAAY+B,GACd,IAAIzB,EAAOmB,EACX,IAAInD,MAAML,QAAQ,CAChB+D,QAAS,WACPL,EAAQrB,EAAK2B,MAAMjB,EAAIC,KAEzBiB,OAAQ,SAAgBC,GACtB,OAAOA,EAAE5D,eAAe6D,SAAU,CAACD,EAAE,MAAO,CAC1CE,MAAS,QACR,CAAC5D,eAAeR,QAAQqE,SAAST,GAAYM,EAAEN,GAAYpD,eAAeR,QAAQsE,WAAWV,GAAYA,EAASM,GAAKN,GAAY,KAAMD,EAASO,EAAE,OAAQ,CAC7JE,MAAS,aACN,UAENG,OAAOT,MAWdpD,EAAaY,UAAUkD,cAAgB,SAAU5D,GAC/C,IAAI4C,EAAQ3C,KAEZ,OAAO,IAAI4C,QAAQ,SAAUC,GAC3B,IAAIe,EAAK7D,EAAO8D,YACZA,OAAqB,IAAPD,EAAgB,GAAKA,EACnCE,EAAK/D,EAAOgE,WACZA,OAAoB,IAAPD,EAAgB,GAAKA,EAClCE,EAAKjE,EAAOkE,MACZA,OAAe,IAAPD,EAAgB,GAAKA,EAC7BE,EAAKnE,EAAOoE,KACZA,OAAc,IAAPD,EAAgB,GAAKA,EAC5BE,EAAKrE,EAAOsE,KACZA,OAAc,IAAPD,EAAgB,GAAKA,EAC5BE,EAAKvE,EAAO+C,OACZA,OAAgB,IAAPwB,GAAuBA,EAChCC,EAAKxE,EAAOyE,SACZA,OAAkB,IAAPD,EAAgB,GAAKA,EAChCrC,EAAKxC,OAAOsD,KACZb,EAAIrB,SAASC,cAAc,MAC/BoB,EAAEnB,UAAYpB,eAAiB,QAC/BuC,EAAEF,QAAQC,GAAKA,EACXe,EAAMnC,SAASC,cAAc,OACjCoB,EAAEjB,YAAY+B,GACd,IAAIzB,EAAOmB,EACX,IAAInD,MAAML,QAAQ,CAChB+D,QAAS,WACPL,EAAQrB,EAAK2B,MAAMjB,EAAIC,KAEzBiB,OAAQ,SAAgBC,GACtB,OAAOA,EAAE5D,eAAe6D,SAAU,CAACD,EAAE,MAAO,CAC1CE,MAAS,QACR,CAACF,EAAE,MAAO,CACXE,MAAS3D,eAAiB,oBACzB,CAACyD,EAAE,MAAO,CACXE,MAAS3D,eAAiB,yBACzB,CAACmE,EAAaV,EAAE,MAAO,CACxBoB,MAAS,CACPC,IAAOX,EACPY,IAAO,MAEN,OAAQtB,EAAE,MAAO,CACpBE,MAAS3D,eAAiB,0BACzB,CAACD,eAAeR,QAAQqE,SAASK,GAAeR,EAAEQ,GAAelE,eAAeR,QAAQsE,WAAWI,GAAeA,EAAYR,GAAKQ,GAAe,OAAQR,EAAE,MAAO,CACpKE,MAAS3D,eAAiB,qBACzB,CAACyD,EAAE,MAAO,CACXE,MAAS3D,eAAiB,6BACzB,CAACyE,EAAOhB,EAAE,MAAO,CAClBoB,MAAS,CACPC,IAAOL,EACPM,IAAO,MAEN,OAAQtB,EAAE,MAAO,CACpBE,MAAS3D,eAAiB,yBACzB,CAACyD,EAAE,MAAO,CACXE,MAAS3D,eAAiB,+BACzB,CAACD,eAAeR,QAAQqE,SAASS,GAASZ,EAAEY,GAAStE,eAAeR,QAAQsE,WAAWQ,GAASA,EAAMZ,GAAKY,GAAS,KAAMZ,EAAE,MAAO,CACpIE,MAAS3D,eAAiB,8BACzB,CAACD,eAAeR,QAAQqE,SAASW,GAAQd,EAAEc,GAAQxE,eAAeR,QAAQsE,WAAWU,GAAQA,EAAKd,GAAKc,GAAQ,OAAQd,EAAE,MAAO,CACjIE,MAAS3D,eAAiB,6BACzB,CAACD,eAAeR,QAAQqE,SAASgB,GAAYnB,EAAEmB,GAAY7E,eAAeR,QAAQsE,WAAWe,GAAYA,EAASnB,GAAKmB,GAAY,SAAU1B,EAASO,EAAE,OAAQ,CACjKE,MAAS,aACN,UAENG,OAAOT,MAYdpD,EAAaY,UAAU0C,MAAQ,SAAUjB,EAAIC,GAC3C,IAAIX,EAAOxB,KACXA,KAAKG,cAAc+B,GAAMC,EACzBnC,KAAKiB,sBAAsBC,YAAYiB,GAEvCX,EAAKY,QAAQ,WAAYD,GACzBA,EAAElC,MAAMwC,OAAS,OACjB,IAAImC,EAAezC,EAAE0C,aAkBrB,MAhB0B,aAAtBrD,EAAKzB,OAAOE,MACV2E,EAAe,KACjBA,EAAe,IAEc,QAAtBpD,EAAKzB,OAAOE,OACjB2E,EAAe,KACjBA,EAAe,IAInBzC,EAAElC,MAAMwC,OAAS,IACjBqC,WAAW,WACT3C,EAAElC,MAAMwC,OAASmC,EAAe,KAChCzC,EAAExB,cAAc,SAASV,MAAMuC,QAAU,IACzChB,EAAKY,QAAQ,SAAUD,IACtB,KACID,GAUTrC,EAAaY,UAAU2B,QAAU,SAAU2C,EAAQC,GAC7ChF,KAAKD,OAAOgF,IACd/E,KAAKD,OAAOgF,GAAQC,IAUxBnF,EAAaY,UAAUwE,KAAO,SAAUlF,GACtC,OAAOC,KAAK0C,YAAY3C,IAS1BF,EAAaY,UAAUyE,aAAe,SAAUnF,GAC9C,OAAOC,KAAK2D,cAAc5D,IAQ5BF,EAAaY,UAAU0E,MAAQ,SAAUjD,GACvClC,KAAK+B,kBAAkBG,IAGlBrC,EAtRT,GA6RAP,QAAQH,QAAU,CAOhBgE,MAAO,SAAerD,EAAWC,GAC/B,OAAO,IAAIF,aAAaC,EAAWC"}