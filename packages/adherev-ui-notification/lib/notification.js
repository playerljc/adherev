"use strict";require("core-js/modules/es.object.define-property.js"),require("core-js/modules/es.object.assign.js"),require("core-js/modules/es.array.concat.js"),require("core-js/modules/es.object.to-string.js"),require("core-js/modules/es.promise.js"),Object.defineProperty(exports,"__esModule",{value:!0});var globalConfig,tslib_1=require("tslib"),uuid_1=require("uuid"),vue_1=tslib_1.__importDefault(require("vue")),vue_fragment_1=require("vue-fragment"),adherev_util_1=tslib_1.__importDefault(require("@baifendian/adherev-util")),selectorPrefix="adherev-ui-notification",Notification=function(){function t(t,e){this.config={style:"material",type:"top"},this.notifications={},this.key=!1,this.container=t,this.config=Object.assign(this.config,e),this.createInnerContainer(),this.init(),this.initEvents()}return t.prototype.createInnerContainer=function(){var t,e=this.container.querySelector(".".concat(selectorPrefix));e&&null!=(t=null==e?void 0:e.parentElement)&&t.removeChild(e),this.innerContainer=document.createElement("div"),this.innerContainer.className=selectorPrefix,this.notificationContainer=document.createElement("ul"),this.innerContainer.appendChild(this.notificationContainer),this.container.appendChild(this.innerContainer)},t.prototype.init=function(){var t,e=this.config;null!=(t=null==this?void 0:this.innerContainer)&&t.classList.remove([selectorPrefix].concat(["top"===e.type?"bottom":"top",e.style]).join("-")),null!=(t=null==this?void 0:this.innerContainer)&&t.classList.add([selectorPrefix].concat([e.type,e.style]).join("-"))},t.prototype.initEvents=function(){var t,n=this;null!=(t=null==this?void 0:this.notificationContainer)&&t.addEventListener("click",function(t){var e,i;null!=(i=null==(e=null==(e=t.target)?void 0:e.classList)?void 0:e.contains)&&i.call(e,"closeBtn")&&(i=adherev_util_1.default.getTopDom(t.target,"".concat(selectorPrefix,"-item")),n.closeNotification.call(n,i.dataset.id))})},t.prototype.closeNotification=function(t){var i,n=this;n.key||(n.key=!0,i=n.notifications[t],n.trigger("onCloseBefore",i),i.addEventListener("transitionend",function t(){var e;i.removeEventListener("transitionend",t),null!=(e=null==n?void 0:n.notificationContainer)&&e.removeChild(i),n.key=!1,n.trigger("onCloseAfter",i)}),i.style.overflow="hidden",i.querySelector(".info").style.opacity="0",i.style.height="0")},t.prototype.buildCustom=function(s){var l=this;return new Promise(function(t){var e=s.closed,i=s.children,n=(0,uuid_1.v1)(),o=document.createElement("li"),r=(o.className="".concat(selectorPrefix,"-item"),o.dataset.id=n,document.createElement("div")),a=(o.appendChild(r),l);new vue_1.default(tslib_1.__assign(tslib_1.__assign({},globalConfig||{}),{mounted:function(){t(a.build(n,o))},render:function(t){return t(vue_fragment_1.Fragment,[t("div",{class:"info"},[adherev_util_1.default.isObject(i)?t(i):adherev_util_1.default.isFunction(i)?i(t):i||""]),e?t("span",{class:"closeBtn"}):null])}})).$mount(r)})},t.prototype.buildStandard=function(f){var h=this;return new Promise(function(t){var e=f.headerLabel,i=void 0===e?"":e,e=f.headerIcon,n=void 0===e?"":e,e=f.title,o=void 0===e?"":e,e=f.text,r=void 0===e?"":e,e=f.icon,a=void 0===e?"":e,e=f.closed,s=void 0===e||e,e=f.datetime,l=void 0===e?"":e,c=(0,uuid_1.v1)(),d=document.createElement("li"),e=(d.className="".concat(selectorPrefix,"-item"),d.dataset.id=c,document.createElement("div")),u=(d.appendChild(e),h);new vue_1.default({mounted:function(){t(u.build(c,d))},render:function(t){return t(vue_fragment_1.Fragment,[t("div",{class:"info"},[t("div",{class:"".concat(selectorPrefix,"-standard-header")},[t("div",{class:"".concat(selectorPrefix,"-standard-header-icon")},[n?t("img",{attrs:{src:n,alt:""}}):null]),t("div",{class:"".concat(selectorPrefix,"-standard-header-label")},[adherev_util_1.default.isObject(i)?t(i):adherev_util_1.default.isFunction(i)?i(t):i||""])]),t("div",{class:"".concat(selectorPrefix,"-standard-content")},[t("div",{class:"".concat(selectorPrefix,"-standard-content-media-l")},[a?t("img",{attrs:{src:a,alt:""}}):null]),t("div",{class:"".concat(selectorPrefix,"-standard-content-row")},[t("div",{class:"".concat(selectorPrefix,"-standard-content-row-title")},[adherev_util_1.default.isObject(o)?t(o):adherev_util_1.default.isFunction(o)?o(t):o||""]),t("div",{class:"".concat(selectorPrefix,"-standard-content-row-text")},[adherev_util_1.default.isObject(r)?t(r):adherev_util_1.default.isFunction(r)?r(t):r||""])]),t("div",{class:"".concat(selectorPrefix,"-standard-content-media-r")},[adherev_util_1.default.isObject(l)?t(l):adherev_util_1.default.isFunction(l)?l(t):l||""])])]),s?t("span",{class:"closeBtn"}):null])}}).$mount(e)})},t.prototype.build=function(t,e){var i,n=this,o=(this.notifications[t]=e,null!=(i=null==this?void 0:this.notificationContainer)&&i.appendChild(e),n.trigger("onCreate",e),e.style.height="auto",e.clientHeight);return"material"===n.config.style?o<40&&(o=40):"ios"===n.config.style&&o<70&&(o=70),e.style.height="0",setTimeout(function(){e.style.height="".concat(o,"px"),e.querySelector(".info").style.opacity="1",n.trigger("onShow",e)},100),t},t.prototype.trigger=function(t,e){this.config[t]&&this.config[t](e)},t.prototype.show=function(t){return this.buildCustom(t)},t.prototype.showStandard=function(t){return this.buildStandard(t)},t.prototype.close=function(t){this.closeNotification(t)},t}(),NotificationFactory={build:function(t,e){return new Notification(t,e)},setConfig:function(t){globalConfig=t}};exports.default=NotificationFactory;
//# sourceMappingURL=notification.js.map
