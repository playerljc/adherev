import{createVNode as _createVNode}from"vue";import"core-js/modules/es.function.name.js";import"core-js/modules/es.array.find.js";import"core-js/modules/es.object.to-string.js";import"core-js/modules/es.array.map.js";import Util from"@baifendian/adherev-util";import classNames from"classnames";import{computed,defineComponent,onBeforeUnmount,onMounted,onUpdated,ref}from"vue";import{array,string}from"vue-types";var positionType,selectorPrefix="adherev-ui-surnames",DURATION=100,surnamesProps=(!function(e){e.top="top",e.right="right",e.bottom="bottom",e.left="left"}(positionType=positionType||{}),{position:string().def(positionType.right),indexes:array().def([]),dataSource:array().def([])});export default defineComponent({name:"adv-surnames",props:surnamesProps,slots:["index","title","content"],emits:["scroll","before-scroll"],setup:function(e,t){function l(e){e.preventDefault(),e.stopPropagation(),j(e)}function i(e){e.preventDefault();var t=e.changedTouches[0].pageY,o=e.changedTouches[0].pageX,e=e.target,n=null===(n=Util.getTopDom)||void 0===n?void 0:n.call(Util,e,"".concat(selectorPrefix,"-index-item"));V=null==n?void 0:n.dataset.name,A(o,t)}function u(){n.value.style.display="none",n.value.innerText="",n.value.style.transform="translate3d(0,0,0)"}function v(e){e.preventDefault(),L=e.pageY,E=e.pageX;var e=e.target,t=null===(t=Util.getTopDom)||void 0===t?void 0:t.call(Util,e,"".concat(selectorPrefix,"-index-item"));V=null==t?void 0:t.dataset.name,d=!0}function p(e){if(!d)return!1;D=!0,e.preventDefault();var t=e.pageY,e=e.pageX;A(e,t)}function m(){D=d=!1,n.value.style.display="none",n.value.innerText="",n.value.style.transform="translate3d(0,0,0)"}function g(e){if(D)return D=d=!1,n.value.style.display="none",n.value.innerText="",!(n.value.style.transform="translate3d(0,0,0)");e.preventDefault(),j(e)}function h(){return q()}function x(){var e;"vertical"===k()?(a.value.style.height="".concat((null===(e=r.value)||void 0===e?void 0:e.offsetHeight)+50,"px"),a.value.style.width="100%"):a.value.style.height="100%"}function y(){var e,t=null===(e=r.value)||void 0===e?void 0:e.querySelectorAll(".".concat(selectorPrefix,"-index-item"));f=[];for(var o=0;o<t.length;o++){var n=t[o],l=n.dataset.name,i=n.getBoundingClientRect();f.push({name:l,top:i.top,bottom:i.bottom,left:i.left,right:i.right,offsetTop:n.offsetTop,offsetLeft:n.offsetLeft,width:n.offsetWidth,height:n.offsetHeight})}}function T(n,e){void 0===e&&(e=100);var t=null===(t=s.value)||void 0===t?void 0:t.querySelector(".".concat(selectorPrefix,"-group-title[data-name='").concat(n,"']")),l=null===(o=s.value)||void 0===o?void 0:o.scrollTop,i=t.offsetTop,o=screen.updateInterval,r=(null===(t=a.value)||void 0===t?void 0:t.scrollHeight)/((DURATION|e)/(o||16.7)+((DURATION|e)%(o||16.7)!=0?1:0));U("before-scroll",n),window.requestAnimationFrame(function e(){var t;function o(){d=w=!1,c.style.display="none",U("scroll",n)}(null===(t=s.value)||void 0===t?void 0:t.scrollTop)<i?i<l+r?l=i:l+=r:l-r<i?l=i:l-=r,s.value.scrollTop=l,(null===(t=s.value)||void 0===t?void 0:t.scrollTop)<i?i<=l?o():window.requestAnimationFrame(e):l<=i?o():window.requestAnimationFrame(e)})}function P(e){var t;s.value.scrollTop=(null===(t=null==s?void 0:s.value)||void 0===t?void 0:t.querySelector(".".concat(selectorPrefix,"-group-title[data-name='").concat(e,"']"))).offsetTop,U("scroll",e)}function N(c,u){for(var e,t=k(),o="vertical"===t?u-L:c-E,n=f.find(function(e){return e.name===V}),l=0,i=f.length-1;l<=i&&l<=f.length-1&&i<=f.length-1;){var r,a=f[r=i+l>>1],s=void 0,d=void 0,v=void 0,v="vertical"===t?(s=(null==n?void 0:n.top)+o,null==n||n.bottom,d=a.top,a.bottom):(s=(null==n?void 0:n.left)+o,null==n||n.right,d=a.left,a.right);if(d<=s&&s<=v){e=a;break}s<d?i=r-1:l=1+r}return e||null}var o=t.slots,U=t.emit,t=t.expose,a=ref(),n=ref(),s=ref(),b=ref(),r=ref(),w=!1,d=!1,D=!1,L=-1,E=-1,V="",f=[],c=null,_=computed(function(){return classNames(selectorPrefix,"".concat(selectorPrefix,"-config-position-").concat(e.position))}),j=function(e){var t=e.target;if(e.preventDefault(),w)return!1;w=!0,c.style.display="block";e=null===(e=Util.getTopDom)||void 0===e?void 0:e.call(Util,t,"".concat(selectorPrefix,"-index-item"));T(null===(t=null==e?void 0:e.dataset)||void 0===t?void 0:t.name)},A=function(e,t){e=N(e,t);e&&(n.value.innerText=e.name,n.value.style.display="block","vertical"===k()?(t=e.offsetTop+Math.floor(e.height/2),n.value.style.transform="translate3d(0,".concat(t,"px,0)")):(t=e.offsetLeft+e.width,n.value.style.transform="translate3d(".concat(t,"px,0,0)")),P(e.name))},k=function(){return"left"===e.position||"right"===e.position?"vertical":"horizontal"},q=function(){x(),y()};return onMounted(function(){var e;null!==(e=Util.isTouch)&&void 0!==e&&e.call(Util)?(null!==(e=r.value)&&void 0!==e&&e.addEventListener("click",l),null!==(e=r.value)&&void 0!==e&&e.addEventListener("touchmove",i),null!==(e=r.value)&&void 0!==e&&e.addEventListener("touchend",u)):(null!==(e=r.value)&&void 0!==e&&e.addEventListener("mousedown",v),null!==(e=r.value)&&void 0!==e&&e.addEventListener("mousemove",p),null!==(e=r.value)&&void 0!==e&&e.addEventListener("mouseleave",m),null!==(e=r.value)&&void 0!==e&&e.addEventListener("mouseup",g),window.addEventListener("resize",h)),(e=document.createElement("div")).innerHTML="<div class='".concat(selectorPrefix,"-mask'></div>"),c=e.firstElementChild,document.body.appendChild(c),x(),y()}),onUpdated(function(){x(),y()}),onBeforeUnmount(function(){var e;c&&null!==(e=null===c||void 0===c?void 0:c.parentElement)&&void 0!==e&&e.removeChild(c)}),t({scrollToAnimation:T,scrollTo:P}),function(){return _createVNode("div",{class:_.value,ref:a},[_createVNode("div",{class:"".concat(selectorPrefix,"-highlighted"),ref:n},null),_createVNode("div",{class:"".concat(selectorPrefix,"-content"),ref:s},[e.dataSource.map(function(e){var t;return _createVNode("div",{key:e.index,class:"".concat(selectorPrefix,"-group")},[_createVNode("a",{class:"".concat(selectorPrefix,"-group-title"),"data-name":e.index},[o.title?null===(t=null==o?void 0:o.title)||void 0===t?void 0:t.call(o,e):e.index]),_createVNode("div",{class:"".concat(selectorPrefix,"-group-inner")},[o.content?null===(t=null==o?void 0:o.content)||void 0===t?void 0:t.call(o,e):null])])})]),_createVNode("div",{class:"".concat(selectorPrefix,"-index"),ref:b},[_createVNode("div",{class:"".concat(selectorPrefix,"-index-inner"),ref:r},[e.indexes.map(function(e){var t;return _createVNode("a",{key:e.index,class:"".concat(selectorPrefix,"-index-item"),"data-name":e.index},[o.index?null===(t=null==o?void 0:o.index)||void 0===t?void 0:t.call(o,e):e.index])})])])])}}});
//# sourceMappingURL=surnames.js.map
