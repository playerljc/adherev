"use strict";var positionType,_vue=require("vue"),tslib_1=(require("core-js/modules/es.object.define-property.js"),require("core-js/modules/es.array.find.js"),require("core-js/modules/es.object.to-string.js"),require("core-js/modules/es.array.map.js"),Object.defineProperty(exports,"__esModule",{value:!0}),require("tslib")),classnames_1=tslib_1.__importDefault(require("classnames")),vue_1=require("vue"),vue_types_1=require("vue-types"),adherev_util_1=tslib_1.__importDefault(require("@baifendian/adherev-util")),selectorPrefix="adherev-ui-surnames",DURATION=100,surnamesProps=(!function(e){e.top="top",e.right="right",e.bottom="bottom",e.left="left"}(positionType=positionType||{}),{position:(0,vue_types_1.string)().def(positionType.right),indexes:(0,vue_types_1.array)().def([]),dataSource:(0,vue_types_1.array)().def([])});exports.default=(0,vue_1.defineComponent)({name:"adv-surnames",props:surnamesProps,slots:["index","title","content"],emits:["scroll","before-scroll"],setup:function(e,t){function n(e){e.preventDefault(),e.stopPropagation(),V(e)}function l(e){e.preventDefault();var t=e.changedTouches[0].pageY,n=e.changedTouches[0].pageX,e=e.target,l=null==(l=adherev_util_1.default.getTopDom)?void 0:l.call(adherev_util_1.default,e,"".concat(selectorPrefix,"-index-item"));L=null==l?void 0:l.dataset.name,A(n,t)}function o(){g.value.style.display="none",g.value.innerText="",g.value.style.transform="translate3d(0,0,0)"}function r(e){e.preventDefault(),D=e.pageY,w=e.pageX;var e=e.target,t=null==(t=adherev_util_1.default.getTopDom)?void 0:t.call(adherev_util_1.default,e,"".concat(selectorPrefix,"-index-item"));L=null==t?void 0:t.dataset.name,b=!0}function a(e){if(!b)return!1;q=!0,e.preventDefault();var t=e.pageY,e=e.pageX;A(e,t)}function i(){q=b=!1,g.value.style.display="none",g.value.innerText="",g.value.style.transform="translate3d(0,0,0)"}function u(e){if(q)return q=b=!1,g.value.style.display="none",g.value.innerText="",!(g.value.style.transform="translate3d(0,0,0)");e.preventDefault(),V(e)}function s(){return C()}function c(){var e;"vertical"===k()?(h.value.style.height="".concat((null==(e=T.value)?void 0:e.offsetHeight)+50,"px"),h.value.style.width="100%"):h.value.style.height="100%"}function d(){var e,t=null==(e=T.value)?void 0:e.querySelectorAll(".".concat(selectorPrefix,"-index-item"));N=[];for(var n=0;n<t.length;n++){var l=t[n],o=l.dataset.name,r=l.getBoundingClientRect();N.push({name:o,top:r.top,bottom:r.bottom,left:r.left,right:r.right,offsetTop:l.offsetTop,offsetLeft:l.offsetLeft,width:l.offsetWidth,height:l.offsetHeight})}}function v(l,e){void 0===e&&(e=100);var t=null==(t=x.value)?void 0:t.querySelector(".".concat(selectorPrefix,"-group-title[data-name='").concat(l,"']")),o=null==(n=x.value)?void 0:n.scrollTop,r=t.offsetTop,n=screen.updateInterval,a=(null==(t=h.value)?void 0:t.scrollHeight)/((DURATION|e)/(n||16.7)+((DURATION|e)%(n||16.7)!=0?1:0));_("before-scroll",l),window.requestAnimationFrame(function e(){var t;function n(){b=P=!1,j.style.display="none",_("scroll",l)}(null==(t=x.value)?void 0:t.scrollTop)<r?r<o+a?o=r:o+=a:o-a<r?o=r:o-=a,x.value.scrollTop=o,(null==(t=x.value)?void 0:t.scrollTop)<r?r<=o?n():window.requestAnimationFrame(e):o<=r?n():window.requestAnimationFrame(e)})}function f(e){var t;x.value.scrollTop=(null==(t=null==x?void 0:x.value)?void 0:t.querySelector(".".concat(selectorPrefix,"-group-title[data-name='").concat(e,"']"))).offsetTop,_("scroll",e)}function p(e,t){for(var n,l=k(),o="vertical"===l?t-D:e-w,r=N.find(function(e){return e.name===L}),a=0,i=N.length-1;a<=i&&a<=N.length-1&&i<=N.length-1;){var u,s=N[u=i+a>>1],c=void 0,d=void 0,v=void 0,v="vertical"===l?(c=(null==r?void 0:r.top)+o,null==r||r.bottom,d=s.top,s.bottom):(c=(null==r?void 0:r.left)+o,null==r||r.right,d=s.left,s.right);if(d<=c&&c<=v){n=s;break}c<d?i=u-1:a=1+u}return n||null}var m=t.slots,_=t.emit,t=t.expose,h=(0,vue_1.ref)(),g=(0,vue_1.ref)(),x=(0,vue_1.ref)(),y=(0,vue_1.ref)(),T=(0,vue_1.ref)(),P=!1,b=!1,q=!1,D=-1,w=-1,L="",N=[],j=null,E=(0,vue_1.computed)(function(){return(0,classnames_1.default)(selectorPrefix,"".concat(selectorPrefix,"-config-position-").concat(e.position))}),V=function(e){var t=e.target;if(e.preventDefault(),P)return!1;P=!0,j.style.display="block";e=null==(e=adherev_util_1.default.getTopDom)?void 0:e.call(adherev_util_1.default,t,"".concat(selectorPrefix,"-index-item"));v(null==(t=null==e?void 0:e.dataset)?void 0:t.name)},A=function(e,t){e=p(e,t);e&&(g.value.innerText=e.name,g.value.style.display="block","vertical"===k()?(t=e.offsetTop+Math.floor(e.height/2),g.value.style.transform="translate3d(0,".concat(t,"px,0)")):(t=e.offsetLeft+e.width,g.value.style.transform="translate3d(".concat(t,"px,0,0)")),f(e.name))},k=function(){return"left"===e.position||"right"===e.position?"vertical":"horizontal"},C=function(){c(),d()};return(0,vue_1.onMounted)(function(){var e;null!=(e=adherev_util_1.default.isTouch)&&e.call(adherev_util_1.default)?(null!=(e=T.value)&&e.addEventListener("click",n),null!=(e=T.value)&&e.addEventListener("touchmove",l),null!=(e=T.value)&&e.addEventListener("touchend",o)):(null!=(e=T.value)&&e.addEventListener("mousedown",r),null!=(e=T.value)&&e.addEventListener("mousemove",a),null!=(e=T.value)&&e.addEventListener("mouseleave",i),null!=(e=T.value)&&e.addEventListener("mouseup",u),window.addEventListener("resize",s)),(e=document.createElement("div")).innerHTML="<div class='".concat(selectorPrefix,"-mask'></div>"),j=e.firstElementChild,document.body.appendChild(j),c(),d()}),(0,vue_1.onUpdated)(function(){c(),d()}),(0,vue_1.onBeforeUnmount)(function(){var e;j&&null!=(e=null==j?void 0:j.parentElement)&&e.removeChild(j)}),t({scrollToAnimation:v,scrollTo:f}),function(){return(0,_vue.createVNode)("div",{class:E.value,ref:h},[(0,_vue.createVNode)("div",{class:"".concat(selectorPrefix,"-highlighted"),ref:g},null),(0,_vue.createVNode)("div",{class:"".concat(selectorPrefix,"-content"),ref:x},[e.dataSource.map(function(e){var t;return(0,_vue.createVNode)("div",{key:e.index,class:"".concat(selectorPrefix,"-group")},[(0,_vue.createVNode)("a",{class:"".concat(selectorPrefix,"-group-title"),"data-name":e.index},[m.title?null==(t=null==m?void 0:m.title)?void 0:t.call(m,e):e.index]),(0,_vue.createVNode)("div",{class:"".concat(selectorPrefix,"-group-inner")},[m.content?null==(t=null==m?void 0:m.content)?void 0:t.call(m,e):null])])})]),(0,_vue.createVNode)("div",{class:"".concat(selectorPrefix,"-index"),ref:y},[(0,_vue.createVNode)("div",{class:"".concat(selectorPrefix,"-index-inner"),ref:T},[e.indexes.map(function(e){var t;return(0,_vue.createVNode)("a",{key:e.index,class:"".concat(selectorPrefix,"-index-item"),"data-name":e.index},[m.index?null==(t=null==m?void 0:m.index)?void 0:t.call(m,e):e.index])})])])])}}});
//# sourceMappingURL=surnames.js.map
