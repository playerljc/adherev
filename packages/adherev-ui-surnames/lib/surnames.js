"use strict";var positionType,_vue=require("vue"),tslib_1=(require("core-js/modules/es.object.define-property.js"),require("core-js/modules/es.function.name.js"),require("core-js/modules/es.array.find.js"),require("core-js/modules/es.object.to-string.js"),require("core-js/modules/es.array.map.js"),Object.defineProperty(exports,"__esModule",{value:!0}),require("tslib")),adherev_util_1=(0,tslib_1.__importDefault)(require("@baifendian/adherev-util")),classnames_1=(0,tslib_1.__importDefault)(require("classnames")),vue_1=require("vue"),vue_types_1=require("vue-types"),selectorPrefix="adherev-ui-surnames",DURATION=100,surnamesProps=(!function(e){e.top="top",e.right="right",e.bottom="bottom",e.left="left"}(positionType=positionType||{}),{position:(0,vue_types_1.string)().def(positionType.right),indexes:(0,vue_types_1.array)().def([]),dataSource:(0,vue_types_1.array)().def([])});exports.default=(0,vue_1.defineComponent)({name:"adv-surnames",props:surnamesProps,slots:["index","title","content"],emits:["scroll","before-scroll"],setup:function(e,t){function l(e){e.preventDefault(),e.stopPropagation(),V(e)}function i(e){e.preventDefault();var t=e.changedTouches[0].pageY,o=e.changedTouches[0].pageX,e=e.target,n=null===(n=adherev_util_1.default.getTopDom)||void 0===n?void 0:n.call(adherev_util_1.default,e,"".concat(selectorPrefix,"-index-item"));N=null==n?void 0:n.dataset.name,A(o,t)}function v(){n.value.style.display="none",n.value.innerText="",n.value.style.transform="translate3d(0,0,0)"}function c(e){e.preventDefault(),w=e.pageY,L=e.pageX;var e=e.target,t=null===(t=adherev_util_1.default.getTopDom)||void 0===t?void 0:t.call(adherev_util_1.default,e,"".concat(selectorPrefix,"-index-item"));N=null==t?void 0:t.dataset.name,s=!0}function p(e){if(!s)return!1;j=!0,e.preventDefault();var t=e.pageY,e=e.pageX;A(e,t)}function m(){j=s=!1,n.value.style.display="none",n.value.innerText="",n.value.style.transform="translate3d(0,0,0)"}function _(e){if(j)return j=s=!1,n.value.style.display="none",n.value.innerText="",!(n.value.style.transform="translate3d(0,0,0)");e.preventDefault(),V(e)}function h(){return C()}function g(){var e;"vertical"===k()?(a.value.style.height="".concat((null===(e=r.value)||void 0===e?void 0:e.offsetHeight)+50,"px"),a.value.style.width="100%"):a.value.style.height="100%"}function x(){var e,t=null===(e=r.value)||void 0===e?void 0:e.querySelectorAll(".".concat(selectorPrefix,"-index-item"));f=[];for(var o=0;o<t.length;o++){var n=t[o],l=n.dataset.name,i=n.getBoundingClientRect();f.push({name:l,top:i.top,bottom:i.bottom,left:i.left,right:i.right,offsetTop:n.offsetTop,offsetLeft:n.offsetLeft,width:n.offsetWidth,height:n.offsetHeight})}}function y(n,e){void 0===e&&(e=100);var t=null===(t=u.value)||void 0===t?void 0:t.querySelector(".".concat(selectorPrefix,"-group-title[data-name='").concat(n,"']")),l=null===(o=u.value)||void 0===o?void 0:o.scrollTop,i=t.offsetTop,o=screen.updateInterval,r=(null===(t=a.value)||void 0===t?void 0:t.scrollHeight)/((DURATION|e)/(o||16.7)+((DURATION|e)%(o||16.7)!=0?1:0));b("before-scroll",n),window.requestAnimationFrame(function e(){var t;function o(){s=D=!1,d.style.display="none",b("scroll",n)}(null===(t=u.value)||void 0===t?void 0:t.scrollTop)<i?i<l+r?l=i:l+=r:l-r<i?l=i:l-=r,u.value.scrollTop=l,(null===(t=u.value)||void 0===t?void 0:t.scrollTop)<i?i<=l?o():window.requestAnimationFrame(e):l<=i?o():window.requestAnimationFrame(e)})}function T(e){var t;u.value.scrollTop=(null===(t=null==u?void 0:u.value)||void 0===t?void 0:t.querySelector(".".concat(selectorPrefix,"-group-title[data-name='").concat(e,"']"))).offsetTop,b("scroll",e)}function P(d,v){for(var e,t=k(),o="vertical"===t?v-w:d-L,n=f.find(function(e){return e.name===N}),l=0,i=f.length-1;l<=i&&l<=f.length-1&&i<=f.length-1;){var r,a=f[r=i+l>>1],u=void 0,s=void 0,c=void 0,c="vertical"===t?(u=(null==n?void 0:n.top)+o,null==n||n.bottom,s=a.top,a.bottom):(u=(null==n?void 0:n.left)+o,null==n||n.right,s=a.left,a.right);if(s<=u&&u<=c){e=a;break}u<s?i=r-1:l=1+r}return e||null}var o=t.slots,b=t.emit,t=t.expose,a=(0,vue_1.ref)(),n=(0,vue_1.ref)(),u=(0,vue_1.ref)(),q=(0,vue_1.ref)(),r=(0,vue_1.ref)(),D=!1,s=!1,j=!1,w=-1,L=-1,N="",f=[],d=null,E=(0,vue_1.computed)(function(){return(0,classnames_1.default)(selectorPrefix,"".concat(selectorPrefix,"-config-position-").concat(e.position))}),V=function(e){var t=e.target;if(e.preventDefault(),D)return!1;D=!0,d.style.display="block";e=null===(e=adherev_util_1.default.getTopDom)||void 0===e?void 0:e.call(adherev_util_1.default,t,"".concat(selectorPrefix,"-index-item"));y(null===(t=null==e?void 0:e.dataset)||void 0===t?void 0:t.name)},A=function(e,t){e=P(e,t);e&&(n.value.innerText=e.name,n.value.style.display="block","vertical"===k()?(t=e.offsetTop+Math.floor(e.height/2),n.value.style.transform="translate3d(0,".concat(t,"px,0)")):(t=e.offsetLeft+e.width,n.value.style.transform="translate3d(".concat(t,"px,0,0)")),T(e.name))},k=function(){return"left"===e.position||"right"===e.position?"vertical":"horizontal"},C=function(){g(),x()};return(0,vue_1.onMounted)(function(){var e;null!==(e=adherev_util_1.default.isTouch)&&void 0!==e&&e.call(adherev_util_1.default)?(null!==(e=r.value)&&void 0!==e&&e.addEventListener("click",l),null!==(e=r.value)&&void 0!==e&&e.addEventListener("touchmove",i),null!==(e=r.value)&&void 0!==e&&e.addEventListener("touchend",v)):(null!==(e=r.value)&&void 0!==e&&e.addEventListener("mousedown",c),null!==(e=r.value)&&void 0!==e&&e.addEventListener("mousemove",p),null!==(e=r.value)&&void 0!==e&&e.addEventListener("mouseleave",m),null!==(e=r.value)&&void 0!==e&&e.addEventListener("mouseup",_),window.addEventListener("resize",h)),(e=document.createElement("div")).innerHTML="<div class='".concat(selectorPrefix,"-mask'></div>"),d=e.firstElementChild,document.body.appendChild(d),g(),x()}),(0,vue_1.onUpdated)(function(){g(),x()}),(0,vue_1.onBeforeUnmount)(function(){var e;d&&null!==(e=null===d||void 0===d?void 0:d.parentElement)&&void 0!==e&&e.removeChild(d)}),t({scrollToAnimation:y,scrollTo:T}),function(){return(0,_vue.createVNode)("div",{class:E.value,ref:a},[(0,_vue.createVNode)("div",{class:"".concat(selectorPrefix,"-highlighted"),ref:n},null),(0,_vue.createVNode)("div",{class:"".concat(selectorPrefix,"-content"),ref:u},[e.dataSource.map(function(e){var t;return(0,_vue.createVNode)("div",{key:e.index,class:"".concat(selectorPrefix,"-group")},[(0,_vue.createVNode)("a",{class:"".concat(selectorPrefix,"-group-title"),"data-name":e.index},[o.title?null===(t=null==o?void 0:o.title)||void 0===t?void 0:t.call(o,e):e.index]),(0,_vue.createVNode)("div",{class:"".concat(selectorPrefix,"-group-inner")},[o.content?null===(t=null==o?void 0:o.content)||void 0===t?void 0:t.call(o,e):null])])})]),(0,_vue.createVNode)("div",{class:"".concat(selectorPrefix,"-index"),ref:q},[(0,_vue.createVNode)("div",{class:"".concat(selectorPrefix,"-index-inner"),ref:r},[e.indexes.map(function(e){var t;return(0,_vue.createVNode)("a",{key:e.index,class:"".concat(selectorPrefix,"-index-item"),"data-name":e.index},[o.index?null===(t=null==o?void 0:o.index)||void 0===t?void 0:t.call(o,e):e.index])})])])])}}});
//# sourceMappingURL=surnames.js.map
