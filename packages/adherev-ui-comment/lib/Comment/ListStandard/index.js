"use strict";require("core-js/modules/es.object.keys.js"),require("core-js/modules/es.symbol.js"),require("core-js/modules/es.array.filter.js"),require("core-js/modules/es.object.to-string.js"),require("core-js/modules/es.object.get-own-property-descriptor.js"),require("core-js/modules/web.dom-collections.for-each.js"),require("core-js/modules/es.object.get-own-property-descriptors.js"),require("core-js/modules/es.object.define-properties.js");var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault"),_defineProperty2=_interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));function ownKeys(e,t){var a,r=Object.keys(e);return Object.getOwnPropertySymbols&&(a=Object.getOwnPropertySymbols(e),t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)),r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(a),!0).forEach(function(t){(0,_defineProperty2.default)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ownKeys(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}require("core-js/modules/es.object.define-property.js"),require("core-js/modules/es.number.constructor.js"),Object.defineProperty(exports,"__esModule",{value:!0});var tslib_1=require("tslib"),ant_design_vue_1=require("ant-design-vue"),vue_fragment_1=require("vue-fragment"),adherev_ui_conditionalrender_1=tslib_1.__importDefault(require("@baifendian/adherev-ui-conditionalrender")),adherev_ui_flexlayout_1=tslib_1.__importDefault(require("@baifendian/adherev-ui-flexlayout")),adherev_ui_scrollload_1=tslib_1.__importDefault(require("@baifendian/adherev-ui-scrollload")),List_1=tslib_1.__importDefault(require("../List")),selectorPrefix="adherev-ui-comment-list-standard",VerticalFlexLayout=adherev_ui_flexlayout_1.default.VerticalFlexLayout,ListStandard={name:"adv-comment-list-standard",slots:["renderEmpty","renderFirstLoading"],scopedSlots:["renderList"],props:{getScrollWrapContainer:{type:Function,default:function(){return null}},flexLayoutProps:{type:Object,default:function(){return{}}},listProps:{type:Object,default:function(){return{}}},limit:{type:Number,default:10},fetchData:{type:Function,default:function(){return null}},dataKeys:{type:Object,default:function(){return{current:"current",totalPage:"totalPage",list:"list",totalCount:"totalCount"}}}},data:function(){var t;return{loading:!0,data:((t={})[this.dataKeys.current]=1,t[this.dataKeys.totalPage]=0,t[this.dataKeys.list]=[],t[this.dataKeys.totalCount]=0,t),$paging:{page:1,limit:this.limit},$status:adherev_ui_scrollload_1.default.NORMAL,$callbackHandler:null}},computed:{isEmpty:function(){return 1===this.$data.$paging.page&&0===this.data[this.dataKeys.list].length}},methods:{onLoadMore:function(t){var e=this;if(this.$data.$status===adherev_ui_scrollload_1.default.EMPTY)return this.$data.$status=adherev_ui_scrollload_1.default.EMPTY,void t(adherev_ui_scrollload_1.default.EMPTY);this.$data.$callbackHandler=t,setTimeout(function(){return e.$appendData()},100)},$loadData:function(){var e=this;return this.loading=!0,this.$data.$paging={page:1,limit:this.limit},this.$fetchData(function(t){e.data=t})},$appendData:function(){var a=this;this.loading=!0,this.$data.$paging.page=this.$data.$paging.page+1;var r=this.dataKeys.list;return this.$fetchData(function(t){var e;a.data=tslib_1.__assign(tslib_1.__assign({},t),((e={})[a.dataKeys.list]=tslib_1.__spreadArrays(a.data[r],t[r]),e))})},$fetchData:function(e){var t,r=this;return null===(t=null==this?void 0:this.fetchData)||void 0===t?void 0:t.call(this,this.$data.$paging).then(function(t){return e(t),r.loading=!1,t}).catch(function(t){var e,a;return r.loading=!1,r.$data.$callbackHandler&&(r.$data.$status=adherev_ui_scrollload_1.default.ERROR,null!==(a=(e=r.$data).$callbackHandler)&&void 0!==a&&a.call(e,r.$data.$status)),t})},$renderFirstLoading:function(t){if(this.$slots.renderFirstLoading)return this.$slots.renderFirstLoading;for(var e=[],a=0;a<7;a++)e.push(t(ant_design_vue_1.Skeleton,{key:a+1,attrs:{loading:!0,avatar:!0}}));return e}},mounted:function(){this.$loadData()},watch:{data:function(t){this.$nextTick(function(){this.$data.$callbackHandler&&(this.$data.$status=this.$data.$paging.page<t[this.dataKeys.totalPage]?adherev_ui_scrollload_1.default.NORMAL:adherev_ui_scrollload_1.default.EMPTY,this.$data.$callbackHandler(this.$data.$status))})}},render:function(t){var e,a;return t(VerticalFlexLayout,{class:""+selectorPrefix,props:_objectSpread({},this.flexLayoutProps||{})},[t("div",{slot:"renderMain",class:selectorPrefix+"-auto",ref:"mainRef"},[t(List_1.default,{attrs:{getScrollWrapContainer:this.getScrollWrapContainer,isLoading:this.loading,hasMore:this.data[this.dataKeys.list].length<=this.data[this.dataKeys.totalCount]},on:{loadMore:this.onLoadMore},props:_objectSpread({},this.listProps||{})},[t("div",{slot:"renderFirstLoading"},[this.$renderFirstLoading(t)]),t(adherev_ui_conditionalrender_1.default,{attrs:{conditional:!this.isEmpty}},[null===(a=null===(e=this.$scopedSlots)||void 0===e?void 0:e.renderList)||void 0===a?void 0:a.call(e,this.data),t(vue_fragment_1.Fragment,{slot:"noMatch"},[this.$slots.renderEmpty||t(ant_design_vue_1.Empty)])])])])])}};exports.default=ListStandard;
//# sourceMappingURL=index.js.map
