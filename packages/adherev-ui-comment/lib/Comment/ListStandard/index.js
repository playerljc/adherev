"use strict";require("core-js/modules/es.object.keys.js"),require("core-js/modules/es.symbol.js"),require("core-js/modules/es.array.filter.js"),require("core-js/modules/es.object.to-string.js"),require("core-js/modules/es.object.get-own-property-descriptor.js"),require("core-js/modules/web.dom-collections.for-each.js"),require("core-js/modules/es.object.get-own-property-descriptors.js"),require("core-js/modules/es.object.define-properties.js");var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault"),_defineProperty2=_interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));function ownKeys(t,e){var a,r=Object.keys(t);return Object.getOwnPropertySymbols&&(a=Object.getOwnPropertySymbols(t),e&&(a=a.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,a)),r}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(a),!0).forEach(function(e){(0,_defineProperty2.default)(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):ownKeys(Object(a)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}require("core-js/modules/es.object.define-property.js"),require("core-js/modules/es.number.constructor.js"),Object.defineProperty(exports,"__esModule",{value:!0});var tslib_1=require("tslib"),ant_design_vue_1=require("ant-design-vue"),vue_fragment_1=require("vue-fragment"),adherev_ui_conditionalrender_1=tslib_1.__importDefault(require("@baifendian/adherev-ui-conditionalrender")),adherev_ui_flexlayout_1=tslib_1.__importDefault(require("@baifendian/adherev-ui-flexlayout")),adherev_ui_scrollload_1=tslib_1.__importDefault(require("@baifendian/adherev-ui-scrollload")),List_1=tslib_1.__importDefault(require("../List")),index_1=require("../index"),VerticalFlexLayout=adherev_ui_flexlayout_1.default.VerticalFlexLayout,ListStandard={name:index_1.selectorPrefix+"-list-standard",slots:["renderEmpty","renderFirstLoading"],scopedSlots:["renderList"],props:{getScrollWrapContainer:{type:Function,default:function(){return null}},flexLayoutProps:{type:Object,default:function(){return{}}},listProps:{type:Object,default:function(){return{}}},limit:{type:Number,default:10},fetchData:{type:Function,default:function(){return null}},dataKeys:{type:Object,default:function(){return{current:"current",totalPage:"totalPage",list:"list",totalCount:"totalCount"}}}},data:function(){var e;return{loading:!0,data:((e={})[this.dataKeys.current]=1,e[this.dataKeys.totalPage]=0,e[this.dataKeys.list]=[],e[this.dataKeys.totalCount]=0,e),$paging:{page:1,limit:this.limit},$status:adherev_ui_scrollload_1.default.NORMAL,$callbackHandler:null}},computed:{isEmpty:function(){return 1===this.$data.$paging.page&&0===this.data[this.dataKeys.list].length}},methods:{$loadMore:function(e){var t=this;if(this.$data.$status===adherev_ui_scrollload_1.default.EMPTY)return this.$data.$status=adherev_ui_scrollload_1.default.EMPTY,void e(adherev_ui_scrollload_1.default.EMPTY);this.$data.$callbackHandler=e,setTimeout(function(){return t.$appendData()},100)},$loadData:function(){var t=this;return this.loading=!0,this.$data.$paging={page:1,limit:this.limit},this.$fetchData(function(e){t.data=e})},$appendData:function(){var a=this;this.loading=!0,this.$data.$paging.page=this.$data.$paging.page+1;var r=this.dataKeys.list;return this.$fetchData(function(e){var t;a.data=tslib_1.__assign(tslib_1.__assign({},e),((t={})[a.dataKeys.list]=tslib_1.__spreadArrays(a.data[r],e[r]),t))})},$fetchData:function(t){var e,r=this;return null===(e=null==this?void 0:this.fetchData)||void 0===e?void 0:e.call(this,this.$data.$paging).then(function(e){return t(e),r.loading=!1,e}).catch(function(e){var t,a;return r.loading=!1,r.$data.$callbackHandler&&(r.$data.$status=adherev_ui_scrollload_1.default.ERROR,null!==(a=(t=r.$data).$callbackHandler)&&void 0!==a&&a.call(t,r.$data.$status)),e})}},mounted:function(){this.$loadData()},watch:{data:function(e){this.$nextTick(function(){this.$data.$callbackHandler&&(this.$data.$status=this.$data.$paging.page<e[this.dataKeys.totalPage]?adherev_ui_scrollload_1.default.NORMAL:adherev_ui_scrollload_1.default.EMPTY,this.$data.$callbackHandler(this.$data.$status))})}},render:function(){var e,t,a=this;return h(VerticalFlexLayout,{class:""+index_1.selectorPrefix,props:_objectSpread({},this.flexLayoutProps||{})},[h("div",{slot:"renderMain",class:index_1.selectorPrefix+"-auto",ref:"mainRef"},[h(List_1.default,{attrs:{getScrollWrapContainer:this.getScrollWrapContainer,isLoading:this.loading,hasMore:this.data[this.dataKeys.list].length<=this.data[this.dataKeys.totalCount],loadMore:function(){return a.$loadMore}},props:_objectSpread({},this.listProps||{})},[h(vue_fragment_1.Fragment,{slot:"renderFirstLoading"},[this.$slots.renderFirstLoading]),h(adherev_ui_conditionalrender_1.default,{attrs:{conditional:!this.isEmpty}},[null===(t=null===(e=this.$scopedSlots)||void 0===e?void 0:e.renderList)||void 0===t?void 0:t.call(e,this.data),h(vue_fragment_1.Fragment,{slot:"noMatch"},[this.$slots.renderEmpty||h(ant_design_vue_1.Empty)])])])])])}};exports.default=ListStandard;
//# sourceMappingURL=index.js.map
