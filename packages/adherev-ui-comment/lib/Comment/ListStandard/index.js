"use strict";require("core-js/modules/es.object.keys.js"),require("core-js/modules/es.symbol.js"),require("core-js/modules/es.array.filter.js"),require("core-js/modules/es.object.to-string.js"),require("core-js/modules/es.object.get-own-property-descriptor.js"),require("core-js/modules/web.dom-collections.for-each.js"),require("core-js/modules/es.object.get-own-property-descriptors.js"),require("core-js/modules/es.object.define-properties.js");var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault"),_defineProperty2=_interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));function ownKeys(e,t){var r,a=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,r)),a}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach(function(t){(0,_defineProperty2.default)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}require("core-js/modules/es.object.define-property.js"),require("core-js/modules/es.number.constructor.js"),Object.defineProperty(exports,"__esModule",{value:!0});var tslib_1=require("tslib"),ant_design_vue_1=require("ant-design-vue"),vue_fragment_1=require("vue-fragment"),adherev_ui_conditionalrender_1=tslib_1.__importDefault(require("@baifendian/adherev-ui-conditionalrender")),adherev_ui_flexlayout_1=tslib_1.__importDefault(require("@baifendian/adherev-ui-flexlayout")),adherev_ui_scrollload_1=tslib_1.__importDefault(require("@baifendian/adherev-ui-scrollload")),List_1=tslib_1.__importDefault(require("../List")),selectorPrefix="adherev-ui-comment-list-standard",VerticalFlexLayout=adherev_ui_flexlayout_1.default.VerticalFlexLayout,ListStandard={name:"adv-comment-list-standard",slots:["renderEmpty","renderFirstLoading"],scopedSlots:["renderList"],props:{getScrollWrapContainer:{type:Function,default:function(){return null}},flexLayoutProps:{type:Object,default:function(){return{}}},listProps:{type:Object,default:function(){return{}}},limit:{type:Number,default:10},fetchData:{type:Function,default:function(){return null}},dataKeys:{type:Object,default:function(){return{current:"current",totalPage:"totalPage",list:"list",totalCount:"totalCount"}}},renderEmpty:{type:Object,default:function(){return null}},renderFirstLoading:{type:Object,default:function(){return null}},renderList:{type:Function,default:function(){return null}}},computed:{isEmpty:function(){return 1===this.$data.$paging.page&&0===this.data[this.dataKeys.list].length}},watch:{data:function(t){this.$nextTick(function(){this.$data.$callbackHandler&&(this.$data.$status=this.$data.$paging.page<t[this.dataKeys.totalPage]?adherev_ui_scrollload_1.default.NORMAL:adherev_ui_scrollload_1.default.EMPTY,this.$data.$callbackHandler(this.$data.$status))})}},data:function(){var t;return{loading:!0,data:((t={})[this.dataKeys.current]=1,t[this.dataKeys.totalPage]=0,t[this.dataKeys.list]=[],t[this.dataKeys.totalCount]=0,t),$paging:{page:1,limit:this.limit},$status:adherev_ui_scrollload_1.default.NORMAL,$callbackHandler:null}},methods:{onLoadMore:function(t){var e=this;if(this.$data.$status===adherev_ui_scrollload_1.default.EMPTY)return this.$data.$status=adherev_ui_scrollload_1.default.EMPTY,void t(adherev_ui_scrollload_1.default.EMPTY);this.$data.$callbackHandler=t,setTimeout(function(){return e.$appendData()},100)},$loadData:function(){var e=this;return this.loading=!0,this.$data.$paging={page:1,limit:this.limit},this.$fetchData(function(t){e.data=t})},$appendData:function(){var r=this;this.loading=!0,this.$data.$paging.page=this.$data.$paging.page+1;var a=this.dataKeys.list;return this.$fetchData(function(t){var e;r.data=tslib_1.__assign(tslib_1.__assign({},t),((e={})[r.dataKeys.list]=tslib_1.__spreadArrays(r.data[a],t[a]),e))})},$fetchData:function(e){var t,a=this;return null===(t=null==this?void 0:this.fetchData)||void 0===t?void 0:t.call(this,this.$data.$paging).then(function(t){return e(t),a.loading=!1,t}).catch(function(t){var e,r;return a.loading=!1,a.$data.$callbackHandler&&(a.$data.$status=adherev_ui_scrollload_1.default.ERROR,null!==(r=(e=a.$data).$callbackHandler)&&void 0!==r&&r.call(e,a.$data.$status)),t})},$renderFirstLoading:function(t){if(this.$slots.renderFirstLoading)return this.$slots.renderFirstLoading;if(this.renderFirstLoading)return this.renderFirstLoading;for(var e=[],r=0;r<7;r++)e.push(t(ant_design_vue_1.Skeleton,{key:r+1,attrs:{loading:!0,avatar:!0}}));return e}},mounted:function(){this.$loadData()},render:function(t){var e,r;return t(VerticalFlexLayout,{class:""+selectorPrefix,props:_objectSpread({},this.flexLayoutProps||{})},[t("div",{slot:"renderMain",class:selectorPrefix+"-auto",ref:"mainRef"},[t(List_1.default,{attrs:{getScrollWrapContainer:this.getScrollWrapContainer,isLoading:this.loading,hasMore:this.data[this.dataKeys.list].length<=this.data[this.dataKeys.totalCount]},on:{loadMore:this.onLoadMore},props:_objectSpread({},this.listProps||{})},[t("div",{slot:"renderFirstLoading"},[this.$renderFirstLoading(t)]),t(adherev_ui_conditionalrender_1.default,{attrs:{conditional:!this.isEmpty}},[this.$scopedSlots.renderList?null===(e=null===(r=this.$scopedSlots)||void 0===r?void 0:r.renderList)||void 0===e?void 0:e.call(r,this.data):null===(r=null==this?void 0:this.renderList)||void 0===r?void 0:r.call(this,this.data),t(vue_fragment_1.Fragment,{slot:"noMatch"},[this.$slots.renderEmpty||this.renderEmpty||t(ant_design_vue_1.Empty)])])])])])}};exports.default=ListStandard;
//# sourceMappingURL=index.js.map
