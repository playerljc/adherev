{"version":3,"file":"index.js","sources":["Comment/ListStandard/index.js"],"sourcesContent":["\"use strict\";\n\nvar _vue = require(\"vue\");\nrequire(\"core-js/modules/es.object.define-property.js\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.listStandardProps = void 0;\nvar tslib_1 = require(\"tslib\");\nvar ant_design_vue_1 = require(\"ant-design-vue\");\nvar vue_1 = require(\"vue\");\nvar vue_types_1 = require(\"vue-types\");\nvar adherev_ui_conditionalrender_1 = tslib_1.__importDefault(require(\"@baifendian/adherev-ui-conditionalrender\"));\nvar adherev_ui_flexlayout_1 = tslib_1.__importDefault(require(\"@baifendian/adherev-ui-flexlayout\"));\nvar adherev_ui_scrollload_1 = tslib_1.__importDefault(require(\"@baifendian/adherev-ui-scrollload\"));\nvar List_1 = tslib_1.__importDefault(require(\"../List\"));\nvar selectorPrefix = 'adherev-ui-comment-list-standard';\nvar VerticalFlexLayout = adherev_ui_flexlayout_1.default.VerticalFlexLayout;\nexports.listStandardProps = {\n  getScrollWrapContainer: (0, vue_types_1.func)(),\n  flexLayoutProps: (0, vue_types_1.object)().def({}),\n  listProps: (0, vue_types_1.object)().def({}),\n  limit: (0, vue_types_1.number)().def(10),\n  fetchData: (0, vue_types_1.func)(),\n  dataKeys: (0, vue_types_1.object)().def({\n    current: 'current',\n    totalPage: 'totalPage',\n    list: 'list',\n    totalCount: 'totalCount'\n  }),\n  renderEmpty: (0, vue_types_1.object)(),\n  renderFirstLoading: (0, vue_types_1.object)(),\n  renderList: (0, vue_types_1.func)()\n};\nexports.default = (0, vue_1.defineComponent)({\n  name: \"adv-comment-list-standard\",\n  slots: ['renderEmpty', 'renderFirstLoading'],\n  scopedSlots: ['renderList'],\n  props: exports.listStandardProps,\n  setup: function setup(props, _a) {\n    var _b;\n    var slots = _a.slots;\n    var loading = (0, vue_1.ref)(true);\n    var data = (0, vue_1.shallowRef)((_b = {}, _b[props.dataKeys.current] = 1, _b[props.dataKeys.totalPage] = 0, _b[props.dataKeys.list] = [], _b[props.dataKeys.totalCount] = 0, _b));\n    var mainRef = (0, vue_1.ref)();\n    var paging = {\n      page: 1,\n      limit: props.limit\n    };\n    var status = adherev_ui_scrollload_1.default.NORMAL;\n    var callbackHandler = null;\n    var onLoadMore = function onLoadMore(callback) {\n      if (status === adherev_ui_scrollload_1.default.EMPTY) {\n        status = adherev_ui_scrollload_1.default.EMPTY;\n        callback(adherev_ui_scrollload_1.default.EMPTY);\n        return;\n      }\n      callbackHandler = callback;\n      setTimeout(function () {\n        return appendData();\n      }, 100);\n    };\n    var loadData = function loadData() {\n      loading.value = true;\n      paging = {\n        page: 1,\n        limit: props.limit\n      };\n      return fetchData(function (res) {\n        data.value = res;\n      });\n    };\n    var appendData = function appendData() {\n      loading.value = true;\n      paging.page = paging.page + 1;\n      return fetchData(function (res) {\n        var _a;\n        data.value = tslib_1.__assign(tslib_1.__assign({}, res), (_a = {}, _a[props.dataKeys.list] = tslib_1.__spreadArray(tslib_1.__spreadArray([], data.value[props.dataKeys.list], true), res[props.dataKeys.list], true), _a));\n      });\n    };\n    var fetchData = function fetchData(callback) {\n      var _a;\n      return (_a = props === null || props === void 0 ? void 0 : props.fetchData) === null || _a === void 0 ? void 0 : _a.call(props, paging).then(function (data) {\n        callback(data);\n        loading.value = false;\n        return data;\n      }).catch(function (error) {\n        loading.value = false;\n        if (callbackHandler) {\n          status = adherev_ui_scrollload_1.default.ERROR;\n          callbackHandler === null || callbackHandler === void 0 ? void 0 : callbackHandler(status);\n        }\n        return error;\n      });\n    };\n    var _renderFirstLoading = function renderFirstLoading() {\n      var _a;\n      if (slots.renderFirstLoading) {\n        return (_a = slots.renderFirstLoading) === null || _a === void 0 ? void 0 : _a.call(slots);\n      }\n      if (props.renderFirstLoading) {\n        return props.renderFirstLoading;\n      }\n      var result = [];\n      for (var i = 0; i < 7; i++) {\n        result.push((0, _vue.createVNode)(ant_design_vue_1.Skeleton, {\n          \"key\": i + 1,\n          \"loading\": true,\n          \"avatar\": true\n        }, null));\n      }\n      return result;\n    };\n    var isEmpty = (0, vue_1.computed)(function () {\n      return paging.page === 1 && data.value[props.dataKeys.list].length === 0;\n    });\n    (0, vue_1.watch)(function () {\n      return data.value;\n    }, function () {\n      if (callbackHandler) {\n        status = paging.page < data.value[props.dataKeys.totalPage] ? adherev_ui_scrollload_1.default.NORMAL : adherev_ui_scrollload_1.default.EMPTY;\n        callbackHandler === null || callbackHandler === void 0 ? void 0 : callbackHandler(status);\n      }\n    }, {\n      flush: 'post'\n    });\n    (0, vue_1.onMounted)(function () {\n      return loadData();\n    });\n    return function () {\n      return (0, _vue.createVNode)(VerticalFlexLayout, (0, _vue.mergeProps)({\n        \"class\": \"\".concat(selectorPrefix)\n      }, props.flexLayoutProps || {}), {\n        renderMain: function renderMain() {\n          return (0, _vue.createVNode)(\"div\", {\n            \"class\": \"\".concat(selectorPrefix, \"-auto\"),\n            \"ref\": mainRef\n          }, [(0, _vue.createVNode)(List_1.default, (0, _vue.mergeProps)({\n            \"getScrollWrapContainer\": props.getScrollWrapContainer,\n            \"isLoading\": loading.value,\n            \"hasMore\": data.value[props.dataKeys.list].length <= data.value[props.dataKeys.totalCount],\n            \"onLoadMore\": onLoadMore\n          }, props.listProps || {}), {\n            default: function _default() {\n              return (// @ts-ignore\n                (0, _vue.createVNode)(adherev_ui_conditionalrender_1.default, {\n                  \"conditional\": !isEmpty.value\n                }, {\n                  default: function _default() {\n                    var _a, _b;\n                    return slots.renderList ? (_a = slots === null || slots === void 0 ? void 0 : slots.renderList) === null || _a === void 0 ? void 0 : _a.call(slots, data.value) : (_b = props === null || props === void 0 ? void 0 : props.renderList) === null || _b === void 0 ? void 0 : _b.call(props, data.value);\n                  },\n                  noMatch: function noMatch() {\n                    var _a;\n                    return ((_a = slots.renderEmpty) === null || _a === void 0 ? void 0 : _a.call(slots)) || props.renderEmpty || (0, _vue.createVNode)(ant_design_vue_1.Empty, null, null);\n                  }\n                })\n              );\n            },\n            renderFirstLoading: function renderFirstLoading() {\n              return (0, _vue.createVNode)(\"div\", null, [_renderFirstLoading()]);\n            }\n          })]);\n        }\n      });\n    };\n  }\n});"],"names":["_vue","require","tslib_1","Object","defineProperty","exports","value","listStandardProps","ant_design_vue_1","vue_1","vue_types_1","adherev_ui_conditionalrender_1","__importDefault","adherev_ui_flexlayout_1","adherev_ui_scrollload_1","List_1","selectorPrefix","VerticalFlexLayout","default","getScrollWrapContainer","func","flexLayoutProps","object","def","listProps","limit","number","fetchData","dataKeys","current","totalPage","list","totalCount","renderEmpty","renderFirstLoading","renderList","defineComponent","name","slots","scopedSlots","props","setup","_a","onLoadMore","callback","status","EMPTY","callbackHandler","setTimeout","appendData","loading","paging","page","res","data","__assign","__spreadArray","ref","shallowRef","_b","mainRef","NORMAL","call","then","catch","error","ERROR","isEmpty","computed","length","watch","flush","onMounted","createVNode","mergeProps","class","concat","renderMain","isLoading","hasMore","conditional","noMatch","Empty","result","i","push","Skeleton","key","avatar"],"mappings":"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"}