{"version":3,"file":"index.js","sources":["Comment/ListStandard/index.js"],"sourcesContent":["\"use strict\";\n\nvar _vue = require(\"vue\");\nrequire(\"core-js/modules/es.object.define-property.js\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar tslib_1 = require(\"tslib\");\nvar ant_design_vue_1 = require(\"ant-design-vue\");\nvar vue_1 = require(\"vue\");\nvar vue_types_1 = require(\"vue-types\");\nvar adherev_ui_conditionalrender_1 = tslib_1.__importDefault(require(\"@baifendian/adherev-ui-conditionalrender\"));\nvar adherev_ui_flexlayout_1 = tslib_1.__importDefault(require(\"@baifendian/adherev-ui-flexlayout\"));\nvar adherev_ui_scrollload_1 = tslib_1.__importDefault(require(\"@baifendian/adherev-ui-scrollload\"));\nvar List_1 = tslib_1.__importDefault(require(\"../List\"));\nvar selectorPrefix = 'adherev-ui-comment-list-standard';\nvar VerticalFlexLayout = adherev_ui_flexlayout_1.default.VerticalFlexLayout;\nvar props = {\n  getScrollWrapContainer: (0, vue_types_1.func)(),\n  flexLayoutProps: (0, vue_types_1.object)().def({}),\n  listProps: (0, vue_types_1.object)().def({}),\n  limit: (0, vue_types_1.number)().def(10),\n  fetchData: (0, vue_types_1.func)(),\n  dataKeys: (0, vue_types_1.object)().def({\n    current: 'current',\n    totalPage: 'totalPage',\n    list: 'list',\n    totalCount: 'totalCount'\n  }),\n  renderEmpty: (0, vue_types_1.object)(),\n  renderFirstLoading: (0, vue_types_1.object)(),\n  renderList: (0, vue_types_1.func)()\n};\nexports.default = (0, vue_1.defineComponent)({\n  name: \"adv-comment-list-standard\",\n  slots: ['renderEmpty', 'renderFirstLoading'],\n  scopedSlots: ['renderList'],\n  props: props,\n  setup: function setup(props, _a) {\n    var _b;\n    var slots = _a.slots;\n    var loading = (0, vue_1.ref)(true);\n    var data = (0, vue_1.shallowRef)((_b = {}, _b[props.dataKeys.current] = 1, _b[props.dataKeys.totalPage] = 0, _b[props.dataKeys.list] = [], _b[props.dataKeys.totalCount] = 0, _b));\n    var mainRef = (0, vue_1.ref)();\n    var paging = {\n      page: 1,\n      limit: props.limit\n    };\n    var status = adherev_ui_scrollload_1.default.NORMAL;\n    var callbackHandler = null;\n    var onLoadMore = function onLoadMore(callback) {\n      if (status === adherev_ui_scrollload_1.default.EMPTY) {\n        status = adherev_ui_scrollload_1.default.EMPTY;\n        callback(adherev_ui_scrollload_1.default.EMPTY);\n        return;\n      }\n      callbackHandler = callback;\n      setTimeout(function () {\n        return appendData();\n      }, 100);\n    };\n    var loadData = function loadData() {\n      loading.value = true;\n      paging = {\n        page: 1,\n        limit: props.limit\n      };\n      return fetchData(function (res) {\n        data.value = res;\n      });\n    };\n    var appendData = function appendData() {\n      loading.value = true;\n      paging.page = paging.page + 1;\n      return fetchData(function (res) {\n        var _a;\n        data.value = tslib_1.__assign(tslib_1.__assign({}, res), (_a = {}, _a[props.dataKeys.list] = tslib_1.__spreadArray(tslib_1.__spreadArray([], data.value[props.dataKeys.list], true), res[props.dataKeys.list], true), _a));\n      });\n    };\n    var fetchData = function fetchData(callback) {\n      var _a;\n      return (_a = props === null || props === void 0 ? void 0 : props.fetchData) === null || _a === void 0 ? void 0 : _a.call(props, paging).then(function (data) {\n        callback(data);\n        loading.value = false;\n        return data;\n      }).catch(function (error) {\n        loading.value = false;\n        if (callbackHandler) {\n          status = adherev_ui_scrollload_1.default.ERROR;\n          callbackHandler === null || callbackHandler === void 0 ? void 0 : callbackHandler(status);\n        }\n        return error;\n      });\n    };\n    var _renderFirstLoading = function renderFirstLoading() {\n      var _a;\n      if (slots.renderFirstLoading) {\n        return (_a = slots.renderFirstLoading) === null || _a === void 0 ? void 0 : _a.call(slots);\n      }\n      if (props.renderFirstLoading) {\n        return props.renderFirstLoading;\n      }\n      var result = [];\n      for (var i = 0; i < 7; i++) {\n        result.push((0, _vue.createVNode)(ant_design_vue_1.Skeleton, {\n          \"key\": i + 1,\n          \"loading\": true,\n          \"avatar\": true\n        }, null));\n      }\n      return result;\n    };\n    var isEmpty = (0, vue_1.computed)(function () {\n      return paging.page === 1 && data.value[props.dataKeys.list].length === 0;\n    });\n    (0, vue_1.watch)(function () {\n      return data;\n    }, function (newData) {\n      return (0, vue_1.nextTick)(function () {\n        if (callbackHandler) {\n          status = paging.page < data[props.dataKeys.totalPage] ? adherev_ui_scrollload_1.default.NORMAL : adherev_ui_scrollload_1.default.EMPTY;\n          callbackHandler === null || callbackHandler === void 0 ? void 0 : callbackHandler(status);\n        }\n      });\n    });\n    (0, vue_1.onMounted)(function () {\n      return loadData();\n    });\n    return function () {\n      return (0, _vue.createVNode)(VerticalFlexLayout, (0, _vue.mergeProps)({\n        \"class\": \"\".concat(selectorPrefix)\n      }, props.flexLayoutProps || {}), {\n        renderMain: function renderMain() {\n          return (0, _vue.createVNode)(\"div\", {\n            \"class\": \"\".concat(selectorPrefix, \"-auto\"),\n            \"ref\": mainRef\n          }, [(0, _vue.createVNode)(List_1.default, (0, _vue.mergeProps)({\n            \"getScrollWrapContainer\": props.getScrollWrapContainer,\n            \"isLoading\": loading.value,\n            \"hasMore\": data.value[props.dataKeys.list].length <= data.value[props.dataKeys.totalCount],\n            \"onLoadMore\": onLoadMore\n          }, props.listProps || {}), {\n            default: function _default() {\n              return (// @ts-ignore\n                (0, _vue.createVNode)(adherev_ui_conditionalrender_1.default, {\n                  \"conditional\": !isEmpty.value\n                }, {\n                  default: function _default() {\n                    var _a, _b;\n                    return slots.renderList ? (_a = slots === null || slots === void 0 ? void 0 : slots.renderList) === null || _a === void 0 ? void 0 : _a.call(slots, data.value) : (_b = props === null || props === void 0 ? void 0 : props.renderList) === null || _b === void 0 ? void 0 : _b.call(props, data.value);\n                  },\n                  noMatch: function noMatch() {\n                    var _a;\n                    return ((_a = slots.renderEmpty) === null || _a === void 0 ? void 0 : _a.call(slots)) || props.renderEmpty || (0, _vue.createVNode)(ant_design_vue_1.Empty, null, null);\n                  }\n                })\n              );\n            },\n            renderFirstLoading: function renderFirstLoading() {\n              return (0, _vue.createVNode)(\"div\", null, [_renderFirstLoading()]);\n            }\n          })]);\n        }\n      });\n    };\n  }\n});"],"names":["_vue","require","tslib_1","Object","defineProperty","exports","value","ant_design_vue_1","vue_1","vue_types_1","adherev_ui_conditionalrender_1","__importDefault","adherev_ui_flexlayout_1","adherev_ui_scrollload_1","List_1","selectorPrefix","VerticalFlexLayout","default","props","getScrollWrapContainer","func","flexLayoutProps","object","def","listProps","limit","number","fetchData","dataKeys","current","totalPage","list","totalCount","renderEmpty","renderFirstLoading","renderList","defineComponent","name","slots","scopedSlots","setup","_a","onLoadMore","callback","status","EMPTY","callbackHandler","setTimeout","appendData","loading","paging","page","res","data","__assign","__spreadArray","ref","shallowRef","_b","mainRef","NORMAL","call","then","catch","error","ERROR","isEmpty","computed","length","watch","newData","nextTick","onMounted","createVNode","mergeProps","class","concat","renderMain","isLoading","hasMore","conditional","noMatch","Empty","result","i","push","Skeleton","key","avatar"],"mappings":"AAAA,aAEA,IAAIA,KAAOC,QAAQ,KAAK,EAKpBC,SAJJD,QAAQ,8CAA8C,EACtDE,OAAOC,eAAeC,QAAS,aAAc,CAC3CC,MAAO,CAAA,CACT,CAAC,EACaL,QAAQ,OAAO,GACzBM,iBAAmBN,QAAQ,gBAAgB,EAC3CO,MAAQP,QAAQ,KAAK,EACrBQ,YAAcR,QAAQ,WAAW,EACjCS,+BAAiCR,QAAQS,gBAAgBV,QAAQ,0CAA0C,CAAC,EAC5GW,wBAA0BV,QAAQS,gBAAgBV,QAAQ,mCAAmC,CAAC,EAC9FY,wBAA0BX,QAAQS,gBAAgBV,QAAQ,mCAAmC,CAAC,EAC9Fa,OAASZ,QAAQS,gBAAgBV,QAAQ,SAAS,CAAC,EACnDc,eAAiB,mCACjBC,mBAAqBJ,wBAAwBK,QAAQD,mBACrDE,MAAQ,CACVC,wBAAwB,EAAIV,YAAYW,MAAM,EAC9CC,iBAAiB,EAAIZ,YAAYa,QAAQ,EAAEC,IAAI,EAAE,EACjDC,WAAW,EAAIf,YAAYa,QAAQ,EAAEC,IAAI,EAAE,EAC3CE,OAAO,EAAIhB,YAAYiB,QAAQ,EAAEH,IAAI,EAAE,EACvCI,WAAW,EAAIlB,YAAYW,MAAM,EACjCQ,UAAU,EAAInB,YAAYa,QAAQ,EAAEC,IAAI,CACtCM,QAAS,UACTC,UAAW,YACXC,KAAM,OACNC,WAAY,YACd,CAAC,EACDC,aAAa,EAAIxB,YAAYa,QAAQ,EACrCY,oBAAoB,EAAIzB,YAAYa,QAAQ,EAC5Ca,YAAY,EAAI1B,YAAYW,MAAM,CACpC,EACAf,QAAQY,SAAU,EAAIT,MAAM4B,iBAAiB,CAC3CC,KAAM,4BACNC,MAAO,CAAC,cAAe,sBACvBC,YAAa,CAAC,cACdrB,MAAOA,MACPsB,MAAO,SAAetB,EAAOuB,GAYV,SAAbC,EAAiCC,GAC/BC,IAAW/B,wBAAwBI,QAAQ4B,OAC7CD,EAAS/B,wBAAwBI,QAAQ4B,MACzCF,EAAS9B,wBAAwBI,QAAQ4B,KAAK,IAGhDC,EAAkBH,EAClBI,WACSC,EACN,GAAG,EACR,CAWiB,SAAbA,IAGF,OAFAC,EAAQ3C,MAAQ,CAAA,EAChB4C,EAAOC,KAAOD,EAAOC,KAAO,EACrBxB,EAAU,SAAUyB,GACzB,IAAIX,EACJY,EAAK/C,MAAQJ,QAAQoD,SAASpD,QAAQoD,SAAS,GAAIF,CAAG,IAAIX,EAAK,IAAOvB,EAAMU,SAASG,MAAQ7B,QAAQqD,cAAcrD,QAAQqD,cAAc,GAAIF,EAAK/C,MAAMY,EAAMU,SAASG,MAAO,CAAA,CAAI,EAAGqB,EAAIlC,EAAMU,SAASG,MAAO,CAAA,CAAI,EAAGU,EAAG,CAC3N,CAAC,CACH,CAvCA,IACIH,EAAQG,EAAGH,MACXW,GAAU,EAAIzC,MAAMgD,KAAK,CAAA,CAAI,EAC7BH,GAAO,EAAI7C,MAAMiD,cAAaC,EAAK,IAAOxC,EAAMU,SAASC,SAAW,EAAG6B,EAAGxC,EAAMU,SAASE,WAAa,EAAG4B,EAAGxC,EAAMU,SAASG,MAAQ,GAAI2B,EAAGxC,EAAMU,SAASI,YAAc,EAAG0B,EAAG,EAC7KC,GAAU,EAAInD,MAAMgD,KAAK,EACzBN,EAAS,CACXC,KAAM,EACN1B,MAAOP,EAAMO,KACf,EACImB,EAAS/B,wBAAwBI,QAAQ2C,OACzCd,EAAkB,KA8BlBnB,EAAY,SAAmBgB,GACjC,IAAIF,EACJ,OAAO,OAACA,EAAKvB,MAAAA,EAAqC,KAAA,EAASA,EAAMS,WAAuC,KAAA,EAASc,EAAGoB,KAAK3C,EAAOgC,CAAM,EAAEY,KAAK,SAAUT,GAGrJ,OAFAV,EAASU,CAAI,EACbJ,EAAQ3C,MAAQ,CAAA,EACT+C,CACT,CAAC,EAAEU,MAAM,SAAUC,GAMjB,OALAf,EAAQ3C,MAAQ,CAAA,EACZwC,IACFF,EAAS/B,wBAAwBI,QAAQgD,MACzCnB,MAAAA,GAAkEA,EAAgBF,CAAM,GAEnFoB,CACT,CAAC,CACH,EAmBIE,GAAU,EAAI1D,MAAM2D,UAAU,WAChC,OAAuB,IAAhBjB,EAAOC,MAAyD,IAA3CE,EAAK/C,MAAMY,EAAMU,SAASG,MAAMqC,MAC9D,CAAC,EAcD,OAbA,EAAI5D,MAAM6D,OAAO,WACf,OAAOhB,CACT,EAAG,SAAUiB,GACX,OAAO,EAAI9D,MAAM+D,UAAU,WACrBzB,IACFF,EAASM,EAAOC,KAAOE,EAAKnC,EAAMU,SAASE,WAAajB,wBAAwBI,QAAQ2C,OAAS/C,wBAAwBI,QAAQ4B,MACjIC,MAAAA,GAAkEA,EAAgBF,CAAM,EAE5F,CAAC,CACH,CAAC,GACD,EAAIpC,MAAMgE,WAAW,WACnB,OAhEAvB,EAAQ3C,MAAQ,CAAA,EAChB4C,EAAS,CACPC,KAAM,EACN1B,MAAOP,EAAMO,KACf,EACOE,EAAU,SAAUyB,GACzBC,EAAK/C,MAAQ8C,CACf,CAAC,CA0DH,CAAC,EACM,WACL,OAAO,EAAIpD,KAAKyE,aAAazD,oBAAoB,EAAIhB,KAAK0E,YAAY,CACpEC,MAAS,GAAGC,OAAO7D,cAAc,CACnC,EAAGG,EAAMG,iBAAmB,EAAE,EAAG,CAC/BwD,WAAY,WACV,OAAO,EAAI7E,KAAKyE,aAAa,MAAO,CAClCE,MAAS,GAAGC,OAAO7D,eAAgB,OAAO,EAC1CyC,IAAOG,CACT,EAAG,EAAC,EAAI3D,KAAKyE,aAAa3D,OAAOG,SAAS,EAAIjB,KAAK0E,YAAY,CAC7DvD,uBAA0BD,EAAMC,uBAChC2D,UAAa7B,EAAQ3C,MACrByE,QAAW1B,EAAK/C,MAAMY,EAAMU,SAASG,MAAMqC,QAAUf,EAAK/C,MAAMY,EAAMU,SAASI,YAC/EU,WAAcA,CAChB,EAAGxB,EAAMM,WAAa,EAAE,EAAG,CACzBP,QAAS,WACP,OACE,EAAIjB,KAAKyE,aAAa/D,+BAA+BO,QAAS,CAC5D+D,YAAe,CAACd,EAAQ5D,KAC1B,EAAG,CACDW,QAAS,WACP,IAAQyC,EACR,OAAOpB,EAAMH,WAAa,OAACM,EAAKH,MAAAA,EAAqC,KAAA,EAASA,EAAMH,YAAwC,KAAA,EAASM,EAAGoB,KAAKvB,EAAOe,EAAK/C,KAAK,EAAI,OAACoD,EAAKxC,MAAAA,EAAqC,KAAA,EAASA,EAAMiB,YAAwC,KAAA,EAASuB,EAAGG,KAAK3C,EAAOmC,EAAK/C,KAAK,CACxS,EACA2E,QAAS,WACP,IAAIxC,EACJ,OAAQ,OAACA,EAAKH,EAAML,aAAyC,KAAA,EAASQ,EAAGoB,KAAKvB,CAAK,IAAMpB,EAAMe,cAAe,EAAIjC,KAAKyE,aAAalE,iBAAiB2E,MAAO,KAAM,IAAI,CACxK,CACF,CACF,CACF,EACAhD,mBAAoB,WAClB,OAAO,EAAIlC,KAAKyE,aAAa,MAAO,KAAM,CAjE1B,WACxB,IAAIhC,EACJ,GAAIH,EAAMJ,mBACR,OAAO,OAACO,EAAKH,EAAMJ,oBAAgD,KAAA,EAASO,EAAGoB,KAAKvB,CAAK,EAE3F,GAAIpB,EAAMgB,mBACR,OAAOhB,EAAMgB,mBAGf,IADA,IAAIiD,EAAS,GACJC,EAAI,EAAGA,EAAI,EAAGA,CAAC,GACtBD,EAAOE,MAAK,EAAIrF,KAAKyE,aAAalE,iBAAiB+E,SAAU,CAC3DC,IAAOH,EAAI,EACXnC,QAAW,CAAA,EACXuC,OAAU,CAAA,CACZ,EAAG,IAAI,CAAC,EAEV,OAAOL,CACT,EAgDyE,EAAE,CACnE,CACF,CAAC,EAAE,CACL,CACF,CAAC,CACH,CACF,CACF,CAAC"}