{"version":3,"file":"index.js","sources":["Reply/Submit/index.js"],"sourcesContent":["import { isVNode as _isVNode, mergeProps as _mergeProps, createVNode as _createVNode } from \"vue\";\nimport \"core-js/modules/es.array.iterator.js\";\nimport \"core-js/modules/es.map.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/esnext.map.delete-all.js\";\nimport \"core-js/modules/esnext.map.every.js\";\nimport \"core-js/modules/esnext.map.filter.js\";\nimport \"core-js/modules/esnext.map.find.js\";\nimport \"core-js/modules/esnext.map.find-key.js\";\nimport \"core-js/modules/esnext.map.includes.js\";\nimport \"core-js/modules/esnext.map.key-of.js\";\nimport \"core-js/modules/esnext.map.map-keys.js\";\nimport \"core-js/modules/esnext.map.map-values.js\";\nimport \"core-js/modules/esnext.map.merge.js\";\nimport \"core-js/modules/esnext.map.reduce.js\";\nimport \"core-js/modules/esnext.map.some.js\";\nimport \"core-js/modules/esnext.map.update.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.array.includes.js\";\nimport \"core-js/modules/es.string.includes.js\";\nimport \"core-js/modules/es.string.trim.js\";\nimport { Button, Input, Popover } from 'ant-design-vue';\nimport { defineComponent, nextTick, onBeforeUnmount, onMounted, ref } from 'vue';\nimport { object, string } from 'vue-types';\nimport Intl from '@baifendian/adherev-util-intl';\nimport Emoji from '../../Components/Emoji';\nimport en from '../../Components/Emoji/locales/en';\nimport zh from '../../Components/Emoji/locales/zh';\nimport EmojiIcon from './emoji';\nfunction _isSlot(s) {\n  return typeof s === 'function' || Object.prototype.toString.call(s) === '[object Object]' && !_isVNode(s);\n}\nvar TextArea = Input.TextArea;\nvar LOCAL_MAP = new Map([['en', en], ['zh', zh]]);\nvar selectorPrefix = 'adherev-ui-comment-reply';\nvar props = {\n  local: string().def('zh'),\n  emojiPickerProps: object().def({})\n};\nexport default defineComponent({\n  name: \"adv-comment-reply\",\n  emits: ['result', 'cancel'],\n  props: props,\n  setup: function setup(props, _a) {\n    var emit = _a.emit;\n    var textAreaRef = ref();\n    var emojiWrapRef = ref();\n    var value = ref('');\n    var emojiIconWrapVisible = ref(false);\n    var onEmojiSelect = function onEmojiSelect(_a) {\n      var native = _a.native;\n      // 获取textarea的dom\n      var textareaEl = textAreaRef.value.querySelector('textarea');\n      // 光标开始索引\n      var selectionStart = textareaEl.selectionStart;\n      // (0) 1 (1) 2 (2) 3 (3)\n      value.value = \"\".concat(value.value.substring(0, selectionStart)).concat(native).concat(value.value.substring(selectionStart));\n      nextTick(function () {\n        textareaEl.focus();\n        textareaEl.setSelectionRange(selectionStart + native.length, selectionStart + native.length);\n      });\n    };\n    var onDocBodyClick = function onDocBodyClick(e) {\n      var target = e.target;\n      var textareaEl = textAreaRef.value;\n      if (![textareaEl.querySelector('textarea')].includes(target)) {\n        emojiIconWrapVisible.value = false;\n      }\n    };\n    var onEmojiWrapClick = function onEmojiWrapClick(e) {\n      e.stopPropagation();\n    };\n    onMounted(function () {\n      var _a, _b;\n      document.body.addEventListener('click', onDocBodyClick);\n      (_b = (_a = emojiWrapRef.value).addEventListener) === null || _b === void 0 ? void 0 : _b.call(_a, 'click', onEmojiWrapClick);\n    });\n    onBeforeUnmount(function () {\n      var _a, _b;\n      document.body.removeEventListener('click', onDocBodyClick);\n      (_b = (_a = emojiWrapRef.value).removeEventListener) === null || _b === void 0 ? void 0 : _b.call(_a, 'click', onEmojiWrapClick);\n    });\n    return function () {\n      var _slot, _slot2;\n      return _createVNode(\"div\", {\n        \"class\": \"\".concat(selectorPrefix)\n      }, [_createVNode(\"div\", {\n        \"class\": \"\".concat(selectorPrefix, \"-textarea-wrap\"),\n        \"ref\": textAreaRef\n      }, [_createVNode(TextArea, {\n        \"class\": \"\".concat(selectorPrefix, \"-textarea\"),\n        \"placeholder\": Intl.tv('请输入回复内容'),\n        \"autoFocus\": true,\n        \"value\": value.value,\n        \"onChange\": function onChange(e) {\n          value.value = e.target.value;\n        },\n        \"maxLength\": 100\n      }, null)]), _createVNode(\"div\", {\n        \"ref\": emojiWrapRef,\n        \"class\": \"\".concat(selectorPrefix, \"-toolbar-emoji-wrap\")\n      }, null), _createVNode(\"div\", {\n        \"class\": \"\".concat(selectorPrefix, \"-toolbar\")\n      }, [_createVNode(Popover, {\n        \"placement\": \"bottomLeft\",\n        \"getPopupContainer\": function getPopupContainer() {\n          return emojiWrapRef.value;\n        },\n        \"content\": _createVNode(Emoji, _mergeProps({\n          \"set\": \"emojione\",\n          \"i18n\": LOCAL_MAP.get(props.local || 'zh'),\n          \"onSelect\": onEmojiSelect\n        }, props.emojiPickerProps || {}), null),\n        \"visible\": emojiIconWrapVisible.value\n      }, {\n        default: function _default() {\n          return [_createVNode(\"div\", {\n            \"onClick\": function onClick(e) {\n              e.stopPropagation();\n              emojiIconWrapVisible.value = !emojiIconWrapVisible.value;\n            }\n          }, [_createVNode(EmojiIcon, {\n            \"class\": \"\".concat(selectorPrefix, \"-toolbar-item-emoji\")\n          }, null)])];\n        }\n      }), _createVNode(\"div\", {\n        \"class\": \"\".concat(selectorPrefix, \"-toolbar-inner\")\n      }, [_createVNode(Button, {\n        \"type\": \"primary\",\n        \"class\": \"\".concat(selectorPrefix, \"-toolbar-item\"),\n        \"disabled\": !value,\n        \"onClick\": function onClick() {\n          return emit('result', value.value.trim());\n        }\n      }, _isSlot(_slot = Intl.tv('添加')) ? _slot : {\n        default: function _default() {\n          return [_slot];\n        }\n      }), _createVNode(Button, {\n        \"class\": \"\".concat(selectorPrefix, \"-toolbar-item\"),\n        \"onClick\": function onClick() {\n          return emit('cancel');\n        }\n      }, _isSlot(_slot2 = Intl.tv('取消')) ? _slot2 : {\n        default: function _default() {\n          return [_slot2];\n        }\n      })])])]);\n    };\n  }\n});"],"names":["_isVNode","_mergeProps","_createVNode","Button","Input","Popover","defineComponent","nextTick","onBeforeUnmount","onMounted","ref","object","string","Intl","Emoji","en","zh","EmojiIcon","_isSlot","s","Object","prototype","toString","call","TextArea","LOCAL_MAP","Map","selectorPrefix","props","local","def","emojiPickerProps","name","emits","setup","_a","onEmojiSelect","native","textareaEl","textAreaRef","value","querySelector","selectionStart","concat","substring","focus","setSelectionRange","length","onDocBodyClick","e","target","includes","emojiIconWrapVisible","onEmojiWrapClick","stopPropagation","emit","emojiWrapRef","_b","document","body","addEventListener","removeEventListener","_slot","_slot2","class","placeholder","tv","autoFocus","onChange","maxLength","placement","getPopupContainer","content","set","i18n","get","onSelect","visible","default","onClick","type","disabled","trim"],"mappings":"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"}