import _Empty from"ant-design-vue/es/empty";import _Skeleton from"ant-design-vue/es/skeleton";import{mergeProps as _mergeProps,createVNode as _createVNode}from"vue";import{__assign,__spreadArray}from"tslib";import{computed,defineComponent,onMounted,ref,shallowRef,watch}from"vue";import{func,number,object}from"vue-types";import ConditionalRender from"@baifendian/adherev-ui-conditionalrender";import FlexLayout from"@baifendian/adherev-ui-flexlayout";import ScrollLoad from"@baifendian/adherev-ui-scrollload";import CommentList from"../List";var selectorPrefix="adherev-ui-comment-list-standard",VerticalFlexLayout=FlexLayout.VerticalFlexLayout,listStandardProps={getScrollWrapContainer:func(),flexLayoutProps:object().def({}),listProps:object().def({}),limit:number().def(10),fetchData:func(),dataKeys:object().def({current:"current",totalPage:"totalPage",list:"list",totalCount:"totalCount"}),renderEmpty:object(),renderFirstLoading:object(),renderList:func()};export default defineComponent({name:"adv-comment-list-standard",slots:["renderEmpty","renderFirstLoading"],scopedSlots:["renderList"],props:listStandardProps,setup:function(a,e){function t(e){u===ScrollLoad.EMPTY?(u=ScrollLoad.EMPTY,e(ScrollLoad.EMPTY)):(s=e,setTimeout(r,100))}function r(){return n.value=!0,d.page=d.page+1,c(function(e){var t;l.value=__assign(__assign({},e),((t={})[a.dataKeys.list]=__spreadArray(__spreadArray([],l.value[a.dataKeys.list],!0),e[a.dataKeys.list],!0),t))})}var o=e.slots,n=ref(!0),l=shallowRef(((e={})[a.dataKeys.current]=1,e[a.dataKeys.totalPage]=0,e[a.dataKeys.list]=[],e[a.dataKeys.totalCount]=0,e)),i=ref(),d={page:1,limit:a.limit},u=ScrollLoad.NORMAL,s=null,c=function(t){var e;return null==(e=null==a?void 0:a.fetchData)?void 0:e.call(a,d).then(function(e){return t(e),n.value=!1,e}).catch(function(e){return n.value=!1,s&&(u=ScrollLoad.ERROR,null!=s&&s(u)),e})},f=computed(function(){return 1===d.page&&0===l.value[a.dataKeys.list].length});return watch(function(){return l.value},function(){s&&(u=d.page<l.value[a.dataKeys.totalPage]?ScrollLoad.NORMAL:ScrollLoad.EMPTY,null!=s&&s(u))},{flush:"post"}),onMounted(function(){return n.value=!0,d={page:1,limit:a.limit},c(function(e){l.value=e})}),function(){return _createVNode(VerticalFlexLayout,_mergeProps({class:"".concat(selectorPrefix)},a.flexLayoutProps||{}),{renderMain:function(){return _createVNode("div",{class:"".concat(selectorPrefix,"-auto"),ref:i},[_createVNode(CommentList,_mergeProps({getScrollWrapContainer:a.getScrollWrapContainer,isLoading:n.value,hasMore:l.value[a.dataKeys.list].length<=l.value[a.dataKeys.totalCount],onLoadMore:t},a.listProps||{}),{default:function(){return _createVNode(ConditionalRender,{conditional:!f.value},{default:function(){var e;return o.renderList?null==(e=null==o?void 0:o.renderList)?void 0:e.call(o,l.value):null==(e=null==a?void 0:a.renderList)?void 0:e.call(a,l.value)},noMatch:function(){var e;return(null==(e=o.renderEmpty)?void 0:e.call(o))||a.renderEmpty||_createVNode(_Empty,null,null)}})},renderFirstLoading:function(){return _createVNode("div",null,[function(){var e;if(o.renderFirstLoading)return null==(e=o.renderFirstLoading)?void 0:e.call(o);if(a.renderFirstLoading)return a.renderFirstLoading;for(var t=[],r=0;r<7;r++)t.push(_createVNode(_Skeleton,{key:r+1,loading:!0,avatar:!0},null));return t}()])}})])}})}}});export{listStandardProps};
//# sourceMappingURL=index.js.map
