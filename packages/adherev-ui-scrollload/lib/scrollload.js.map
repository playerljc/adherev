{"version":3,"file":"scrollload.js","sources":["scrollload.js"],"sourcesContent":["\"use strict\";\n\nrequire(\"core-js/modules/es.object.define-property.js\");\n\nrequire(\"core-js/modules/es.number.constructor.js\");\n\nrequire(\"core-js/modules/es.regexp.exec.js\");\n\nrequire(\"core-js/modules/es.string.split.js\");\n\nvar __importDefault = void 0 && (void 0).__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.NORMAL = exports.ERROR = exports.EMPTY = void 0;\n\nvar classnames_1 = __importDefault(require(\"classnames\"));\n\nvar adherev_util_intl_1 = __importDefault(require(\"@baifendian/adherev-util-intl\"));\n\nvar selectorPrefix = 'adherev-ui-scrollload';\nexports.EMPTY = 'empty';\nexports.ERROR = 'error';\nexports.NORMAL = 'normal';\nexports.default = {\n  name: 'adv-scrollload',\n  props: {\n    className: {\n      type: String,\n      default: ''\n    },\n    loadClassName: {\n      type: String,\n      default: ''\n    },\n    emptyClassName: {\n      type: String,\n      default: ''\n    },\n    errorClassName: {\n      type: String,\n      default: ''\n    },\n    distance: {\n      type: Number,\n      default: 50\n    }\n  },\n  data: function data() {\n    return {\n      $lock: false\n    };\n  },\n  mounted: function mounted() {\n    this.initEvents();\n  },\n  methods: {\n    initEvents: function initEvents() {\n      var $refs = this.$refs;\n      $refs.el.addEventListener('scroll', this.onScroll);\n      $refs.emptyEl.addEventListener('click', this.onEmptyClick);\n      $refs.errorEl.addEventListener('click', this.onErrorClick);\n    },\n    onScroll: function onScroll() {\n      var _a = this,\n          _b = _a.$refs,\n          el = _b.el,\n          loadEl = _b.loadEl,\n          errorEl = _b.errorEl,\n          emptyEl = _b.emptyEl,\n          $data = _a.$data,\n          distance = _a.distance;\n\n      var bottomHeight = el.scrollHeight - el.offsetHeight;\n      var scrollTop = el.scrollTop;\n      console.log('11111111111111', scrollTop, bottomHeight, distance, Math.abs(scrollTop - bottomHeight) <= distance);\n      /**\n       * 条件完全相等或误差值在1之间\n       */\n\n      if (Math.abs(scrollTop - bottomHeight) <= distance) {\n        if ($data.$lock) return;\n        $data.$lock = true; // 先显示loading\n\n        loadEl.style.display = 'flex';\n        /**\n         * 完成\n         * @param {string} status [empty(没有数据) | error(有错误) | normal(正常)]\n         */\n\n        this.$emit('scroll-bottom', function (status) {\n          loadEl.style.display = 'none';\n\n          if (status === exports.EMPTY) {\n            emptyEl.style.display = 'block';\n          } else if (status === exports.ERROR) {\n            errorEl.style.display = 'block';\n          }\n\n          $data.$lock = false;\n        });\n      }\n    },\n    onEmptyClick: function onEmptyClick() {\n      this.$emit('empty-click');\n    },\n    onErrorClick: function onErrorClick() {\n      this.$emit('error-click');\n    },\n    renderLoading: function renderLoading(h) {\n      var _a = this,\n          $slots = _a.$slots,\n          loadClassName = _a.loadClassName;\n\n      if ($slots.loading) {\n        return h(\"div\", {\n          \"attrs\": {\n            \"className\": classnames_1.default(selectorPrefix + \"-load\", loadClassName.split(' '))\n          },\n          \"ref\": \"loadEl\"\n        }, [$slots.loading]);\n      }\n\n      return h(\"div\", {\n        \"class\": classnames_1.default(selectorPrefix + \"-load\", 'standard', loadClassName.split(' ')),\n        \"ref\": \"loadEl\"\n      }, [adherev_util_intl_1.default.tv('数据加载中')]);\n    },\n    renderEmpty: function renderEmpty(h) {\n      var _a = this,\n          $slots = _a.$slots,\n          emptyClassName = _a.emptyClassName;\n\n      if ($slots.empty) {\n        return h(\"div\", {\n          \"class\": classnames_1.default(selectorPrefix + \"-empty\", emptyClassName.split(' ')),\n          \"ref\": \"emptyEl\"\n        }, [$slots.empty]);\n      }\n\n      return h(\"div\", {\n        \"class\": classnames_1.default(selectorPrefix + \"-empty\", emptyClassName.split(' ')),\n        \"ref\": \"emptyEl\"\n      }, [\"~\", adherev_util_intl_1.default.tv('没有更多')]);\n    },\n    renderError: function renderError(h) {\n      var _a = this,\n          $slots = _a.$slots,\n          errorClassName = _a.errorClassName;\n\n      if ($slots.error) {\n        return h(\"div\", {\n          \"class\": classnames_1.default(selectorPrefix + \"-error\", errorClassName.split(' ')),\n          \"ref\": \"errorEl\"\n        }, [$slots.error]);\n      }\n\n      return h(\"div\", {\n        \"class\": classnames_1.default(selectorPrefix + \"-error\", errorClassName.split(' ')),\n        \"ref\": \"errorEl\"\n      }, [adherev_util_intl_1.default.tv('出现错误')]);\n    },\n\n    /**\n     * hideAll\n     */\n    hideAll: function hideAll() {\n      var _a = this.$refs,\n          loadEl = _a.loadEl,\n          errorEl = _a.errorEl,\n          emptyEl = _a.emptyEl;\n      loadEl.style.display = 'none';\n      errorEl.style.display = 'none';\n      emptyEl.style.display = 'none';\n    }\n  },\n  render: function render(h) {\n    var _a = this,\n        $slots = _a.$slots,\n        className = _a.className;\n\n    return h(\"div\", {\n      \"class\": classnames_1.default(selectorPrefix, className.split(' ')),\n      \"ref\": \"el\"\n    }, [$slots.default, this.renderLoading(h), this.renderEmpty(h), this.renderError(h)]);\n  }\n};"],"names":["require","__importDefault","mod","__esModule","default","Object","defineProperty","exports","value","NORMAL","ERROR","EMPTY","classnames_1","adherev_util_intl_1","selectorPrefix","name","props","className","type","String","loadClassName","emptyClassName","errorClassName","distance","Number","data","$lock","mounted","this","initEvents","methods","$refs","el","addEventListener","onScroll","emptyEl","onEmptyClick","errorEl","onErrorClick","_a","_b","loadEl","$data","bottomHeight","scrollHeight","offsetHeight","scrollTop","console","log","Math","abs","style","display","$emit","status","renderLoading","h","$slots","loading","attrs","split","ref","class","tv","renderEmpty","empty","renderError","error","hideAll","render"],"mappings":"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"}