{"version":3,"file":"olmap.js","sources":["olmap.js"],"sourcesContent":["import { createVNode as _createVNode } from \"vue\";\nimport \"core-js/modules/es.array.index-of.js\";\nimport \"core-js/modules/es.number.constructor.js\";\nimport \"core-js/modules/es.array.fill.js\";\nimport { __assign } from \"tslib\";\nimport { Fill, Stroke, Style, Text } from 'ol/style.js';\nimport { defineComponent } from 'vue';\nimport Resource from '@baifendian/adherev-util-resource';\nimport Constent from './constent';\nimport Util from './util';\nvar selectorPrefix = 'adherev-ui-olmap';\nexport default defineComponent({\n  name: 'adv-olmap',\n  props: {\n    type: {\n      type: String,\n      default: Constent.MAP_TYPE_ADMINISTRATIVE,\n      validator: function validator(val) {\n        return [Constent.MAP_TYPE_ADMINISTRATIVE, Constent.MAP_TYPE_SATELLITE].indexOf(val) !== -1;\n      }\n    },\n    mapConfig: {\n      type: Object,\n      default: function _default() {}\n    },\n    maxZoom: {\n      type: [String, Number],\n      default: Resource.Dict.value.ResourceGisMapMaxZoom.value\n    },\n    zoom: {\n      type: [String, Number],\n      default: Resource.Dict.value.ResourceGisMapMaxZoom.value\n    },\n    fitZoom: {\n      type: [String, Number],\n      default: Resource.Dict.value.ResourceGisMapMaxZoom.value\n    },\n    minZoom: {\n      type: [String, Number],\n      default: Resource.Dict.value.ResourceGisMapMinZoom.value\n    },\n    center: {\n      type: Array,\n      default: function _default() {\n        return Resource.Dict.value.ResourceGisXinbeiquCenterPoint.value;\n      }\n    },\n    extent: {\n      type: Array,\n      default: function _default() {\n        return [];\n      } /*Resource.Dict.value.ResourceGisXinbeiquMapExtent.value*/\n    },\n\n    layers: {\n      type: Array,\n      default: function _default() {\n        return undefined;\n      }\n    }\n  },\n  data: function data() {\n    return {\n      $map: null,\n      $zoom: null,\n      $mainGeoLayer: null\n    };\n  },\n  mounted: function mounted() {\n    var _a = this,\n      mapConfig = _a.mapConfig,\n      type = _a.type,\n      maxZoom = _a.maxZoom,\n      minZoom = _a.minZoom,\n      zoom = _a.zoom,\n      layers = _a.layers,\n      center = _a.center,\n      extent = _a.extent,\n      $data = _a.$data,\n      $refs = _a.$refs;\n    $data.$map = Util.createMap(__assign({\n      config: {\n        target: $refs.ref\n      },\n      type: type,\n      maxZoom: maxZoom,\n      zoom: zoom,\n      minZoom: minZoom,\n      center: center,\n      extent: extent,\n      layers: layers\n    }, mapConfig));\n    this.$data.$zoom = $data.$map.getView().getZoom();\n  },\n  methods: {\n    /**\n     * addMainGeoJSONLayer - 添加主的geoJSON层\n     * @param geoJSONStyle\n     * @param geoJSONData\n     */\n    addMainGeoJSONLayer: function addMainGeoJSONLayer(_a) {\n      var geoJSONStyle = _a.geoJSONStyle,\n        geoJSONData = _a.geoJSONData;\n      var stroke = geoJSONStyle.stroke,\n        fill = geoJSONStyle.fill,\n        text = geoJSONStyle.text; // Dict.value['feature-style-xinbeiqu'];\n      this.$data.$mainGeoLayer = this.addGeoLayer(geoJSONData /* Dict.value.mainGeoJSONData */, function () {\n        return new Style({\n          fill: new Fill(__assign({}, fill)),\n          stroke: new Stroke(__assign({}, stroke)),\n          text: new Text(__assign(__assign({}, text), {\n            fill: new Fill({\n              color: text.color\n            }),\n            overflow: true\n          }))\n        });\n      });\n    },\n    /**\n     * 添加GeoJSONLayer\n     * @param geojsonData\n     * @param getStyleConfig\n     * @param zIndex\n     */\n    addGeoLayer: function addGeoLayer(geojsonData, getStyleConfig, zIndex) {\n      if (zIndex === void 0) {\n        zIndex = 0;\n      }\n      return Util.addGeoLayer(this.$data.$map, geojsonData, getStyleConfig, zIndex);\n    },\n    /**\n     * addWindLayer - 添加风场层\n     * @param data\n     * @param config\n     * @param zIndex\n     */\n    addWindLayer: function addWindLayer(data, config, zIndex) {\n      if (zIndex === void 0) {\n        zIndex = 0;\n      }\n      return Util.addWindLayer(this.$data.$map, data, config, zIndex);\n    },\n    /**\n     * 添加数据层\n     * @return {*|{vectorLayer, vectorSource}}\n     */\n    addDataLayer: function addDataLayer(zIndex) {\n      return Util.addVectorLayer(this.$data.$map, zIndex);\n    },\n    /**\n     * 给地图实例添加 hover监听者\n     */\n    addHoverListener: function addHoverListener(layer, hit, unHit) {\n      Util.addHoverListener(this.$data.$map, layer, hit, unHit);\n    },\n    /**\n     * 添加缩放事件\n     * @param handler\n     */\n    addZoomListener: function addZoomListener(handler) {\n      var _this = this;\n      var $data = this.$data;\n      this.$data.$map.on('moveend', function () {\n        var zoom = $data.$map.getView().getZoom();\n        if (zoom !== $data.$zoom) {\n          handler(zoom);\n        }\n        _this.$data.$zoom = zoom;\n      });\n    },\n    /**\n     * 给地图实例添加 单击监听者\n     */\n    addClickListener: function addClickListener(layer, hit, unHit) {\n      Util.addClickListener(this.$data.$map, layer, hit, unHit, this.setCursor);\n    },\n    /**\n     * 添加一个Overlay对象, 一般来说只有弹窗marker 故仅实例化一个\n     */\n    addOverlay: function addOverlay(config) {\n      var $data = this.$data;\n      return Util.addOverlay($data.$map, config);\n    },\n    /**\n     * 给Overlay对象 配置状态\n     */\n    setOverlayState: function setOverlayState(overlay, state) {\n      Util.setOverlayState(overlay, state);\n    },\n    /**\n     * 将此处鼠标点样式\n     */\n    setCursor: function setCursor(style) {\n      var $data = this.$data;\n      $data.$map.getTarget().style.cursor = style;\n    },\n    /**\n     * 清空所有层，除了底图和常州geoJSOn层\n     */\n    clear: function clear() {\n      var $data = this.$data;\n      var layers = $data.$map.getLayers();\n      for (var i = 1; i < layers.getLength(); i++) {\n        this.$data.$map.removeLayer(layers.item(i));\n      }\n    },\n    /**\n     * getMap\n     * @return {*|Map}\n     */\n    getMap: function getMap() {\n      return this.$data.$map;\n    }\n  },\n  render: function render() {\n    return _createVNode(\"div\", {\n      \"class\": selectorPrefix,\n      \"ref\": \"ref\"\n    }, null);\n  }\n});"],"names":["_createVNode","__assign","Fill","Stroke","Style","Text","defineComponent","Resource","Constent","Util","selectorPrefix","name","props","type","String","default","MAP_TYPE_ADMINISTRATIVE","validator","val","MAP_TYPE_SATELLITE","indexOf","mapConfig","Object","maxZoom","Number","Dict","value","ResourceGisMapMaxZoom","zoom","fitZoom","minZoom","ResourceGisMapMinZoom","center","Array","ResourceGisXinbeiquCenterPoint","extent","layers","data","$map","$zoom","$mainGeoLayer","mounted","_a","this","$data","$refs","createMap","config","target","ref","getView","getZoom","methods","addMainGeoJSONLayer","geoJSONStyle","geoJSONData","stroke","fill","text","addGeoLayer","color","overflow","geojsonData","getStyleConfig","zIndex","addWindLayer","addDataLayer","addVectorLayer","addHoverListener","layer","hit","unHit","addZoomListener","handler","_this","on","addClickListener","setCursor","addOverlay","setOverlayState","overlay","state","style","getTarget","cursor","clear","getLayers","i","getLength","removeLayer","item","getMap","render","class"],"mappings":"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"}