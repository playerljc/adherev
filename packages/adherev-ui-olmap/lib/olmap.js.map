{"version":3,"file":"olmap.js","sources":["olmap.js"],"sourcesContent":["\"use strict\";\n\nrequire(\"core-js/modules/es.object.define-property.js\");\nrequire(\"core-js/modules/es.array.index-of.js\");\nrequire(\"core-js/modules/es.number.constructor.js\");\nrequire(\"core-js/modules/es.array.fill.js\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar tslib_1 = require(\"tslib\");\nvar style_js_1 = require(\"ol/style.js\");\nvar adherev_util_resource_1 = tslib_1.__importDefault(require(\"@baifendian/adherev-util-resource\"));\nvar constent_1 = tslib_1.__importDefault(require(\"./constent\"));\nvar util_1 = tslib_1.__importDefault(require(\"./util\"));\nvar selectorPrefix = 'adherev-ui-olmap';\nvar OLMap = {\n  name: 'adv-olmap',\n  props: {\n    type: {\n      type: String,\n      default: constent_1.default.MAP_TYPE_ADMINISTRATIVE,\n      validator: function validator(val) {\n        return [constent_1.default.MAP_TYPE_ADMINISTRATIVE, constent_1.default.MAP_TYPE_SATELLITE].indexOf(val) !== -1;\n      }\n    },\n    mapConfig: {\n      type: Object,\n      default: function _default() {}\n    },\n    maxZoom: {\n      type: [String, Number],\n      default: adherev_util_resource_1.default.Dict.value.ResourceGisMapMaxZoom.value\n    },\n    zoom: {\n      type: [String, Number],\n      default: adherev_util_resource_1.default.Dict.value.ResourceGisMapMaxZoom.value\n    },\n    fitZoom: {\n      type: [String, Number],\n      default: adherev_util_resource_1.default.Dict.value.ResourceGisMapMaxZoom.value\n    },\n    minZoom: {\n      type: [String, Number],\n      default: adherev_util_resource_1.default.Dict.value.ResourceGisMapMinZoom.value\n    },\n    center: {\n      type: Array,\n      default: function _default() {\n        return adherev_util_resource_1.default.Dict.value.ResourceGisXinbeiquCenterPoint.value;\n      }\n    },\n    extent: {\n      type: Array,\n      default: function _default() {\n        return [];\n      } /*Resource.Dict.value.ResourceGisXinbeiquMapExtent.value*/\n    },\n\n    layers: {\n      type: Array,\n      default: function _default() {\n        return undefined;\n      }\n    }\n  },\n  data: function data() {\n    return {\n      $map: null,\n      $zoom: null,\n      $mainGeoLayer: null\n    };\n  },\n  mounted: function mounted() {\n    var _a = this,\n      mapConfig = _a.mapConfig,\n      type = _a.type,\n      maxZoom = _a.maxZoom,\n      minZoom = _a.minZoom,\n      zoom = _a.zoom,\n      layers = _a.layers,\n      center = _a.center,\n      extent = _a.extent;\n    // console.log('OLMap', this.$refs, center, zoom, extent, layers, mapConfig);\n    this.$data.$map = util_1.default.createMap(tslib_1.__assign({\n      config: {\n        target: this.$refs.ref\n      },\n      type: type,\n      maxZoom: maxZoom,\n      zoom: zoom,\n      minZoom: minZoom,\n      center: center,\n      extent: extent,\n      layers: layers\n    }, mapConfig));\n    this.$data.$zoom = this.$data.$map.getView().getZoom();\n  },\n  methods: {\n    /**\n     * addMainGeoJSONLayer - 添加主的geoJSON层\n     * @param geoJSONStyle\n     * @param geoJSONData\n     */\n    addMainGeoJSONLayer: function addMainGeoJSONLayer(_a) {\n      var geoJSONStyle = _a.geoJSONStyle,\n        geoJSONData = _a.geoJSONData;\n      var stroke = geoJSONStyle.stroke,\n        fill = geoJSONStyle.fill,\n        text = geoJSONStyle.text; // Dict.value['feature-style-xinbeiqu'];\n      this.$data.$mainGeoLayer = this.addGeoLayer(geoJSONData /* Dict.value.mainGeoJSONData */, function () {\n        return new style_js_1.Style({\n          fill: new style_js_1.Fill(tslib_1.__assign({}, fill)),\n          stroke: new style_js_1.Stroke(tslib_1.__assign({}, stroke)),\n          text: new style_js_1.Text(tslib_1.__assign(tslib_1.__assign({}, text), {\n            fill: new style_js_1.Fill({\n              color: text.color\n            }),\n            overflow: true\n          }))\n        });\n      });\n    },\n    /**\n     * 添加GeoJSONLayer\n     * @param geojsonData\n     * @param getStyleConfig\n     * @param zIndex\n     */\n    addGeoLayer: function addGeoLayer(geojsonData, getStyleConfig, zIndex) {\n      if (zIndex === void 0) {\n        zIndex = 0;\n      }\n      return util_1.default.addGeoLayer(this.$data.$map, geojsonData, getStyleConfig, zIndex);\n    },\n    /**\n     * addWindLayer - 添加风场层\n     * @param data\n     * @param config\n     * @param zIndex\n     */\n    addWindLayer: function addWindLayer(data, config, zIndex) {\n      if (zIndex === void 0) {\n        zIndex = 0;\n      }\n      return util_1.default.addWindLayer(this.$data.$map, data, config, zIndex);\n    },\n    /**\n     * 添加数据层\n     * @return {*|{vectorLayer, vectorSource}}\n     */\n    addDataLayer: function addDataLayer(zIndex) {\n      return util_1.default.addVectorLayer(this.$data.$map, zIndex);\n    },\n    /**\n     * 给地图实例添加 hover监听者\n     */\n    addHoverListener: function addHoverListener(layer, hit, unHit) {\n      util_1.default.addHoverListener(this.$data.$map, layer, hit, unHit);\n    },\n    /**\n     * 添加缩放事件\n     * @param handler\n     */\n    addZoomListener: function addZoomListener(handler) {\n      var _this = this;\n      this.$data.$map.on('moveend', function (evt) {\n        var zoom = _this.$data.$map.getView().getZoom();\n        if (zoom !== _this.$data.$zoom) {\n          handler(zoom);\n        }\n        _this.$data.$zoom = zoom;\n      });\n    },\n    /**\n     * 给地图实例添加 单击监听者\n     */\n    addClickListener: function addClickListener(layer, hit, unHit) {\n      util_1.default.addClickListener(this.$data.$map, layer, hit, unHit, this.setCursor);\n    },\n    /**\n     * 添加一个Overlay对象, 一般来说只有弹窗marker 故仅实例化一个\n     */\n    addOverlay: function addOverlay(config) {\n      return util_1.default.addOverlay(this.$data.$map, config);\n    },\n    /**\n     * 给Overlay对象 配置状态\n     */\n    setOverlayState: function setOverlayState(overlay, state) {\n      util_1.default.setOverlayState(overlay, state);\n    },\n    /**\n     * 将此处鼠标点样式\n     */\n    setCursor: function setCursor(style) {\n      this.$data.$map.getTarget().style.cursor = style;\n    },\n    /**\n     * 清空所有层，除了底图和常州geoJSOn层\n     */\n    clear: function clear() {\n      var layers = this.$data.$map.getLayers();\n      for (var i = 1; i < layers.getLength(); i++) {\n        this.$data.$map.removeLayer(layers.item(i));\n      }\n    },\n    /**\n     * getMap\n     * @return {*|Map}\n     */\n    getMap: function getMap() {\n      return this.$data.$map;\n    }\n  },\n  render: function render(h) {\n    return h(\"div\", {\n      \"class\": selectorPrefix,\n      \"ref\": \"ref\"\n    });\n  }\n};\nexports.default = OLMap;"],"names":["require","Object","defineProperty","exports","value","tslib_1","style_js_1","adherev_util_resource_1","__importDefault","constent_1","util_1","selectorPrefix","OLMap","name","props","type","String","default","MAP_TYPE_ADMINISTRATIVE","validator","val","MAP_TYPE_SATELLITE","indexOf","mapConfig","maxZoom","Number","Dict","ResourceGisMapMaxZoom","zoom","fitZoom","minZoom","ResourceGisMapMinZoom","center","Array","ResourceGisXinbeiquCenterPoint","extent","layers","data","$map","$zoom","$mainGeoLayer","mounted","_a","this","$data","createMap","__assign","config","target","$refs","ref","getView","getZoom","methods","addMainGeoJSONLayer","geoJSONStyle","geoJSONData","stroke","fill","text","addGeoLayer","Style","Fill","Stroke","Text","color","overflow","geojsonData","getStyleConfig","zIndex","addWindLayer","addDataLayer","addVectorLayer","addHoverListener","layer","hit","unHit","addZoomListener","handler","_this","on","evt","addClickListener","setCursor","addOverlay","setOverlayState","overlay","state","style","getTarget","cursor","clear","getLayers","i","getLength","removeLayer","item","getMap","render","h","class"],"mappings":"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"}