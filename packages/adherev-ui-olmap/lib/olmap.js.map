{"version":3,"file":"olmap.js","sources":["olmap.js"],"sourcesContent":["\"use strict\";\n\nrequire(\"core-js/modules/es.object.assign.js\");\n\nrequire(\"core-js/modules/es.object.define-property.js\");\n\nrequire(\"core-js/modules/es.array.index-of.js\");\n\nrequire(\"core-js/modules/es.number.constructor.js\");\n\nrequire(\"core-js/modules/es.array.fill.js\");\n\nvar __assign = void 0 && (void 0).__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __importDefault = void 0 && (void 0).__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar style_js_1 = require(\"ol/style.js\");\n\nvar adherev_util_resource_1 = __importDefault(require(\"@baifendian/adherev-util-resource\"));\n\nvar constent_1 = __importDefault(require(\"./constent\"));\n\nvar util_1 = __importDefault(require(\"./util\"));\n\nvar selectorPrefix = 'adherev-ui-olmap';\nexports.default = {\n  name: 'adv-olmap',\n  props: {\n    type: {\n      type: String,\n      default: constent_1.default.MAP_TYPE_ADMINISTRATIVE,\n      validator: function validator(val) {\n        return [constent_1.default.MAP_TYPE_ADMINISTRATIVE, constent_1.default.MAP_TYPE_SATELLITE].indexOf(val) !== -1;\n      }\n    },\n    mapConfig: {\n      type: Object,\n      default: function _default() {}\n    },\n    maxZoom: {\n      type: [String, Number],\n      default: adherev_util_resource_1.default.Dict.value.ResourceGisMapMaxZoom.value\n    },\n    zoom: {\n      type: [String, Number],\n      default: adherev_util_resource_1.default.Dict.value.ResourceGisMapMaxZoom.value\n    },\n    fitZoom: {\n      type: [String, Number],\n      default: adherev_util_resource_1.default.Dict.value.ResourceGisMapMaxZoom.value\n    },\n    minZoom: {\n      type: [String, Number],\n      default: adherev_util_resource_1.default.Dict.value.ResourceGisMapMinZoom.value\n    },\n    center: {\n      type: Array,\n      default: function _default() {\n        return adherev_util_resource_1.default.Dict.value.ResourceGisXinbeiquCenterPoint.value;\n      }\n    },\n    extent: {\n      type: Array,\n      default: function _default() {\n        return [];\n      }\n      /*Resource.Dict.value.ResourceGisXinbeiquMapExtent.value*/\n\n    },\n    layers: {\n      type: Array,\n      default: function _default() {\n        return undefined;\n      }\n    }\n  },\n  data: function data() {\n    return {\n      $map: null,\n      $zoom: null,\n      $mainGeoLayer: null\n    };\n  },\n  mounted: function mounted() {\n    var _a = this,\n        mapConfig = _a.mapConfig,\n        type = _a.type,\n        maxZoom = _a.maxZoom,\n        minZoom = _a.minZoom,\n        zoom = _a.zoom,\n        layers = _a.layers,\n        center = _a.center,\n        extent = _a.extent; // console.log('OLMap', this.$refs, center, zoom, extent, layers, mapConfig);\n\n\n    this.$data.$map = util_1.default.createMap(__assign({\n      config: {\n        target: this.$refs.ref\n      },\n      type: type,\n      maxZoom: maxZoom,\n      zoom: zoom,\n      minZoom: minZoom,\n      center: center,\n      extent: extent,\n      layers: layers\n    }, mapConfig));\n    this.$data.$zoom = this.$data.$map.getView().getZoom();\n  },\n  methods: {\n    /**\n     * addMainGeoJSONLayer - 添加主的geoJSON层\n     * @param geoJSONStyle\n     * @param geoJSONData\n     */\n    addMainGeoJSONLayer: function addMainGeoJSONLayer(_a) {\n      var geoJSONStyle = _a.geoJSONStyle,\n          geoJSONData = _a.geoJSONData;\n      var stroke = geoJSONStyle.stroke,\n          fill = geoJSONStyle.fill,\n          text = geoJSONStyle.text; // Dict.value['feature-style-xinbeiqu'];\n\n      this.$data.$mainGeoLayer = this.addGeoLayer(geoJSONData\n      /* Dict.value.mainGeoJSONData */\n      , function () {\n        return new style_js_1.Style({\n          fill: new style_js_1.Fill(__assign({}, fill)),\n          stroke: new style_js_1.Stroke(__assign({}, stroke)),\n          text: new style_js_1.Text(__assign(__assign({}, text), {\n            fill: new style_js_1.Fill({\n              color: text.color\n            }),\n            overflow: true\n          }))\n        });\n      });\n    },\n\n    /**\n     * 添加GeoJSONLayer\n     * @param geojsonData\n     * @param getStyleConfig\n     * @param zIndex\n     */\n    addGeoLayer: function addGeoLayer(geojsonData, getStyleConfig, zIndex) {\n      if (zIndex === void 0) {\n        zIndex = 0;\n      }\n\n      return util_1.default.addGeoLayer(this.$data.$map, geojsonData, getStyleConfig, zIndex);\n    },\n\n    /**\n     * addWindLayer - 添加风场层\n     * @param data\n     * @param config\n     * @param zIndex\n     */\n    addWindLayer: function addWindLayer(data, config, zIndex) {\n      if (zIndex === void 0) {\n        zIndex = 0;\n      }\n\n      return util_1.default.addWindLayer(this.$data.$map, data, config, zIndex);\n    },\n\n    /**\n     * 添加数据层\n     * @return {*|{vectorLayer, vectorSource}}\n     */\n    addDataLayer: function addDataLayer(zIndex) {\n      return util_1.default.addVectorLayer(this.$data.$map, zIndex);\n    },\n\n    /**\n     * 给地图实例添加 hover监听者\n     */\n    addHoverListener: function addHoverListener(layer, hit, unHit) {\n      util_1.default.addHoverListener(this.$data.$map, layer, hit, unHit);\n    },\n\n    /**\n     * 添加缩放事件\n     * @param handler\n     */\n    addZoomListener: function addZoomListener(handler) {\n      var _this = this;\n\n      this.$data.$map.on('moveend', function (evt) {\n        var zoom = _this.$data.$map.getView().getZoom();\n\n        if (zoom !== _this.$data.$zoom) {\n          handler(zoom);\n        }\n\n        _this.$data.$zoom = zoom;\n      });\n    },\n\n    /**\n     * 给地图实例添加 单击监听者\n     */\n    addClickListener: function addClickListener(layer, hit, unHit) {\n      util_1.default.addClickListener(this.$data.$map, layer, hit, unHit, this.setCursor);\n    },\n\n    /**\n     * 添加一个Overlay对象, 一般来说只有弹窗marker 故仅实例化一个\n     */\n    addOverlay: function addOverlay(config) {\n      return util_1.default.addOverlay(this.$data.$map, config);\n    },\n\n    /**\n     * 给Overlay对象 配置状态\n     */\n    setOverlayState: function setOverlayState(overlay, state) {\n      util_1.default.setOverlayState(overlay, state);\n    },\n\n    /**\n     * 将此处鼠标点样式\n     */\n    setCursor: function setCursor(style) {\n      this.$data.$map.getTarget().style.cursor = style;\n    },\n\n    /**\n     * 清空所有层，除了底图和常州geoJSOn层\n     */\n    clear: function clear() {\n      var layers = this.$data.$map.getLayers();\n\n      for (var i = 1; i < layers.getLength(); i++) {\n        this.$data.$map.removeLayer(layers.item(i));\n      }\n    },\n\n    /**\n     * getMap\n     * @return {*|Map}\n     */\n    getMap: function getMap() {\n      return this.$data.$map;\n    }\n  },\n  render: function render(h) {\n    return h(\"div\", {\n      \"class\": selectorPrefix,\n      \"ref\": \"ref\"\n    });\n  }\n};"],"names":["require","__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","this","__importDefault","mod","__esModule","default","defineProperty","exports","value","style_js_1","adherev_util_resource_1","constent_1","util_1","selectorPrefix","name","props","type","String","MAP_TYPE_ADMINISTRATIVE","validator","val","MAP_TYPE_SATELLITE","indexOf","mapConfig","maxZoom","Number","Dict","ResourceGisMapMaxZoom","zoom","fitZoom","minZoom","ResourceGisMapMinZoom","center","Array","ResourceGisXinbeiquCenterPoint","extent","layers","data","$map","$zoom","$mainGeoLayer","mounted","_a","$data","createMap","config","target","$refs","ref","getView","getZoom","methods","addMainGeoJSONLayer","geoJSONStyle","geoJSONData","stroke","fill","text","addGeoLayer","Style","Fill","Stroke","Text","color","overflow","geojsonData","getStyleConfig","zIndex","addWindLayer","addDataLayer","addVectorLayer","addHoverListener","layer","hit","unHit","addZoomListener","handler","_this","on","evt","addClickListener","setCursor","addOverlay","setOverlayState","overlay","state","style","getTarget","cursor","clear","getLayers","getLength","removeLayer","item","getMap","render","h","class"],"mappings":"aAEAA,QAAQ,uCAERA,QAAQ,gDAERA,QAAQ,wCAERA,QAAQ,4CAERA,QAAQ,oCAER,IAAIC,SAA0C,WAa5C,OAZAA,SAAWC,OAAOC,QAAU,SAAUC,GACpC,IAAK,IAAIC,EAAGC,EAAI,EAAGC,EAAIC,UAAUC,OAAQH,EAAIC,EAAGD,IAG9C,IAAK,IAAII,KAFTL,EAAIG,UAAUF,GAGRJ,OAAOS,UAAUC,eAAeC,KAAKR,EAAGK,KAAIN,EAAEM,GAAKL,EAAEK,IAI7D,OAAON,IAGOU,MAAMC,KAAMP,YAG1BQ,gBAAwD,SAAUC,GACpE,OAAOA,GAAOA,EAAIC,WAAaD,EAAM,CACnCE,QAAWF,IAIff,OAAOkB,eAAeC,QAAS,aAAc,CAC3CC,OAAO,IAGT,IAAIC,WAAavB,QAAQ,eAErBwB,wBAA0BR,gBAAgBhB,QAAQ,sCAElDyB,WAAaT,gBAAgBhB,QAAQ,eAErC0B,OAASV,gBAAgBhB,QAAQ,WAEjC2B,eAAiB,mBACrBN,QAAQF,QAAU,CAChBS,KAAM,YACNC,MAAO,CACLC,KAAM,CACJA,KAAMC,OACNZ,QAASM,WAAWN,QAAQa,wBAC5BC,UAAW,SAAmBC,GAC5B,OAA6G,IAAtG,CAACT,WAAWN,QAAQa,wBAAyBP,WAAWN,QAAQgB,oBAAoBC,QAAQF,KAGvGG,UAAW,CACTP,KAAM5B,OACNiB,QAAS,cAEXmB,QAAS,CACPR,KAAM,CAACC,OAAQQ,QACfpB,QAASK,wBAAwBL,QAAQqB,KAAKlB,MAAMmB,sBAAsBnB,OAE5EoB,KAAM,CACJZ,KAAM,CAACC,OAAQQ,QACfpB,QAASK,wBAAwBL,QAAQqB,KAAKlB,MAAMmB,sBAAsBnB,OAE5EqB,QAAS,CACPb,KAAM,CAACC,OAAQQ,QACfpB,QAASK,wBAAwBL,QAAQqB,KAAKlB,MAAMmB,sBAAsBnB,OAE5EsB,QAAS,CACPd,KAAM,CAACC,OAAQQ,QACfpB,QAASK,wBAAwBL,QAAQqB,KAAKlB,MAAMuB,sBAAsBvB,OAE5EwB,OAAQ,CACNhB,KAAMiB,MACN5B,QAAS,WACP,OAAOK,wBAAwBL,QAAQqB,KAAKlB,MAAM0B,+BAA+B1B,QAGrF2B,OAAQ,CACNnB,KAAMiB,MACN5B,QAAS,WACP,MAAO,KAKX+B,OAAQ,CACNpB,KAAMiB,MACN5B,QAAS,eAKbgC,KAAM,WACJ,MAAO,CACLC,KAAM,KACNC,MAAO,KACPC,cAAe,OAGnBC,QAAS,WACP,IAAIC,EAAKzC,KACLsB,EAAYmB,EAAGnB,UACfP,EAAO0B,EAAG1B,KACVQ,EAAUkB,EAAGlB,QACbM,EAAUY,EAAGZ,QACbF,EAAOc,EAAGd,KACVQ,EAASM,EAAGN,OACZJ,EAASU,EAAGV,OACZG,EAASO,EAAGP,OAGhBlC,KAAK0C,MAAML,KAAO1B,OAAOP,QAAQuC,UAAUzD,SAAS,CAClD0D,OAAQ,CACNC,OAAQ7C,KAAK8C,MAAMC,KAErBhC,KAAMA,EACNQ,QAASA,EACTI,KAAMA,EACNE,QAASA,EACTE,OAAQA,EACRG,OAAQA,EACRC,OAAQA,GACPb,IACHtB,KAAK0C,MAAMJ,MAAQtC,KAAK0C,MAAML,KAAKW,UAAUC,WAE/CC,QAAS,CAMPC,oBAAqB,SAA6BV,GAChD,IAAIW,EAAeX,EAAGW,aAClBC,EAAcZ,EAAGY,YACjBC,EAASF,EAAaE,OACtBC,EAAOH,EAAaG,KACpBC,EAAOJ,EAAaI,KAExBxD,KAAK0C,MAAMH,cAAgBvC,KAAKyD,YAAYJ,EAE1C,WACA,OAAO,IAAI7C,WAAWkD,MAAM,CAC1BH,KAAM,IAAI/C,WAAWmD,KAAKzE,SAAS,GAAIqE,IACvCD,OAAQ,IAAI9C,WAAWoD,OAAO1E,SAAS,GAAIoE,IAC3CE,KAAM,IAAIhD,WAAWqD,KAAK3E,SAASA,SAAS,GAAIsE,GAAO,CACrDD,KAAM,IAAI/C,WAAWmD,KAAK,CACxBG,MAAON,EAAKM,QAEdC,UAAU,UAYlBN,YAAa,SAAqBO,EAAaC,EAAgBC,GAK7D,OAAOvD,OAAOP,QAAQqD,YAAYzD,KAAK0C,MAAML,KAAM2B,EAAaC,EAH9DC,OADa,IAAXA,EACO,EAGqEA,IASlFC,aAAc,SAAsB/B,EAAMQ,EAAQsB,GAKhD,OAAOvD,OAAOP,QAAQ+D,aAAanE,KAAK0C,MAAML,KAAMD,EAAMQ,EAHxDsB,OADa,IAAXA,EACO,EAGuDA,IAOpEE,aAAc,SAAsBF,GAClC,OAAOvD,OAAOP,QAAQiE,eAAerE,KAAK0C,MAAML,KAAM6B,IAMxDI,iBAAkB,SAA0BC,EAAOC,EAAKC,GACtD9D,OAAOP,QAAQkE,iBAAiBtE,KAAK0C,MAAML,KAAMkC,EAAOC,EAAKC,IAO/DC,gBAAiB,SAAyBC,GACxC,IAAIC,EAAQ5E,KAEZA,KAAK0C,MAAML,KAAKwC,GAAG,UAAW,SAAUC,GACtC,IAAInD,EAAOiD,EAAMlC,MAAML,KAAKW,UAAUC,UAElCtB,IAASiD,EAAMlC,MAAMJ,OACvBqC,EAAQhD,GAGViD,EAAMlC,MAAMJ,MAAQX,KAOxBoD,iBAAkB,SAA0BR,EAAOC,EAAKC,GACtD9D,OAAOP,QAAQ2E,iBAAiB/E,KAAK0C,MAAML,KAAMkC,EAAOC,EAAKC,EAAOzE,KAAKgF,YAM3EC,WAAY,SAAoBrC,GAC9B,OAAOjC,OAAOP,QAAQ6E,WAAWjF,KAAK0C,MAAML,KAAMO,IAMpDsC,gBAAiB,SAAyBC,EAASC,GACjDzE,OAAOP,QAAQ8E,gBAAgBC,EAASC,IAM1CJ,UAAW,SAAmBK,GAC5BrF,KAAK0C,MAAML,KAAKiD,YAAYD,MAAME,OAASF,GAM7CG,MAAO,WAGL,IAFA,IAAIrD,EAASnC,KAAK0C,MAAML,KAAKoD,YAEpBlG,EAAI,EAAGA,EAAI4C,EAAOuD,YAAanG,IACtCS,KAAK0C,MAAML,KAAKsD,YAAYxD,EAAOyD,KAAKrG,KAQ5CsG,OAAQ,WACN,OAAO7F,KAAK0C,MAAML,OAGtByD,OAAQ,SAAgBC,GACtB,OAAOA,EAAE,MAAO,CACdC,MAASpF,eACTmC,IAAO"}