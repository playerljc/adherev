"use strict";var _vue=require("vue"),tslib_1=(require("core-js/modules/es.object.define-property.js"),require("core-js/modules/es.object.to-string.js"),require("core-js/modules/es.promise.js"),require("core-js/modules/es.array.index-of.js"),Object.defineProperty(exports,"__esModule",{value:!0}),require("tslib")),adherev_ui_conditionalrender_1=(0,tslib_1.__importDefault)(require("@baifendian/adherev-ui-conditionalrender")),vue_1=require("vue"),vue_types_1=require("vue-types"),selectorPrefix="adhere-ui-bmap",loadGridIcon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAUdJREFUeNrs2sENwyAQRcE4ckf0RBv04Z7ck30wFXBi/4wU5bScXhQk9hhj9B+xzu/7WjijvZ/b/Jbz/e83kE0AAkAACAABIAAEgAAQAAJAAAgAAVDYfA5ui+eY33R+BuA9PXO++QtwB0AACAABIAAEgAAQAAJAAAgAASAAqrIPED5vH8A+AO4ACAABIAAEgAAQAAJAAAgAASAABEBJ9gHC5+0D2AfAHQABIAAEgAAQAAJAAAgAASAABIAAKMk+QPi8fQD7ALgDIAAEgAAQAAJAAAgAASAABIAAEAAl2QcIn7cPYB8AdwAEgAAQAAJAAAgAASAABIAAEAACoCT7AOHz9gHsA+AOgAAQAAJAAAgAASAABIAAEAACQACUZB8gfN4+gH0A3AEQAAJAAAgAASAABIAAEAACQABUNV8D++I5nmM3nX8EGADa0U/2xPbBVwAAAABJRU5ErkJggg==",props={ak:(0,vue_types_1.string)().def("bxFuXXDt1oKdlgu6mXCCnK51cDgDGBLp"),zoom:(0,vue_types_1.number)().def(5),center:(0,vue_types_1.object)().def(function(){return{lon:116.404,lat:39.915}}).isRequired,config:(0,vue_types_1.object)().def(function(){return{minZoom:2,maxZoom:20,enableHighResolution:!0,enableAutoResize:!0,enableMapClick:!1}}),externalImportBMapScript:(0,vue_types_1.bool)().def(!1)};exports.default=(0,vue_1.defineComponent)({name:"adv-bmap",props:props,emits:["onBMapInitReady","onBMapScriptReady"],setup:function(n,e){var A,t,o=e.emit,e=e.expose,i=(0,vue_1.ref)(null),r=!1,u=!1,a=((0,vue_1.onMounted)(function(){n.externalImportBMapScript?(A=window.BMap,r=!0,(0,vue_1.nextTick)(function(){c()})):a().then(function(e){window.BMap=e,o("onBMapScriptReady"),r=!0,(0,vue_1.nextTick)(function(){c()})})}),function(){return new Promise(function(o){var e,i=document.write,A=(document.write=function(e){var A,t,n=document.createElement("div"),n=(n.innerHTML=e,n.firstElementChild);"script"===(null==n?void 0:n.tagName.toLowerCase())&&-1!==(null===(A=null==n?void 0:n.getAttribute("src"))||void 0===A?void 0:A.indexOf("http://api.map.baidu.com"))?(t=n.getAttribute("src"),new Promise(function(e){var A,n=document.createElement("script");n.onload=function(){e(window.BMap)},"string"==typeof t&&(n.src=t),document&&null!==(A=document.querySelector("head"))&&void 0!==A&&A.appendChild(n)}).then(function(e){o(e)})):i(e)},document.createElement("script"));A.src="http://api.map.baidu.com/api?v=3.0&ak=".concat(n.ak),null!==(e=null===document||void 0===document?void 0:document.querySelector("head"))&&void 0!==e&&e.appendChild(A)})}),c=function(){var e;t=new A.Map(i.value,(0,tslib_1.__assign)((0,tslib_1.__assign)({},n.config),{enableMapClick:!1})),d(),t.centerAndZoom(new A.Point(null===(e=n.center)||void 0===e?void 0:e.lon,null===(e=n.center)||void 0===e?void 0:e.lat),n.zoom),t.addEventListener("tilesloaded",function(){var e,A;u||(u=!0,(A=document.querySelector(".anchorBL"))&&null!==(e=null==A?void 0:A.parentElement)&&void 0!==e&&e.removeChild(A),setTimeout(function(){i.value.style.background='url("'.concat(loadGridIcon,'") repeat #fff;')},2e3))}),o("onBMapInitReady")},d=function(){t.addControl(new A.NavigationControl),t.enableScrollWheelZoom(!0)};return e({getMap:function(){return t}}),function(){return(0,_vue.createVNode)(adherev_ui_conditionalrender_1.default,{conditional:r},{default:function(){return(0,_vue.createVNode)("div",{class:selectorPrefix,ref:i},null)},noMatch:function(){return(0,_vue.createVNode)("div",null,[(0,_vue.createTextVNode)("loading")])}})}}});
//# sourceMappingURL=bmap.js.map
