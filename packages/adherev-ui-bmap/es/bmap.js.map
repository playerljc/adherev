{"version":3,"file":"bmap.js","sources":["bmap.js"],"sourcesContent":["import { createTextVNode as _createTextVNode, createVNode as _createVNode } from \"vue\";\nimport { __assign } from \"tslib\";\nimport { defineComponent, nextTick, onMounted, ref } from 'vue';\nimport { bool, number, object, string } from 'vue-types';\nimport ConditionalRender from '@baifendian/adherev-ui-conditionalrender';\nvar selectorPrefix = 'adhere-ui-bmap';\nvar loadGridIcon = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAUdJREFUeNrs2sENwyAQRcE4ckf0RBv04Z7ck30wFXBi/4wU5bScXhQk9hhj9B+xzu/7WjijvZ/b/Jbz/e83kE0AAkAACAABIAAEgAAQAAJAAAgAAVDYfA5ui+eY33R+BuA9PXO++QtwB0AACAABIAAEgAAQAAJAAAgAASAAqrIPED5vH8A+AO4ACAABIAAEgAAQAAJAAAgAASAABEBJ9gHC5+0D2AfAHQABIAAEgAAQAAJAAAgAASAABIAAKMk+QPi8fQD7ALgDIAAEgAAQAAJAAAgAASAABIAAEAAl2QcIn7cPYB8AdwAEgAAQAAJAAAgAASAABIAAEAACoCT7AOHz9gHsA+AOgAAQAAJAAAgAASAABIAAEAACQACUZB8gfN4+gH0A3AEQAAJAAAgAASAABIAAEAACQABUNV8D++I5nmM3nX8EGADa0U/2xPbBVwAAAABJRU5ErkJggg==';\nexport var bmapProps = {\n  ak: string().def('bxFuXXDt1oKdlgu6mXCCnK51cDgDGBLp'),\n  zoom: number().def(5),\n  center: object().def({\n    lon: 116.404,\n    lat: 39.915\n  }).isRequired,\n  config: object().def({\n    minZoom: 2,\n    maxZoom: 20,\n    enableHighResolution: true,\n    enableAutoResize: true,\n    enableMapClick: false\n  }),\n  externalImportBMapScript: bool().def(false)\n};\nexport default defineComponent({\n  name: 'adv-bmap',\n  props: bmapProps,\n  emits: ['bMapInitReady'],\n  setup: function setup(props, _a) {\n    var emit = _a.emit,\n      expose = _a.expose;\n    var root = ref(null);\n    var isReady = ref(false);\n    var BMap;\n    var map;\n    var isLoad = false;\n    var initMap = function initMap() {\n      var _a, _b;\n      map = new BMap.Map(root.value, __assign(__assign({}, props.config), {\n        enableMapClick: false\n      }));\n      initMapControl();\n      map.centerAndZoom(new BMap.Point((_a = props.center) === null || _a === void 0 ? void 0 : _a.lon, (_b = props.center) === null || _b === void 0 ? void 0 : _b.lat), props.zoom);\n      map.addEventListener('tilesloaded', function () {\n        var _a;\n        if (isLoad) return;\n        isLoad = true;\n        var logoEl = document.querySelector('.anchorBL');\n        logoEl && ((_a = logoEl === null || logoEl === void 0 ? void 0 : logoEl.parentElement) === null || _a === void 0 ? void 0 : _a.removeChild(logoEl));\n        setTimeout(function () {\n          root.value.style.background = \"url(\\\"\".concat(loadGridIcon, \"\\\") repeat #fff;\");\n        }, 2000);\n      });\n      emit('bMapInitReady');\n    };\n    var initMapControl = function initMapControl() {\n      // 添加比例尺控件\n      map.addControl(new BMap.NavigationControl());\n      //开启鼠标滚轮缩放\n      map.enableScrollWheelZoom(true);\n      // this.map.disableScrollWheelZoom();\n      // this.map.disableDoubleClickZoom();\n      // this.map.disableKeyboard();\n      // this.map.disableContinuousZoom();\n      // this.map.disableAutoResize();\n    };\n\n    var getMap = function getMap() {\n      return map;\n    };\n    expose({\n      getMap: getMap\n    });\n    onMounted(function () {\n      // @ts-ignore\n      BMap = window.BMap;\n      isReady.value = true;\n      nextTick(function () {\n        return initMap();\n      });\n    });\n    return function () {\n      return (// @ts-ignore\n        _createVNode(ConditionalRender, {\n          \"conditional\": isReady.value\n        }, {\n          default: function _default() {\n            return _createVNode(\"div\", {\n              \"class\": selectorPrefix,\n              \"ref\": root\n            }, null);\n          },\n          noMatch: function noMatch() {\n            return _createVNode(\"div\", null, [_createTextVNode(\"loading\")]);\n          }\n        })\n      );\n    };\n  }\n});"],"names":["_createTextVNode","_createVNode","__assign","defineComponent","nextTick","onMounted","ref","bool","number","object","string","ConditionalRender","selectorPrefix","loadGridIcon","bmapProps","ak","def","zoom","center","lon","lat","isRequired","config","minZoom","maxZoom","enableHighResolution","enableAutoResize","enableMapClick","externalImportBMapScript","name","props","emits","setup","_a","initMapControl","map","addControl","BMap","NavigationControl","enableScrollWheelZoom","emit","expose","root","isReady","isLoad","getMap","window","value","_b","Map","centerAndZoom","Point","addEventListener","logoEl","document","querySelector","parentElement","removeChild","setTimeout","style","background","concat","conditional","default","class","noMatch"],"mappings":"OAA4BA,oCAAiCC,2BAAyB,KAAL,aACxEC,QAAuB,KAAP,eAChBC,gBAAiBC,SAAUC,UAAWC,GAAgB,KAAL,aACjDC,KAAMC,OAAQC,OAAQC,MAAyB,KAAX,mBACtCC,sBAAuB,2CAC9B,IAAIC,eAAiB,iBACjBC,aAAe,6kBACRC,UAAY,CACrBC,GAAIL,OAAO,EAAEM,IAAI,kCAAkC,EACnDC,KAAMT,OAAO,EAAEQ,IAAI,CAAC,EACpBE,OAAQT,OAAO,EAAEO,IAAI,CACnBG,IAAK,QACLC,IAAK,MACP,CAAC,EAAEC,WACHC,OAAQb,OAAO,EAAEO,IAAI,CACnBO,QAAS,EACTC,QAAS,GACTC,qBAAsB,CAAA,EACtBC,iBAAkB,CAAA,EAClBC,eAAgB,CAAA,CAClB,CAAC,EACDC,yBAA0BrB,KAAK,EAAES,IAAI,CAAA,CAAK,CAC5C,iBACeb,gBAAgB,CAC7B0B,KAAM,WACNC,MAAOhB,UACPiB,MAAO,CAAC,iBACRC,MAAO,SAAeF,EAAOG,GA2BN,SAAjBC,IAEFC,EAAIC,WAAW,IAAIC,EAAKC,iBAAmB,EAE3CH,EAAII,sBAAsB,CAAA,CAAI,CAMhC,CApCA,IAIIF,EACAF,EALAK,EAAOP,EAAGO,KACZC,EAASR,EAAGQ,OACVC,EAAOpC,IAAI,IAAI,EACfqC,EAAUrC,IAAI,CAAA,CAAK,EAGnBsC,EAAS,CAAA,EA8Cb,OAXAH,EAAO,CACLI,OAJW,WACX,OAAOV,CACT,CAGA,CAAC,EACD9B,UAAU,WAERgC,EAAOS,OAAOT,KACdM,EAAQI,MAAQ,CAAA,EAChB3C,SAAS,WAzCG,IACJ4C,EACRb,EAAM,IAAIE,EAAKY,IAAIP,EAAKK,MAAO7C,SAASA,SAAS,GAAI4B,EAAMR,MAAM,EAAG,CAClEK,eAAgB,CAAA,CAClB,CAAC,CAAC,EACFO,EAAe,EACfC,EAAIe,cAAc,IAAIb,EAAKc,MAAM,OAAClB,EAAKH,EAAMZ,QAAoC,KAAA,EAASe,EAAGd,IAAK,OAAC6B,EAAKlB,EAAMZ,QAAoC,KAAA,EAAS8B,EAAG5B,GAAG,EAAGU,EAAMb,IAAI,EAC9KkB,EAAIiB,iBAAiB,cAAe,WAClC,IAAInB,EAGAoB,EAFAT,IACJA,EAAS,CAAA,GACLS,EAASC,SAASC,cAAc,WAAW,IACpC,OAACtB,EAAKoB,MAAAA,EAAuC,KAAA,EAASA,EAAOG,gBAAoDvB,EAAGwB,YAAYJ,CAAM,EACjJK,WAAW,WACThB,EAAKK,MAAMY,MAAMC,WAAa,QAASC,OAAOhD,aAAc,iBAAkB,CAChF,EAAG,GAAI,EACT,CAAC,EACD2B,EAAK,eAAe,CA0BpB,CAAC,CACH,CAAC,EACM,WACL,OACEvC,aAAaU,kBAAmB,CAC9BmD,YAAenB,EAAQI,KACzB,EAAG,CACDgB,QAAS,WACP,OAAO9D,aAAa,MAAO,CACzB+D,MAASpD,eACTN,IAAOoC,CACT,EAAG,IAAI,CACT,EACAuB,QAAS,WACP,OAAOhE,aAAa,MAAO,KAAM,CAACD,iBAAiB,SAAS,EAAE,CAChE,CACF,CACF,CACF,CACF,CACF,CAAC,SA3FUc,SA2FT"}