"use strict";require("core-js/modules/es.object.define-property.js"),require("core-js/modules/es.string.anchor.js"),require("core-js/modules/es.object.to-string.js"),require("core-js/modules/web.dom-collections.for-each.js"),require("core-js/modules/es.array.find.js"),require("core-js/modules/es.array.map.js"),require("core-js/modules/es.function.name.js"),Object.defineProperty(exports,"__esModule",{value:!0}),exports.AnchorNavigationPropTypes=void 0;var tslib_1=require("tslib"),adherev_ui_conditionalrender_1=tslib_1.__importDefault(require("@baifendian/adherev-ui-conditionalrender")),adherev_util_1=tslib_1.__importDefault(require("@baifendian/adherev-util"));exports.AnchorNavigationPropTypes={defaultActiveAnchor:{type:String,default:""},anchors:{type:Array,default:function(){return[]}},anchorPosition:{type:Object,default:function(){return{top:77,width:120}}},scrollEl:{type:HTMLElement,default:function(){return null}}};var selectPrefix="adherev-ui-playground-anchor-navigation",AnchorNavigation={name:"adv-playground-anchor-navigation",props:tslib_1.__assign({},exports.AnchorNavigationPropTypes),data:function(){return{activeAnchor:this.defaultActiveAnchor,$anchorDimensionIndex:[]}},watch:{defaultActiveAnchor:function(e){this.activeAnchor=e},scrollEl:function(e,n){n&&n.removeEventListener("scroll",this.onWrapScroll),e&&(this.createAnchorDimensionIndex(),e.addEventListener("scroll",this.onWrapScroll))}},mounted:function(){var e;"undefined"!=typeof window&&(window.addEventListener("hashchange",this.onHashChange),(e=this.scrollEl)&&(this.createAnchorDimensionIndex(),e.addEventListener("scroll",this.onWrapScroll)))},beforeDestroy:function(){var e;"undefined"!=typeof window&&(window.removeEventListener("hashchange",this.onHashChange),(e=this.scrollEl)&&e.removeEventListener("scroll",this.onWrapScroll))},methods:{onHashChange:function(){this.activeAnchor=window.location.hash.substring(1)},onWrapScroll:function(){var e,n=this.scrollEl,r=this.$refs.anchorRef;n&&(e=n.scrollTop,(n=this.findAnchorByScrollVal(e))&&(this.activeAnchor=n.anchor),0===e?r.classList.remove(selectPrefix+"-affix"):(r.classList.add(selectPrefix+"-affix"),r.style.top=this.anchorPosition.top+"px"))},createAnchorDimensionIndex:function(){var o,e=this.scrollEl,i=this.$data;e&&(o=e,i.$anchorDimensionIndex=[],this.anchors.forEach(function(e,n){var r=e.anchor,t=document.getElementById(r);t&&(e=adherev_util_1.default.getTopUntil({el:t,untilEl:o}),i.$anchorDimensionIndex.push(r={anchor:r,range:{top:e,bottom:void 0}}),0!==n&&(i.$anchorDimensionIndex[n-1].range.bottom=e),n===i.$anchorDimensionIndex.length-1&&(r.range.bottom=e+t.offsetHeight))}))},findAnchorByScrollVal:function(n){return this.$data.$anchorDimensionIndex.find(function(e){return n>=e.range.top&&n<=e.range.bottom})}},render:function(n){var r=this;return n("div",{class:selectPrefix},[n("div",{class:selectPrefix+"-auto"},[n("div",{class:selectPrefix+"-inner"},[this.$slots.default])]),n(adherev_ui_conditionalrender_1.default,{attrs:{conditional:!!this.anchors.length}},[n("div",{class:selectPrefix+"-fixed",style:{width:this.anchorPosition.width+"px"}},[n("ul",{class:selectPrefix+"-anchor",ref:"anchorRef"},[this.anchors.map(function(e){return n("li",{class:e.anchor===r.activeAnchor?selectPrefix+"-active":"",attrs:{title:e.name}},[n("a",{attrs:{href:"#"+e.anchor}},[e.name])])})])])])])}};exports.default=AnchorNavigation;
//# sourceMappingURL=AnchorNavigation.js.map
