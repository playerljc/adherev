"use strict";require("core-js/modules/es.object.define-property.js"),require("core-js/modules/es.object.to-string.js"),require("core-js/modules/web.dom-collections.for-each.js"),require("core-js/modules/es.array.find.js"),require("core-js/modules/es.array.map.js"),Object.defineProperty(exports,"__esModule",{value:!0}),exports.AnchorNavigationPropTypes=void 0;var tslib_1=require("tslib"),adherev_ui_conditionalrender_1=tslib_1.__importDefault(require("@baifendian/adherev-ui-conditionalrender")),adherev_util_1=tslib_1.__importDefault(require("@baifendian/adherev-util")),selectPrefix=(exports.AnchorNavigationPropTypes={defaultActiveAnchor:{type:String,default:""},anchors:{type:Array,default:function(){return[]}},anchorPosition:{type:Object,default:function(){return{top:77,width:120}}},scrollEl:{type:HTMLElement,default:function(){return null}}},"adherev-ui-playground-anchor-navigation"),AnchorNavigation={name:"adv-playground-anchor-navigation",props:tslib_1.__assign({},exports.AnchorNavigationPropTypes),data:function(){return{activeAnchor:this.defaultActiveAnchor,$anchorDimensionIndex:[]}},watch:{defaultActiveAnchor:function(e){this.activeAnchor=e},scrollEl:function(e,n){n&&n.removeEventListener("scroll",this.onWrapScroll),e&&(this.createAnchorDimensionIndex(),e.addEventListener("scroll",this.onWrapScroll))}},mounted:function(){var e;"undefined"!=typeof window&&(window.addEventListener("hashchange",this.onHashChange),e=this.scrollEl)&&(this.createAnchorDimensionIndex(),e.addEventListener("scroll",this.onWrapScroll))},beforeDestroy:function(){var e;"undefined"!=typeof window&&(window.removeEventListener("hashchange",this.onHashChange),e=this.scrollEl)&&e.removeEventListener("scroll",this.onWrapScroll)},methods:{onHashChange:function(){this.activeAnchor=window.location.hash.substring(1)},onWrapScroll:function(){var e,n=this.scrollEl,t=this.$refs.anchorRef;n&&(n=n.scrollTop,(e=this.findAnchorByScrollVal(n))&&(this.activeAnchor=e.anchor),0===n?t.classList.remove("".concat(selectPrefix,"-affix")):(t.classList.add("".concat(selectPrefix,"-affix")),t.style.top="".concat(this.anchorPosition.top,"px")))},createAnchorDimensionIndex:function(){var r,e=this.scrollEl,i=this.$data;e&&(r=e,i.$anchorDimensionIndex=[],this.anchors.forEach(function(e,n){var t,e=e.anchor,o=document.getElementById(e);o&&(t=adherev_util_1.default.getTopUntil({el:o,untilEl:r}),i.$anchorDimensionIndex.push(e={anchor:e,range:{top:t,bottom:void 0}}),0!==n&&(i.$anchorDimensionIndex[n-1].range.bottom=t),n===i.$anchorDimensionIndex.length-1)&&(e.range.bottom=t+o.offsetHeight)}))},findAnchorByScrollVal:function(n){return this.$data.$anchorDimensionIndex.find(function(e){return n>=e.range.top&&n<=e.range.bottom})}},render:function(n){var t=this;return n("div",{class:selectPrefix},[n("div",{class:"".concat(selectPrefix,"-auto")},[n("div",{class:"".concat(selectPrefix,"-inner")},[this.$slots.default])]),n(adherev_ui_conditionalrender_1.default,{attrs:{conditional:!!this.anchors.length}},[n("div",{class:"".concat(selectPrefix,"-fixed"),style:{width:"".concat(this.anchorPosition.width,"px")}},[n("ul",{class:"".concat(selectPrefix,"-anchor"),ref:"anchorRef"},[this.anchors.map(function(e){return n("li",{class:e.anchor===t.activeAnchor?"".concat(selectPrefix,"-active"):"",attrs:{title:e.name}},[n("a",{attrs:{href:"#".concat(e.anchor)}},[e.name])])})])])])])}};exports.default=AnchorNavigation;
//# sourceMappingURL=AnchorNavigation.js.map
