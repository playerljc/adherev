import"core-js/modules/es.object.to-string.js";import"core-js/modules/web.dom-collections.for-each.js";import"core-js/modules/es.array.find.js";import"core-js/modules/es.array.map.js";import{__assign}from"tslib";import ConditionalRender from"@baifendian/adherev-ui-conditionalrender";import Util from"@baifendian/adherev-util";var AnchorNavigationPropTypes={defaultActiveAnchor:{type:String,default:""},anchors:{type:Array,default:function(){return[]}},anchorPosition:{type:Object,default:function(){return{top:77,width:120}}},scrollEl:{type:HTMLElement,default:function(){return null}}},selectPrefix="adherev-ui-playground-anchor-navigation",AnchorNavigation={name:"adv-playground-anchor-navigation",props:__assign({},AnchorNavigationPropTypes),data:function(){return{activeAnchor:this.defaultActiveAnchor,$anchorDimensionIndex:[]}},watch:{defaultActiveAnchor:function(n){this.activeAnchor=n},scrollEl:function(n,o){o&&o.removeEventListener("scroll",this.onWrapScroll),n&&(this.createAnchorDimensionIndex(),n.addEventListener("scroll",this.onWrapScroll))}},mounted:function(){var n;"undefined"!=typeof window&&(window.addEventListener("hashchange",this.onHashChange),n=this.scrollEl)&&(this.createAnchorDimensionIndex(),n.addEventListener("scroll",this.onWrapScroll))},beforeDestroy:function(){var n;"undefined"!=typeof window&&(window.removeEventListener("hashchange",this.onHashChange),n=this.scrollEl)&&n.removeEventListener("scroll",this.onWrapScroll)},methods:{onHashChange:function(){this.activeAnchor=window.location.hash.substring(1)},onWrapScroll:function(){var n,o=this.scrollEl,t=this.$refs.anchorRef;o&&(o=o.scrollTop,(n=this.findAnchorByScrollVal(o))&&(this.activeAnchor=n.anchor),0===o?t.classList.remove("".concat(selectPrefix,"-affix")):(t.classList.add("".concat(selectPrefix,"-affix")),t.style.top="".concat(this.anchorPosition.top,"px")))},createAnchorDimensionIndex:function(){var i,n=this.scrollEl,r=this.$data;n&&(i=n,r.$anchorDimensionIndex=[],this.anchors.forEach(function(n,o){var t,n=n.anchor,e=document.getElementById(n);e&&(t=Util.getTopUntil({el:e,untilEl:i}),r.$anchorDimensionIndex.push(n={anchor:n,range:{top:t,bottom:void 0}}),0!==o&&(r.$anchorDimensionIndex[o-1].range.bottom=t),o===r.$anchorDimensionIndex.length-1)&&(n.range.bottom=t+e.offsetHeight)}))},findAnchorByScrollVal:function(o){return this.$data.$anchorDimensionIndex.find(function(n){return o>=n.range.top&&o<=n.range.bottom})}},render:function(o){var t=this;return o("div",{class:selectPrefix},[o("div",{class:"".concat(selectPrefix,"-auto")},[o("div",{class:"".concat(selectPrefix,"-inner")},[this.$slots.default])]),o(ConditionalRender,{attrs:{conditional:!!this.anchors.length}},[o("div",{class:"".concat(selectPrefix,"-fixed"),style:{width:"".concat(this.anchorPosition.width,"px")}},[o("ul",{class:"".concat(selectPrefix,"-anchor"),ref:"anchorRef"},[this.anchors.map(function(n){return o("li",{class:n.anchor===t.activeAnchor?"".concat(selectPrefix,"-active"):"",attrs:{title:n.name}},[o("a",{attrs:{href:"#".concat(n.anchor)}},[n.name])])})])])])])}};export default AnchorNavigation;export{AnchorNavigationPropTypes};
//# sourceMappingURL=AnchorNavigation.js.map
