import{createVNode as _createVNode}from"vue";import"core-js/modules/es.object.to-string.js";import"core-js/modules/web.dom-collections.for-each.js";import"core-js/modules/es.array.find.js";import"core-js/modules/es.array.map.js";import{defineComponent,onBeforeMount,onMounted,ref,watch}from"vue";import{array,object,string}from"vue-types";import ConditionalRender from"@baifendian/adherev-ui-conditionalrender";import Util from"@baifendian/adherev-util";var selectPrefix="adherev-ui-playground-anchor-navigation",anchorNavigationProps={defaultActiveAnchor:string().def(""),anchors:array().def([]),anchorPosition:object().def({top:77,width:120}),scrollEl:object()};export default defineComponent({name:"adv-playground-anchor-navigation",props:anchorNavigationProps,setup:function(n,e){function o(){c.value=window.location.hash.substring(1)}function t(){var e,o;n.scrollEl&&(e=n.scrollEl.scrollTop,(o=l(e))&&(c.value=o.anchor),i.value&&(0===e?null!=(o=null==(e=null==(o=null==i?void 0:i.value)?void 0:o.classList)?void 0:e.remove)&&o.call(e,"".concat(selectPrefix,"-affix")):(null!=(o=null==(e=null==(o=null==i?void 0:i.value)?void 0:o.classList)?void 0:e.add)&&o.call(e,"".concat(selectPrefix,"-affix")),i.value.style.top="".concat(n.anchorPosition.top,"px"))))}function r(){var r;n.scrollEl&&(r=n.scrollEl,s=[],n.anchors.forEach(function(e,o){var n,e=e.anchor,t=document.getElementById(e);t&&(n=null==(n=Util.getTopUntil)?void 0:n.call(Util,{el:t,untilEl:r}),s.push(e={anchor:e,range:{top:n,bottom:void 0}}),0!==o&&(s[o-1].range.bottom=n),o===s.length-1&&(e.range.bottom=n+t.offsetHeight))}))}function l(o){return s.find(function(e){return o>=e.range.top&&o<=e.range.bottom})}var a=e.slots,c=ref(n.defaultActiveAnchor),i=ref(),s=[];return watch(function(){return n.defaultActiveAnchor},function(e){return c.value=e}),watch(function(){return n.scrollEl},function(e,o){var n;null!=(n=null==o?void 0:o.removeEventListener)&&n.call(o,"scroll",t),e&&(r(),null!=(n=null==e?void 0:e.addEventListener)&&n.call(e,"scroll",t))}),onMounted(function(){"undefined"!=typeof window&&(window.addEventListener("hashchange",o),n.scrollEl&&(r(),n.scrollEl.addEventListener("scroll",t)))}),onBeforeMount(function(){window.removeEventListener("hashchange",o),n.scrollEl&&n.scrollEl.removeEventListener("scroll",t)}),function(){var e;return _createVNode("div",{class:selectPrefix},[_createVNode("div",{class:"".concat(selectPrefix,"-auto")},[_createVNode("div",{class:"".concat(selectPrefix,"-inner")},[null==(e=null==a?void 0:a.default)?void 0:e.call(a)])]),_createVNode(ConditionalRender,{conditional:!!n.anchors.length},{default:function(){return[_createVNode("div",{class:"".concat(selectPrefix,"-fixed"),style:{width:"".concat(n.anchorPosition.width,"px")}},[_createVNode("ul",{class:"".concat(selectPrefix,"-anchor"),ref:i},[n.anchors.map(function(e){return _createVNode("li",{class:e.anchor===c.value?"".concat(selectPrefix,"-active"):"",title:e.name},[_createVNode("a",{href:"#".concat(e.anchor)},[e.name])])})])])]}})])}}});export{anchorNavigationProps};
//# sourceMappingURL=AnchorNavigation.js.map
