import"core-js/modules/es.string.anchor.js";import"core-js/modules/es.object.to-string.js";import"core-js/modules/web.dom-collections.for-each.js";import"core-js/modules/es.array.find.js";import"core-js/modules/es.array.map.js";import"core-js/modules/es.function.name.js";import{__assign}from"tslib";import ConditionalRender from"@baifendian/adherev-ui-conditionalrender";import Util from"@baifendian/adherev-util";var AnchorNavigationPropTypes={defaultActiveAnchor:{type:String,default:""},anchors:{type:Array,default:function(){return[]}},anchorPosition:{type:Object,default:function(){return{top:77,width:120}}},scrollEl:{type:HTMLElement,default:function(){return null}}},selectPrefix="adherev-ui-playground-anchor-navigation";export default{name:"adv-playground-anchor-navigation",props:__assign({},AnchorNavigationPropTypes),data:function(){return{activeAnchor:this.defaultActiveAnchor,$anchorDimensionIndex:[]}},watch:{defaultActiveAnchor:function(n){this.activeAnchor=n},scrollEl:function(n,e){e&&e.removeEventListener("scroll",this.onWrapScroll),n&&(this.createAnchorDimensionIndex(),n.addEventListener("scroll",this.onWrapScroll))}},mounted:function(){var n;"undefined"!=typeof window&&(window.addEventListener("hashchange",this.onHashChange),(n=this.scrollEl)&&(this.createAnchorDimensionIndex(),n.addEventListener("scroll",this.onWrapScroll)))},beforeDestroy:function(){var n;"undefined"!=typeof window&&(window.removeEventListener("hashchange",this.onHashChange),(n=this.scrollEl)&&n.removeEventListener("scroll",this.onWrapScroll))},methods:{onHashChange:function(){this.activeAnchor=window.location.hash.substring(1)},onWrapScroll:function(){var n,e=this.scrollEl,o=this.$refs.anchorRef;e&&(n=e.scrollTop,(e=this.findAnchorByScrollVal(n))&&(this.activeAnchor=e.anchor),0===n?o.classList.remove(selectPrefix+"-affix"):(o.classList.add(selectPrefix+"-affix"),o.style.top=this.anchorPosition.top+"px"))},createAnchorDimensionIndex:function(){var r,n=this.scrollEl,i=this.$data;n&&(r=n,i.$anchorDimensionIndex=[],this.anchors.forEach(function(n,e){var o=n.anchor,t=document.getElementById(o);t&&(n=Util.getTopUntil({el:t,untilEl:r}),i.$anchorDimensionIndex.push(o={anchor:o,range:{top:n,bottom:void 0}}),0!==e&&(i.$anchorDimensionIndex[e-1].range.bottom=n),e===i.$anchorDimensionIndex.length-1&&(o.range.bottom=n+t.offsetHeight))}))},findAnchorByScrollVal:function(e){return this.$data.$anchorDimensionIndex.find(function(n){return e>=n.range.top&&e<=n.range.bottom})}},render:function(e){var o=this;return e("div",{class:selectPrefix},[e("div",{class:selectPrefix+"-auto"},[e("div",{class:selectPrefix+"-inner"},[this.$slots.default])]),e(ConditionalRender,{attrs:{conditional:!!this.anchors.length}},[e("div",{class:selectPrefix+"-fixed",style:{width:this.anchorPosition.width+"px"}},[e("ul",{class:selectPrefix+"-anchor",ref:"anchorRef"},[this.anchors.map(function(n){return e("li",{class:n.anchor===o.activeAnchor?selectPrefix+"-active":"",attrs:{title:n.name}},[e("a",{attrs:{href:"#"+n.anchor}},[n.name])])})])])])])}};export{AnchorNavigationPropTypes};
//# sourceMappingURL=AnchorNavigation.js.map
