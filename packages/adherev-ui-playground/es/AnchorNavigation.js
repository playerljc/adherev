import{createVNode as _createVNode}from"vue";import"core-js/modules/es.string.anchor.js";import"core-js/modules/es.object.to-string.js";import"core-js/modules/web.dom-collections.for-each.js";import"core-js/modules/es.array.find.js";import"core-js/modules/es.array.map.js";import"core-js/modules/es.function.name.js";import ConditionalRender from"@baifendian/adherev-ui-conditionalrender";import Util from"@baifendian/adherev-util";import{defineComponent,onBeforeMount,onMounted,ref,watch}from"vue";import{array,object,string}from"vue-types";var selectPrefix="adherev-ui-playground-anchor-navigation",anchorNavigationProps={defaultActiveAnchor:string().def(""),anchors:array().def([]),anchorPosition:object().def({top:77,width:120}),scrollEl:object()};export default defineComponent({name:"adv-playground-anchor-navigation",props:anchorNavigationProps,setup:function(n,o){function e(){i.value=window.location.hash.substring(1)}function t(){var o,e;n.scrollEl&&(o=n.scrollEl.scrollTop,(e=l(o))&&(i.value=e.anchor),c.value&&(0===o?null!==(e=null===(o=null===(e=null==c?void 0:c.value)||void 0===e?void 0:e.classList)||void 0===o?void 0:o.remove)&&void 0!==e&&e.call(o,"".concat(selectPrefix,"-affix")):(null!==(e=null===(o=null===(e=null==c?void 0:c.value)||void 0===e?void 0:e.classList)||void 0===o?void 0:o.add)&&void 0!==e&&e.call(o,"".concat(selectPrefix,"-affix")),c.value.style.top="".concat(n.anchorPosition.top,"px"))))}function r(){var r;n.scrollEl&&(r=n.scrollEl,s=[],n.anchors.forEach(function(o,e){var n,o=o.anchor,t=document.getElementById(o);t&&(n=null===(n=Util.getTopUntil)||void 0===n?void 0:n.call(Util,{el:t,untilEl:r}),s.push(o={anchor:o,range:{top:n,bottom:void 0}}),0!==e&&(s[e-1].range.bottom=n),e===s.length-1&&(o.range.bottom=n+t.offsetHeight))}))}function l(e){return s.find(function(o){return e>=o.range.top&&e<=o.range.bottom})}var a=o.slots,i=ref(n.defaultActiveAnchor),c=ref(),s=[];return watch(function(){return n.defaultActiveAnchor},function(o){return i.value=o}),watch(function(){return n.scrollEl},function(o,e){var n;null!==(n=null==e?void 0:e.removeEventListener)&&void 0!==n&&n.call(e,"scroll",t),o&&(r(),null!==(n=null==o?void 0:o.addEventListener)&&void 0!==n&&n.call(o,"scroll",t))}),onMounted(function(){"undefined"!=typeof window&&(window.addEventListener("hashchange",e),n.scrollEl&&(r(),n.scrollEl.addEventListener("scroll",t)))}),onBeforeMount(function(){window.removeEventListener("hashchange",e),n.scrollEl&&n.scrollEl.removeEventListener("scroll",t)}),function(){var o;return _createVNode("div",{class:selectPrefix},[_createVNode("div",{class:"".concat(selectPrefix,"-auto")},[_createVNode("div",{class:"".concat(selectPrefix,"-inner")},[null===(o=null==a?void 0:a.default)||void 0===o?void 0:o.call(a)])]),_createVNode(ConditionalRender,{conditional:!!n.anchors.length},{default:function(){return[_createVNode("div",{class:"".concat(selectPrefix,"-fixed"),style:{width:"".concat(n.anchorPosition.width,"px")}},[_createVNode("ul",{class:"".concat(selectPrefix,"-anchor"),ref:c},[n.anchors.map(function(o){return _createVNode("li",{class:o.anchor===i.value?"".concat(selectPrefix,"-active"):"",title:o.name},[_createVNode("a",{href:"#".concat(o.anchor)},[o.name])])})])])]}})])}}});export{anchorNavigationProps};
//# sourceMappingURL=AnchorNavigation.js.map
