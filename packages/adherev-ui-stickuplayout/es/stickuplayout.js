import"core-js/modules/es.regexp.exec.js";import"core-js/modules/es.string.split.js";import classNames from"classnames";var selectorPrefix="adherev-ui-stickuplayout",StickUpLayout={name:"adv-stickuplayout",props:{fixedClassName:{type:String,default:""},fixedStyle:{type:Object,default:function(){return{}}},innerClassName:{type:String,default:""},innerStyle:{type:Object,default:function(){return{}}}},data:function(){return{$key:!1,$maskEl:null,$index:[],$headerEls:null,$preScrollObj:null}},mounted:function(){this.initial()},updated:function(){this.initial()},beforeDestroy:function(){var e=this.$data.$maskEl;e&&e.parentElement.removeChild(e)},methods:{initial:function(){var e=this.$refs,i=this.$data;i.$key=!1,i.$index=[],i.$headerEls=e.el.querySelectorAll("."+selectorPrefix+"-item-header"),this.createIndex(),this.position(),e.innerEl.removeEventListener("scroll",this.onScroll),e.innerEl.addEventListener("scroll",this.onScroll)},createIndex:function(){var e=this.$refs,i=this.$data,t=0;i.$index=[],i.$preScrollObj=null;for(var n=0,r=i.$headerEls.length;n<r;n++){var s=i.$headerEls[n],l=t,o=void 0,o=n!==r-1?i.$headerEls[n+1].offsetTop-s.offsetHeight:e.innerEl.scrollHeight;if(i.$index.push({start:l,end:o,dom:s,index:n}),(t=o)>e.innerEl.scrollHeight-e.innerEl.offsetHeight)break}},position:function(){for(var e,i=this.$refs,t=this.$data,n=i.innerEl.scrollTop,r=0,s=t.$index.length-1;r<=s&&r<=t.$index.length-1&&s<=t.$index.length-1;){var l,o=t.$index[l=s+r>>1];if(n>=o.start&&n<o.end){e=o;break}n<o.start?s=l-1:r=1+l}if(e){if(t.$preScrollObj&&t.$preScrollObj.index===e.index)return!1;t.$preScrollObj=e,i.fixedEl.innerHTML=e.dom.outerHTML,this.$emit("change",e.index)}},onScroll:function(){this.position()},scrollAnimationTo:function(t,e){void 0===t&&(t=0),void 0===e&&(e=300);var n,r,s,l=this.$refs,o=this.$data;o.$key||(this.initMask(),o.$key=!0,o.$maskEl.style.display="block",n=l.innerEl.scrollTop,r=n,s=l.innerEl.scrollHeight/(e/(screen.updateInterval||16.7)+(e%(screen.updateInterval||16.7)!=0?1:0)),window.requestAnimationFrame(function e(){function i(){o.$key=!1,o.$maskEl.style.display="none"}n<t?t<r+s?r=t:r+=s:r-s<t?r=t:r-=s,l.innerEl.scrollTop=r,n<t?t<=r?i():"undefined"!=typeof window&&window.requestAnimationFrame(e):r<=t?i():"undefined"!=typeof window&&window.requestAnimationFrame(e)}))},scrollTo:function(e,i){var t=this.$refs,n=this.$data.$headerEls,e=e.start+n[e.index].offsetHeight;0===(i=void 0===i?300:i)?t.innerEl.scrollTop=e:this.scrollAnimationTo(e,i)},initMask:function(){this.$data.$maskEl||(this.$data.$maskEl=document.createElement("div"),this.$data.$maskEl.className=selectorPrefix+"-mask",window.document.body.appendChild(this.$data.$maskEl))},refresh:function(){this.initial()},scrollToByIndex:function(e,i){void 0===i&&(i=300);for(var t,n=this.$data.$index,r=0;r<n.length;r++)if(n[r].index===e){t=n[r];break}if(!t)return!1;this.scrollTo(t,i)},scrollToByHeaderEl:function(e,i){void 0===i&&(i=300);for(var t,n=this.$data.$index,r=0;r<n.length;r++)if(n[r].dom===e){t=n[r],0;break}if(!t)return!1;this.scrollTo(t,i)}},render:function(e){var i=this,t=i.$slots,n=i.fixedClassName,r=i.fixedStyle,s=i.innerClassName,i=i.innerStyle;return e("div",{class:selectorPrefix,ref:"el"},[e("div",{class:classNames(selectorPrefix+"-fixed",n.split(/\s+/)),style:r,ref:"fixedEl"}),e("div",{class:classNames(selectorPrefix+"-inner",s.split(/\s+/)),style:i,ref:"innerEl"},[t.default])])}};export default StickUpLayout;
//# sourceMappingURL=stickuplayout.js.map
