import classNames from"classnames";var selectorPrefix="adherev-ui-stickuplayout",StickUpLayout={name:"adv-stickuplayout",props:{fixedClassName:{type:String,default:""},fixedStyle:{type:String,default:""},innerClassName:{type:String,default:""},innerStyle:{type:String,default:""}},emits:["change"],data:function(){return{$key:!1,$maskEl:null,$index:[],$headerEls:null,$preScrollObj:null}},mounted:function(){this.initial()},updated:function(){this.initial()},beforeDestroy:function(){var e=this.$data.$maskEl;e&&e.parentElement.removeChild(e)},methods:{initial:function(){var e=this.$refs,t=this.$data;t.$key=!1,t.$index=[],t.$headerEls=e.el.querySelectorAll(".".concat(selectorPrefix,"-item-header")),this.createIndex(),this.position(),e.innerEl.removeEventListener("scroll",this.onScroll),e.innerEl.addEventListener("scroll",this.onScroll)},createIndex:function(){var e=this.$refs,t=this.$data,i=0;t.$index=[],t.$preScrollObj=null;for(var n=0,l=t.$headerEls.length;n<l;n++){var r=t.$headerEls[n],s=i,a=void 0,a=n!==l-1?t.$headerEls[n+1].offsetTop-r.offsetHeight:e.innerEl.scrollHeight;if(t.$index.push({start:s,end:a,dom:r,index:n}),(i=a)>e.innerEl.scrollHeight-e.innerEl.offsetHeight)break}},position:function(){for(var e,t=this.$refs,i=this.$data,n=t.innerEl.scrollTop,l=0,r=i.$index.length-1;l<=r&&l<=i.$index.length-1&&r<=i.$index.length-1;){var s,a=i.$index[s=r+l>>1];if(n>=a.start&&n<a.end){e=a;break}n<a.start?r=s-1:l=1+s}if(e){if(i.$preScrollObj&&i.$preScrollObj.index===e.index)return!1;i.$preScrollObj=e,t.fixedEl.innerHTML=e.dom.outerHTML,this.$emit("change",e.index)}},onScroll:function(){this.position()},scrollAnimationTo:function(i,e){void 0===i&&(i=0),void 0===e&&(e=300);var n,l,r,s=this.$refs,a=this.$data;a.$key||(this.initMask(),a.$key=!0,a.$maskEl.style.display="block",n=s.innerEl.scrollTop,l=n,r=s.innerEl.scrollHeight/(e/(screen.updateInterval||16.7)+(e%(screen.updateInterval||16.7)!=0?1:0)),window.requestAnimationFrame(function e(){function t(){a.$key=!1,a.$maskEl.style.display="none"}n<i?i<l+r?l=i:l+=r:l-r<i?l=i:l-=r,s.innerEl.scrollTop=l,n<i?i<=l?t():"undefined"!=typeof window&&window.requestAnimationFrame(e):l<=i?t():"undefined"!=typeof window&&window.requestAnimationFrame(e)}))},scrollTo:function(e,t){var i=this.$refs,n=this.$data.$headerEls,n=e.start+n[e.index].offsetHeight;0===(t=void 0===t?300:t)?i.innerEl.scrollTop=n:this.scrollAnimationTo(n,t)},initMask:function(){this.$data.$maskEl||(this.$data.$maskEl=document.createElement("div"),this.$data.$maskEl.className="".concat(selectorPrefix,"-mask"),window.document.body.appendChild(this.$data.$maskEl))},refresh:function(){this.initial()},scrollToByIndex:function(e,t){void 0===t&&(t=300);for(var i,n=this.$data.$index,l=0;l<n.length;l++)if(n[l].index===e){i=n[l];break}i=i||n[n.length-1],this.scrollTo(i,t)},scrollToByHeaderEl:function(e,t){void 0===t&&(t=300);for(var i,n=this.$data.$index,l=0;l<n.length;l++)if(n[l].dom===e){i=n[l],0;break}i=i||n[n.length-1],this.scrollTo(i,t)}},render:function(e){var t=this,i=t.$slots,n=t.fixedClassName,l=t.fixedStyle,r=t.innerClassName,t=t.innerStyle;return e("div",{class:selectorPrefix,ref:"el"},[e("div",{class:classNames("".concat(selectorPrefix,"-fixed"),n||""),style:l,ref:"fixedEl"}),e("div",{class:classNames("".concat(selectorPrefix,"-inner"),r||""),style:t,ref:"innerEl"},[i.default])])}};export default StickUpLayout;
//# sourceMappingURL=stickuplayout.js.map
