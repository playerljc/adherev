import{createVNode as _createVNode}from"vue";import classNames from"classnames";import{defineComponent,onBeforeMount,onMounted,onUpdated,ref}from"vue";import{object,string}from"vue-types";var selectorPrefix="adherev-ui-stickuplayout",stickupLayoutProps={fixedClassName:string().def(""),fixedStyle:object().def({}),innerClassName:string().def(""),innerStyle:object().def({})};export default defineComponent({name:"adv-stickuplayout",props:stickupLayoutProps,emits:["change"],setup:function(n,e){function o(){var e;c=!1,v=[],a=null==(e=r.value)?void 0:e.querySelectorAll(".".concat(selectorPrefix,"-item-header")),p(),h(),null!=(e=u.value)&&e.removeEventListener("scroll",y),null!=(e=u.value)&&e.addEventListener("scroll",y)}function l(e,n){e=e.start+a[e.index].offsetHeight,0===(n=void 0===n?300:n)?u.value.scrollTop=e:x(e,n)}function i(){f||((f=document.createElement("div")).className="".concat(selectorPrefix,"-mask"),window.document.body.appendChild(f))}var a,t=e.slots,s=e.emit,e=e.expose,r=ref(),d=ref(),u=ref(),c=!1,f=null,v=[],m=null,p=function(){var e,n=0;v=[],m=null;for(var o=0,t=a.length;o<t;o++){var l=a[o],r=n,i=void 0,i=o!==t-1?a[o+1].offsetTop-l.offsetHeight:null==(e=u.value)?void 0:e.scrollHeight;if(v.push({start:r,end:i,dom:l,index:o}),(n=i)>(null==(e=u.value)?void 0:e.scrollHeight)-(null==(r=u.value)?void 0:r.offsetHeight))break}},h=function(){for(var e,n,o=null==(e=u.value)?void 0:e.scrollTop,t=0,l=v.length-1;t<=l&&t<=v.length-1&&l<=v.length-1;){var r,i=v[r=l+t>>1];if(o>=i.start&&o<i.end){n=i;break}o<i.start?l=r-1:t=1+r}if(n){if(m&&m.index===n.index)return!1;m=n,d.value.innerHTML=n.dom.outerHTML,s("change",n.index)}},y=function(){return h()},x=function(o,e){var n,t,l,r;void 0===o&&(o=0),void 0===e&&(e=300),c||(i(),c=!0,f.style.display="block",t=null==(n=u.value)?void 0:n.scrollTop,l=t,r=(null==(n=u.value)?void 0:n.scrollHeight)/(e/((null==(n=window.screen)?void 0:n.updateInterval)||16.7)+(e%((null==(n=window.screen)?void 0:n.updateInterval)||16.7)!=0?1:0)),window.requestAnimationFrame(function e(){function n(){c=!1,f.style.display="none"}t<o?o<l+r?l=o:l+=r:l-r<o?l=o:l-=r,u.value.scrollTop=l,t<o?o<=l?n():"undefined"!=typeof window&&window.requestAnimationFrame(e):l<=o?n():"undefined"!=typeof window&&window.requestAnimationFrame(e)}))};return e({refresh:o,scrollToByIndex:function(e,n){void 0===n&&(n=300);for(var o,t=0;t<v.length;t++)if(v[t].index===e){o=v[t];break}o=o||v[v.length-1],l(o,n)},scrollToByHeaderEl:function(e,n){void 0===n&&(n=300);for(var o,t=0;t<v.length;t++)if(v[t].dom===e){o=v[t],0;break}o=o||v[v.length-1],l(o,n)}}),onMounted(function(){o()}),onUpdated(function(){o()}),onBeforeMount(function(){var e,n;f&&null!=(n=null==(e=null==f?void 0:f.parentElement)?void 0:e.removeChild)&&n.call(e,f)}),function(){var e;return _createVNode("div",{class:selectorPrefix,ref:r},[_createVNode("div",{class:classNames("".concat(selectorPrefix,"-fixed"),n.fixedClassName||""),style:n.fixedStyle,ref:d},null),_createVNode("div",{class:classNames("".concat(selectorPrefix,"-inner"),n.innerClassName||""),style:n.innerStyle,ref:u},[null==(e=null==t?void 0:t.default)?void 0:e.call(t)])])}}});export{stickupLayoutProps};
//# sourceMappingURL=stickuplayout.js.map
