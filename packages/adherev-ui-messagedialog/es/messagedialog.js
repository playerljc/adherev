import{isVNode as _isVNode,createVNode as _createVNode}from"vue";import"core-js/modules/es.object.to-string.js";import{__assign,__rest}from"tslib";import{createApp,ref,h}from"vue";import{Button,ConfigProvider,Form,Row,Col,Slider,Input}from"ant-design-vue";import formCreate from"@form-create/ant-design-vue";import Util from"@baifendian/adherev-util";import Intl from"@baifendian/adherev-util-intl";import Resource from"@baifendian/adherev-util-resource";import Actions from"./actions";import Emitter from"./emitter";import ModalDialog from"./modal";function _isSlot(t){return"function"==typeof t||"[object Object]"===Object.prototype.toString.call(t)&&!_isVNode(t)}var selectorPrefix="adherev-ui-messagedialog",DEFAULT_LOCAL="zh_CN",LOCAL=Resource.Dict.value.LocalsAntd.value,globalConfig=null;function renderByIcon(t){var e,i=t.icon,t=t.text;return _createVNode("div",{class:"".concat(selectorPrefix,"-renderByIcon")},[_createVNode("div",{class:"".concat(selectorPrefix,"-renderByIcon-fixed")},[null!==(e=null==Util?void 0:Util.isFunction)&&void 0!==e&&e.call(Util,i)?i():i]),_createVNode("div",{class:"".concat(selectorPrefix,"-renderByIcon-auto")},[null!==(e=null==Util?void 0:Util.isFunction)&&void 0!==e&&e.call(Util,t)?t():t])])}var MessageDialogFactory={Confirm:function(t){var e=t.title,i=t.text,o=void 0===i?null:i,i=t.width,n=t.zIndex,l=t.local,r=t.icon,a=void 0===r?null:r,c=t.onSuccess,u=this.Modal({config:{title:e,centered:!0,width:(void 0===i?300:i)||300,closable:!1,zIndex:void 0===n?1e3:n,footer:function(){var t;return[_createVNode(Button,{key:"submit",type:"primary",title:Intl.tv("确定"),onClick:function(){c?c().then(function(){Emitter.trigger(Actions.close,u)}):Emitter.trigger(Actions.close,u)}},_isSlot(t=Intl.tv("确定"))?t:{default:function(){return[t]}})]}},local:l,children:a?function(){return renderByIcon({icon:a,text:o})}:function(){return Util.isFunction(o)?o():o}}).el},Prompt:function(t){var e=t.title,i=t.config,o=t.width,o=void 0===o?300:o,n=t.zIndex,n=void 0===n?1e3:n,l=t.local,r=t.onSuccess,t=(i.option&&(i.option.submitBtn=!1,i.option.resetBtn=!1),this.Modal({config:{title:e,centered:!0,width:o||300,closable:!1,zIndex:n,footer:function(){var t;return[_createVNode(Button,{key:"submit",type:"primary",title:Intl.tv("确定"),onClick:function(){var e;r?(e=c.value.fApi).validate(function(t){t&&r(e.getValue(i.rule[0].field)).then(function(){Emitter.trigger(Actions.close,a)})}):Emitter.trigger(Actions.close,a)}},_isSlot(t=Intl.tv("确定"))?t:{default:function(){return[t]}})]}},local:l,children:{template:'\n          <form-create\n            v-model:api="fApi"\n            :rule="rule"\n            :option="option"\n          ></form-create>\n        ',data:function(){return{fApi:{},rule:i.rule||[{type:"input",field:"prompt",title:"输入框",info:"",_fc_drag_tag:"input",hidden:!1,display:!0,value:"",wrap:{labelCol:{span:4},wrapperCol:{span:20}}}],option:i.option||{form:{labelPosition:"right",size:"mini",labelWidth:"125px",hideRequiredAsterisk:!1,showMessage:!0,inlineMessage:!1,submitBtn:!1,resetBtn:!1}}}}}})),a=t.el,c=t.rootRef},InputPrompt:function(t){var e=t.config,t=__rest(t,["config"]);e.rule[0].type="input",e.rule[0]._fc_drag_tag="input",e.rule[0].field="prompt",MessageDialogFactory.Prompt(__assign(__assign({},t),{config:__assign({},e)}))},TextAreaPrompt:function(t){var e=t.config,t=__rest(t,["config"]);e.rule[0].type="input",e.rule[0]._fc_drag_tag="input",e.rule[0].field="prompt",e.rule[0].props={type:"textarea"},MessageDialogFactory.Prompt(__assign(__assign({},t),{config:__assign({},e)}))},PassWordPrompt:function(t){var e=t.config,t=__rest(t,["config"]);e.rule[0].type="input",e.rule[0]._fc_drag_tag="input",e.rule[0].field="prompt",e.rule[0].props={type:"password"},MessageDialogFactory.Prompt(__assign(__assign({},t),{config:__assign({},e)}))},NumberPrompt:function(t){var e=t.config,t=__rest(t,["config"]);e.rule[0].type="input",e.rule[0]._fc_drag_tag="input",e.rule[0].field="prompt",e.rule[0].props={type:"number"},MessageDialogFactory.Prompt(__assign(__assign({},t),{config:__assign({},e)}))},Alert:function(t){var e=t.title,i=t.text,o=void 0===i?null:i,i=t.width,n=t.zIndex,l=t.local,r=t.icon;this.Modal({config:{title:e,centered:!0,width:(void 0===i?300:i)||300,closable:!1,zIndex:void 0===n?1e3:n},local:l,children:r?function(){return renderByIcon({icon:r,text:o})}:function(){return Util.isFunction(o)?o():o}})},Modal:function(t){var e=t.config,i=void 0===e?{}:e,e=t.children,o=void 0===e?Function:e,e=t.defaultCloneBtn,s=void 0===e||e,e=t.local,n=void 0===e?DEFAULT_LOCAL:e;var l,r=i.title,t=__rest(i,["title"]),a=__assign({maskClosable:!1},t),c=(null!==(e=Util.isString)&&void 0!==e&&e.call(Util,r)&&(a.title=r),document.createElement("div")),t=Intl({I18nOptions:{messages:(globalConfig||{}).messages,locale:n||DEFAULT_LOCAL,globalInjection:!0,legacy:!1},prefix:"local"}),u=createApp({setup:function(){return l=ref(),function(){var t=function(t){var e;if(null===(e=Util.isEmpty)||void 0===e||!e.call(Util,t.footer)){if(null!==(e=Util.isFunction)&&void 0!==e&&e.call(Util,t.footer))return t.footer();if(null!==(e=Util.isObject)&&void 0!==e&&e.call(Util,t.footer))return h(t.footer)}return null}(i);return t&&(a.footerJSX=t),_createVNode(ConfigProvider,{locale:LOCAL[n||DEFAULT_LOCAL]},{default:function(){return[_createVNode(ModalDialog,{config:a,closeBtn:s,onClose:function(){var e;try{null!=u&&u.unmount()}catch(t){null!==(e=null==c?void 0:c.parentElement)&&void 0!==e&&e.removeChild(c)}}},{default:function(){var t,e=o,i=l;if(null===(t=null==Util?void 0:Util.isEmpty)||void 0===t||!t.call(Util,e)){if(null!==(t=null==Util?void 0:Util.isFunction)&&void 0!==t&&t.call(Util,e))return e();if(null!==(t=null==Util?void 0:Util.isObject)&&void 0!==t&&t.call(Util,e))return h(e,{ref:i})}return null},title:function(){var t,e=r;if(null===(t=Util.isEmpty)||void 0===t||!t.call(Util,e)){if(null!==(t=Util.isFunction)&&void 0!==t&&t.call(Util,e))return e();if(null!==(t=Util.isObject)&&void 0!==t&&t.call(Util,e))return h("div",{},[h(e)])}return e}})]}})}}});return u.use(ConfigProvider).use(Button).use(Form).use(Row).use(Col).use(Slider).use(Col).use(Input).use(t).use(formCreate),Intl.use(u),null!==(e=null==globalConfig?void 0:globalConfig.beforeMount)&&void 0!==e&&e.call(globalConfig,u),u.mount(c),document.body.appendChild(c),{el:c,vm:u,rootRef:l}},close:function(t){Emitter.trigger(Actions.close,t)},setConfig:function(t){globalConfig=t}};export default MessageDialogFactory;export{selectorPrefix};
//# sourceMappingURL=messagedialog.js.map
