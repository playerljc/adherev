import{v1}from"uuid";import{createApp,h}from"vue";var prePopup,maskEl,selectorPrefix="adherev-ui-popup",el=null,Popup=function(){function t(t){this.id="",this.config=null,this.isShow=!1,this.el=null,this.popupEl=null,this.popupInnerEl=null,this.isShow=!1,this.el=PopupFactory.getEl(),this.id=v1(),this.config=t,this.onMaskElTransitionend=this.onMaskElTransitionend.bind(this),this.onInnerElTransitionend=this.onInnerElTransitionend.bind(this),this.render()}return t.prototype.createMask=function(){var t=this.config.zIndex;(maskEl=document.createElement("div")).className="".concat(selectorPrefix,"-mask"),maskEl.style.zIndex=String((t||11e3)-1500),null!==(t=null==this?void 0:this.el)&&void 0!==t&&t.appendChild(maskEl),maskEl.addEventListener("transitionend",this.onMaskElTransitionend)},t.prototype.render=function(){var t=this.config,e=t.children,t=t.zIndex,o=(this.popupEl=document.createElement("div"),this.popupEl.addEventListener("transitionend",this.onInnerElTransitionend),this.popupEl.className=selectorPrefix,this.popupEl.style.zIndex=String(t||11e3),this.popupInnerEl=document.createElement("div"),this.popupEl.appendChild(this.popupInnerEl),this);this.vm=createApp({mounted:function(){var t;null!==(t=null==o?void 0:o.el)&&void 0!==t&&t.appendChild(o.popupEl),o.trigger("onCreate")},render:function(){return h(e)}}).mount(this.popupInnerEl)},t.prototype.trigger=function(t){var e=this.config;if(e)return e[t]?e[t]():void 0},t.prototype.show=function(){var t=this;return maskEl||this.createMask(),prePopup&&prePopup.close(),maskEl.style.display="block",this.popupEl.style.display="block",this.isShow=!0,this.trigger("onBeforeShow"),setTimeout(function(){maskEl.classList.add("modal-in"),t.popupEl.classList.add("modal-in")},100),!0},t.prototype.close=function(){var t=this,e=(maskEl||this.createMask(),this.isShow=!1,this.trigger("onBeforeClose"));return e?e.then(function(){t.popupEl.classList.remove("modal-in"),maskEl.classList.remove("modal-in")}):(this.popupEl.classList.remove("modal-in"),maskEl.classList.remove("modal-in")),!0},t.prototype.destroy=function(){var e;try{this.vm.unmount()}catch(t){null!==(e=null===(e=this.popupEl)||void 0===e?void 0:e.parentNode)&&void 0!==e&&e.removeChild(this.popupEl)}return this.popupEl=null,this.trigger("onDestroy"),!0},t.prototype.isDestroy=function(){return!this.popupEl},t.prototype.getId=function(){return this.id},t.prototype.onInnerElTransitionend=function(){this.isShow?(prePopup=this).trigger("onAfterShow"):(prePopup=null,this.popupEl.style.display="none",this.trigger("onAfterClose"))},t.prototype.onMaskElTransitionend=function(){this.isShow||(maskEl.style.display="none")},t}(),PopupFactory={create:function(t){return new Popup(t)},show:function(t){return!!t&&(!t.isDestroy()&&(t!==prePopup&&((!prePopup||t.getId()!==prePopup.getId())&&t.show())))},close:function(t){return!!t&&(!t.isDestroy()&&t.close())},closeAll:function(){return!!prePopup&&this.close(prePopup)},destroy:function(t){return!!t&&(!t.isDestroy()&&t.destroy())},getEl:function(){return el||document.body},setEl:function(t){el=t}};export default PopupFactory;export{Popup};
//# sourceMappingURL=popup.js.map
