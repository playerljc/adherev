module.exports=function(n){var r={};function i(e){if(r[e])return r[e].exports;var t=r[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,i),t.l=!0,t.exports}return i.m=n,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/",i(i.s=4)}([function(e,t){e.exports=require("moment")},function(e,t){e.exports=require("classnames")},function(e,t){e.exports=require("@baifendian/adherev-util-intl")},function(e,t){e.exports=require("@baifendian/adherev-util-resource")},function(e,t,n){"use strict";n.r(t);function r(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var r=Array(e),i=0,t=0;t<n;t++)for(var s=arguments[t],l=0,a=s.length;l<a;l++,i++)r[i]=s[l];return r}var i,s,l=n(1),a=n.n(l),l=n(0),o=n.n(l),l=n(2),c=n.n(l),l=n(3),l=n.n(l),u="adherev-ui-pullrefresh",l={name:"adv-pullrefresh",props:{className:{type:String,default:""},scrollClassName:{type:String,default:""},pullHeight:{type:Number,default:200},isShowUpdateTime:{type:Boolean,default:!0},updateTime:{type:Number,default:o()().valueOf()},updateTimeFormat:{type:String,default:l.a.Dict.value.ResourceMomentFormatFull.value},loadingAnimation:{type:String,default:"la-ball-circus la-dark"}},data:function(){return{isCan:!1,_maskEl:null,_el:null,_iconEl:null,_scrollEl:null,_triggerInnerEl:null,_pullHeight:200,_refreshHeight:0,_startPageY:null,_isDownPull:!1,_isTop:!0}},computed:{getClassName:function(){var e=this.className;return a.a.apply(void 0,r([u],e.split(" ")))},getScrollClassName:function(){var e=this.scrollClassName;return a.a.apply(void 0,r([u+"-scroll"],e.split(" ")))}},methods:{renderIcon:function(e){var t=this.$slots;return t.icon?e("div",{class:u+"-trigger-icon"},[e("div",{class:u+"-trigger-icon-inner",ref:"iconElRef"},[t.icon])]):e("div",{class:u+"-trigger-icon"},[e("img",{class:u+"-trigger-icon-inner",attrs:{src:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+DQo8c3ZnIHN0eWxlPSJ3aWR0aDozMDhweDtoZWlnaHQ6MzA4cHg7IiB2ZXJzaW9uPSIxLjEiIGlkPSLlm77lvaIiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IiB3aWR0aD0iMTAyNHB4IiBoZWlnaHQ9IjEwMjRweCIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgMTAyNCAxMDI0IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCiAgPHBhdGggY2xhc3M9InN2Z3BhdGgiIGRhdGEtaW5kZXg9InBhdGhfMCIgZmlsbD0iI2VjZjBmMSIgZD0iTTc5Ny43NjQ0MiAzMjYuNTU4NDFjLTguODg0MTk5LTE1LjU2MzMyNy0yNTIuODgwMS0yODYuODE5MDE5LTI2OC4zNzk1MTItMzEzLjU2NzQ4OS0xMC4xMzA1NDQtMTcuNDQ4ODIzLTM0LjI1ODQ5NS0xNy4xOTMxNjItNDQuMzg5MDM4IDBDNDczLjY1MDkzOSAzMi4yNjEzMjQgMjMwLjk5NzI1NSAzMDQuNjM1NTMgMjE4LjM3NDAyMyAzMjcuNDIxMjY0Yy05LjIzNTczMiAxNi41NTQwMTEgMC45NTg3MjcgMzguMzgxMDE5IDIxLjk1NDgzNyAzOC4zODEwMTlsMTE5LjkwNDczMSAwIDAgMjU2LjQ5MTMwMyAwIDM2Ljc4MzE0MSAyOTEuODM2MzU0IDAgMC0yOTMuMzA2NDAyIDEyMy41Nzk4NDkgMEM3OTQuNjk2NDk1IDM2NS43NzAzMjUgODA4Ljk0OTU2MiAzNDYuMTE2NDMxIDc5Ny43NjQ0MiAzMjYuNTU4NDF6IiAvPg0KPHBhdGggY2xhc3M9InN2Z3BhdGgiIGRhdGEtaW5kZXg9InBhdGhfMSIgZmlsbD0iI2VjZjBmMSIgZD0iTTM2MC4yMDE2MzMgNjg5LjY5MjA2MWwyOTIuMzE1NzE4IDAgMCA5MC45MTkyMzItMjkyLjMxNTcxOCAwIDAtOTAuOTE5MjMyWiIgLz4NCjxwYXRoIGNsYXNzPSJzdmdwYXRoIiBkYXRhLWluZGV4PSJwYXRoXzIiIGZpbGw9IiNlY2YwZjEiIGQ9Ik0zNjAuMjAxNjMzIDg0MC45MTUxOTFsMjkyLjMxNTcxOCAwIDAgNjAuNTkxNTE2LTI5Mi4zMTU3MTggMCAwLTYwLjU5MTUxNloiIC8+DQo8cGF0aCBjbGFzcz0ic3ZncGF0aCIgZGF0YS1pbmRleD0icGF0aF8zIiBmaWxsPSIjZWNmMGYxIiBkPSJNMzYwLjIwMTYzMyA5OTIuMzkzOTgybDI5MC40MzAyMjIgMCAwIDMwLjI5NTc1OC0yOTAuNDMwMjIyIDAgMC0zMC4yOTU3NThaIiAvPg0KDQo8L3N2Zz4NCg==",alt:""},ref:"iconElRef"})])},renderLabel:function(e){var t=this.$slots,n=this.isCan;return e("p",{class:u+"-trigger-label"},[n?t.canLabel||e({template:"<span>"+c.a.tv("松开刷新")+"</span>"}):t.label||e({template:"<span>"+c.a.tv("下拉刷新")+"</span>"})])},renderUpdateTime:function(e){var t=this.isShowUpdateTime,n=this.updateTimeFormat,r=this.preUpdateTime;return t?e("p",{class:u+"-trigger-update"},[c.a.tv("更新时间"),"：",e("span",{class:u+"-trigger-update-label"},[o()(r).format(n)])]):null},renderLoadingAnimation:function(e){var t=this.$slots,n=this.loadingAnimation;return n?e("div",{class:a.a.apply(void 0,r([u+"-trigger-refresh"],(n||"").split(" "))),ref:"refreshElRef"},[e("div"),e("div"),e("div"),e("div"),e("div")]):e("div",{class:u+"-trigger-refresh",ref:"refreshElRef"},[t.loadingAnimation])},renderMask:function(){var e=this.$data;e._maskEl=document.querySelector("."+u+"-mask"),e._maskEl||(e._maskEl=document.createElement("div"),e._maskEl.className=u+"-mask",document.body.appendChild(e._maskEl))},getPullHeight:function(){var e=this.$data,t=this.pullHeight;return t<=0?200:t>e._scrollEl.clientHeight?e._scrollEl.clientHeight:t},addEvents:function(){var e=this.$data._scrollEl;e.addEventListener("touchstart",this.onTouchStart),e.addEventListener("mousedown",this.onTouchStart),e.addEventListener("scroll",this.onScroll)},removeEvents:function(){var e=this.$data._scrollEl;e.removeEventListener("mousemove",this.onTouchMove),e.removeEventListener("mouseup",this.onTouchEnd),e.removeEventListener("touchmove",this.onTouchMove),e.removeEventListener("touchend",this.onTouchEnd)},onTouchStart:function(e){var t=this.$data;this.trigger("pull-start"),t._startPageY=(e.changedTouches?e.changedTouches[0]:e).pageY;t=t._scrollEl;t.addEventListener("touchmove",this.onTouchMove),t.addEventListener("mousemove",this.onTouchMove),t.addEventListener("touchend",this.onTouchEnd),t.addEventListener("mouseup",this.onTouchEnd)},onTouchMove:function(e){var t=this.$data,n=t._scrollEl,r=t._el,i=t._startPageY,s=t._refreshHeight,l=t._iconEl,a=t._pullHeight;n.style.overflow="hidden";var o=(e.changedTouches?e.changedTouches[0]:e).pageY-i,i=Math.abs(o);0<o?(e.preventDefault(),t._isDownPull=!0,i<t._pullHeight?(this.translateY(n,i+"px",0),this.translateY(r,"calc(-100% + "+i+"px)",0),s+80<=i?(console.log("3.具备刷新条件"),this.rotateIcon(l,0,150),this.isCan=!0,this.trigger("pull-can-refresh")):(this.rotateIcon(l,180,150),this.isCan=!1),r.style.display="flex"):(this.translateY(n,a+"px",0),this.translateY(r,"calc(-100% + "+a+"px)",0),this.rotateIcon(l,0,150),console.log("4.拉动到了底部"),this.isCan=!0,this.trigger("pull-bottom"))):t._isDownPull?(e.preventDefault(),this.translateY(n,"0px",0),this.translateY(r,"calc(-100% + 0px)",0),this.rotateIcon(l,180,0)):this.clear()},onTouchEnd:function(e){var t=this.$data,n=t._startPageY,r=t._pullHeight,t=t._refreshHeight,e=(e.changedTouches?e.changedTouches[0]:e).pageY-n,n=Math.abs(e);0<e?!(n<r)||t+80<=n?this.refresh():(console.log("2.没有具备刷新条件弹回"),this.trigger("pull-rebound"),this.reset()):this.clear()},onScroll:function(e){var t=this.$data,n=t._scrollEl;0===e.target.scrollTop?(t._isTop=!0,n.addEventListener("touchstart",this.onTouchStart),n.addEventListener("mousedown",this.onTouchStart)):t._isTop&&(t._isTop=!1,self.scrollEl.removeEventListener("touchstart",this.onTouchStart),self.scrollEl.removeEventListener("mousedown",this.onTouchStart))},translateY:function(e,t,n){e.style.transition=e.style.webkitTransition="transform "+(n=void 0===n?0:n)+"ms ease",e.style.transform=e.style.webkitTransform="translate3d(0,"+t+",0)"},rotateIcon:function(e,t,n){e.style.transition=e.style.webkitTransition="transform "+(n=void 0===n?0:n)+"ms linear",e.style.transform=e.style.webkitTransform="rotate("+t+"deg)"},trigger:function(e,t){this.$emit(e,t)},clear:function(){var e;this.removeEvents();var t=this.$data;t._isDownPull=!1,t._isTop=!0,t._el.style.display="flex",this.$refs.refreshElRef.style.display="none",null===(e=t._triggerInnerEl)||void 0===e||(e.style.display="flex"),this.rotateIcon(t._iconEl,180,0),t._scrollEl.style.overflowY="auto",t._maskEl.style.display="none"},refresh:function(){var t=this,e=this.$data,n=e._maskEl,r=e._scrollEl,i=e._el,s=e._iconEl,l=e._refreshHeight,a=e._triggerInnerEl;n.style.display="block",this.removeEvents(),r.addEventListener("transitionend",function e(){a.style.display="none",t.$refs.refreshElRef.style.display="block",t.trigger("pull-refresh",t),r.removeEventListener("transitionend",e),t.preUpdateTime=o()().valueOf()}),this.translateY(r,l+"px",500),this.translateY(i,"calc(-100% + "+l+"px)",500),this.rotateIcon(s,180,300)},reset:function(){var e=this.$data,t=e._scrollEl,n=e._triggerInnerEl,e=e._el;this.clear(),t.addEventListener("transitionend",function e(){t.removeEventListener("transitionend",e),null==n||(n.style.display="flex")}),this.translateY(t,"0px",200),this.translateY(e,"calc(-100% + 0px)",200)},resetUpdateTime:function(t){var n=this;return new Promise(function(e){n.preUpdateTime=t||o()().valueOf(),e()})},getUpdateTime:function(){return this.preUpdateTime}},created:function(){this.renderMask()},mounted:function(){var e=this.$data,t=this.$refs;e._el=t.elRef,e._iconEl=t.iconElRef,e._scrollEl=t.scrollElRef,e._triggerInnerEl=t.triggerInnerElRef,e._pullHeight=this.getPullHeight(),e._refreshHeight=e._el.clientHeight,this.addEvents()},render:function(e){var t=this.$slots;return e("div",{class:this.getClassName},[e("div",{class:this.getScrollClassName,ref:"scrollElRef"},[t.default]),e("div",{class:u+"-trigger",ref:"elRef"},[e("div",{class:u+"-trigger-inner",ref:"triggerInnerElRef"},[this.renderIcon(e),this.renderLabel(e),this.renderUpdateTime(e)]),this.renderLoadingAnimation(e)])])}},d=((s=i=l).install=function(e){e.component(s.displayName||s.name,i)},i);d.isUse=function(){return!0},d.use=function(e){return e.use(d)},t.default=d}]).default;
//# sourceMappingURL=index.js.map
