{"version":3,"file":"writingboard.js","sources":["writingboard.js"],"sourcesContent":["\"use strict\";\n\nvar _vue = require(\"vue\");\nrequire(\"core-js/modules/es.object.define-property.js\");\nrequire(\"core-js/modules/es.array.iterator.js\");\nrequire(\"core-js/modules/es.map.js\");\nrequire(\"core-js/modules/es.object.to-string.js\");\nrequire(\"core-js/modules/es.string.iterator.js\");\nrequire(\"core-js/modules/esnext.map.delete-all.js\");\nrequire(\"core-js/modules/esnext.map.every.js\");\nrequire(\"core-js/modules/esnext.map.filter.js\");\nrequire(\"core-js/modules/esnext.map.find.js\");\nrequire(\"core-js/modules/esnext.map.find-key.js\");\nrequire(\"core-js/modules/esnext.map.includes.js\");\nrequire(\"core-js/modules/esnext.map.key-of.js\");\nrequire(\"core-js/modules/esnext.map.map-keys.js\");\nrequire(\"core-js/modules/esnext.map.map-values.js\");\nrequire(\"core-js/modules/esnext.map.merge.js\");\nrequire(\"core-js/modules/esnext.map.reduce.js\");\nrequire(\"core-js/modules/esnext.map.some.js\");\nrequire(\"core-js/modules/esnext.map.update.js\");\nrequire(\"core-js/modules/web.dom-collections.iterator.js\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar tslib_1 = require(\"tslib\");\nvar debounce_1 = tslib_1.__importDefault(require(\"lodash/debounce\"));\nvar vue_1 = require(\"vue\");\nvar vue_types_1 = require(\"vue-types\");\nvar adherev_util_1 = tslib_1.__importDefault(require(\"@baifendian/adherev-util\"));\n// @ts-ignore\nvar resize_observer_1 = require(\"@juggle/resize-observer\");\nvar types_1 = require(\"./types\");\nvar selectorPrefix = 'adherev-ui-writingboard';\nvar props = {\n  defaultMode: (0, vue_types_1.string)().def(types_1.Mode.FREE),\n  defaultStrokeStyle: (0, vue_types_1.string)().def('#000'),\n  defaultLineWidth: (0, vue_types_1.number)().def(2),\n  resizeTime: (0, vue_types_1.number)().def(300)\n};\nexports.default = (0, vue_1.defineComponent)({\n  name: 'adv-writingboard',\n  props: props,\n  setup: function setup(props, _a) {\n    var expose = _a.expose;\n    var containerRef = (0, vue_1.ref)();\n    var canvasRef = (0, vue_1.ref)();\n    var ctx = null;\n    var ro = null;\n    var startPoint = null;\n    var prePoint = null;\n    var curShape = props.defaultMode;\n    var lineWidth = props.defaultLineWidth;\n    var strokeStyle = props.defaultStrokeStyle;\n    var stack = [];\n    var stackIndex = 0;\n    var config = new Map([\n    // 自由模式\n    [types_1.Mode.FREE, {\n      draw: function draw(_a) {\n        var sourcePoint = _a.sourcePoint,\n          targetPoint = _a.targetPoint;\n        ctx === null || ctx === void 0 ? void 0 : ctx.beginPath();\n        ctx === null || ctx === void 0 ? void 0 : ctx.moveTo(sourcePoint.x, sourcePoint.y);\n        ctx === null || ctx === void 0 ? void 0 : ctx.lineTo(targetPoint.x, targetPoint.y);\n        stack.push({\n          shape: curShape,\n          sourcePoint: sourcePoint,\n          targetPoint: targetPoint\n        });\n        style({\n          lineWidth: lineWidth,\n          strokeStyle: strokeStyle\n        });\n        // 描边\n        ctx === null || ctx === void 0 ? void 0 : ctx.stroke();\n      },\n      drawStack: function drawStack(item) {\n        ctx === null || ctx === void 0 ? void 0 : ctx.beginPath();\n        ctx === null || ctx === void 0 ? void 0 : ctx.moveTo(item.sourcePoint.x, item.sourcePoint.y);\n        ctx === null || ctx === void 0 ? void 0 : ctx.lineTo(item.targetPoint.x, item.targetPoint.y);\n        style({\n          lineWidth: item.lineWidth,\n          strokeStyle: item.strokeStyle\n        });\n        ctx === null || ctx === void 0 ? void 0 : ctx.stroke();\n      },\n      mouseup: function mouseup(point) {\n        draw({\n          sourcePoint: prePoint,\n          targetPoint: point\n        });\n      }\n    }],\n    // 直线\n    [types_1.Mode.LINE, {\n      draw: function draw(_a) {\n        var _b, _c;\n        var targetPoint = _a.targetPoint;\n        // 清除画布\n        ctx === null || ctx === void 0 ? void 0 : ctx.clearRect(0, 0, (_b = canvasRef.value) === null || _b === void 0 ? void 0 : _b.width, (_c = canvasRef.value) === null || _c === void 0 ? void 0 : _c.height);\n        drawStack();\n        ctx === null || ctx === void 0 ? void 0 : ctx.beginPath();\n        ctx === null || ctx === void 0 ? void 0 : ctx.moveTo(startPoint.x, startPoint.y);\n        ctx === null || ctx === void 0 ? void 0 : ctx.lineTo(targetPoint.x, targetPoint.y);\n        style({\n          lineWidth: lineWidth,\n          strokeStyle: strokeStyle\n        });\n        // 描边\n        ctx === null || ctx === void 0 ? void 0 : ctx.stroke();\n      },\n      drawStack: function drawStack(item) {\n        ctx === null || ctx === void 0 ? void 0 : ctx.beginPath();\n        ctx === null || ctx === void 0 ? void 0 : ctx.moveTo(item.sourcePoint.x, item.sourcePoint.y);\n        ctx === null || ctx === void 0 ? void 0 : ctx.lineTo(item.targetPoint.x, item.targetPoint.y);\n        style({\n          lineWidth: item.lineWidth,\n          strokeStyle: item.strokeStyle\n        });\n        ctx === null || ctx === void 0 ? void 0 : ctx.stroke();\n      },\n      mouseup: function mouseup(point) {\n        stack.push({\n          shape: curShape,\n          lineWidth: ctx === null || ctx === void 0 ? void 0 : ctx.lineWidth,\n          strokeStyle: ctx === null || ctx === void 0 ? void 0 : ctx.strokeStyle,\n          sourcePoint: startPoint,\n          targetPoint: point\n        });\n      }\n    }],\n    // 矩形\n    [types_1.Mode.RECTANGLE, {\n      draw: function draw(_a) {\n        var _b, _c;\n        var targetPoint = _a.targetPoint;\n        // 清除画布\n        ctx === null || ctx === void 0 ? void 0 : ctx.clearRect(0, 0, (_b = canvasRef.value) === null || _b === void 0 ? void 0 : _b.width, (_c = canvasRef.value) === null || _c === void 0 ? void 0 : _c.height);\n        drawStack();\n        ctx === null || ctx === void 0 ? void 0 : ctx.beginPath();\n        // 判断target在start的四个方向\n        var rectStart = getPoint({\n          startPoint: startPoint,\n          targetPoint: targetPoint\n        });\n        ctx === null || ctx === void 0 ? void 0 : ctx.rect(rectStart.x, rectStart.y, Math.abs(targetPoint.x - startPoint.x), Math.abs(targetPoint.y - startPoint.y));\n        style({\n          lineWidth: lineWidth,\n          strokeStyle: strokeStyle\n        });\n        // 描边\n        ctx === null || ctx === void 0 ? void 0 : ctx.stroke();\n      },\n      drawStack: function drawStack(item) {\n        ctx === null || ctx === void 0 ? void 0 : ctx.beginPath();\n        ctx === null || ctx === void 0 ? void 0 : ctx.rect(item.x, item.y, item.width, item.height);\n        style({\n          lineWidth: item.lineWidth,\n          strokeStyle: item.strokeStyle\n        });\n        ctx === null || ctx === void 0 ? void 0 : ctx.stroke();\n      },\n      mouseup: function mouseup(point) {\n        var rectStart = getPoint({\n          startPoint: startPoint,\n          targetPoint: point\n        });\n        stack.push({\n          shape: curShape,\n          lineWidth: ctx === null || ctx === void 0 ? void 0 : ctx.lineWidth,\n          strokeStyle: ctx === null || ctx === void 0 ? void 0 : ctx.strokeStyle,\n          x: rectStart.x,\n          y: rectStart.y,\n          width: Math.abs(point.x - (startPoint === null || startPoint === void 0 ? void 0 : startPoint.x)),\n          height: Math.abs(point.y - (startPoint === null || startPoint === void 0 ? void 0 : startPoint.y))\n        });\n      }\n    }],\n    // 圆形\n    [types_1.Mode.CIRCLE, {\n      draw: function draw(_a) {\n        var _b, _c;\n        var targetPoint = _a.targetPoint;\n        // 清除画布\n        ctx === null || ctx === void 0 ? void 0 : ctx.clearRect(0, 0, (_b = canvasRef.value) === null || _b === void 0 ? void 0 : _b.width, (_c = canvasRef.value) === null || _c === void 0 ? void 0 : _c.height);\n        drawStack();\n        ctx === null || ctx === void 0 ? void 0 : ctx.beginPath();\n        // 判断target在start的四个方向\n        var rectStart = getPoint({\n          startPoint: startPoint,\n          targetPoint: targetPoint\n        });\n        var radius = getDistanceByBetweenPoint({\n          p2: targetPoint,\n          p1: startPoint\n        });\n        ctx === null || ctx === void 0 ? void 0 : ctx.ellipse(rectStart.x, rectStart.y, radius, radius, 45 * Math.PI / 180, 0, 2 * Math.PI);\n        style({\n          lineWidth: lineWidth,\n          strokeStyle: strokeStyle\n        });\n        // 描边\n        ctx === null || ctx === void 0 ? void 0 : ctx.stroke();\n      },\n      drawStack: function drawStack(item) {\n        ctx === null || ctx === void 0 ? void 0 : ctx.beginPath();\n        ctx === null || ctx === void 0 ? void 0 : ctx.ellipse(item.x, item.y, item.radiusX, item.radiusY, item.rotation, item.startAngle, item.endAngle);\n        style({\n          lineWidth: item.lineWidth,\n          strokeStyle: item.strokeStyle\n        });\n        ctx === null || ctx === void 0 ? void 0 : ctx.stroke();\n      },\n      mouseup: function mouseup(point) {\n        var center = getPoint({\n          startPoint: startPoint,\n          targetPoint: point\n        });\n        var radius = getDistanceByBetweenPoint({\n          p2: point,\n          p1: startPoint\n        });\n        stack.push({\n          shape: curShape,\n          lineWidth: ctx === null || ctx === void 0 ? void 0 : ctx.lineWidth,\n          strokeStyle: ctx === null || ctx === void 0 ? void 0 : ctx.strokeStyle,\n          x: center.x,\n          y: center.y,\n          radiusX: radius,\n          radiusY: radius,\n          rotation: 45 * Math.PI / 180,\n          startAngle: 0,\n          endAngle: 2 * Math.PI\n        });\n      }\n    }],\n    // 三角形(多边形)\n    [types_1.Mode.TRIANGLE, {\n      draw: function draw(_a) {\n        var _b, _c;\n        var targetPoint = _a.targetPoint;\n        // 清除画布\n        ctx === null || ctx === void 0 ? void 0 : ctx.clearRect(0, 0, (_b = canvasRef.value) === null || _b === void 0 ? void 0 : _b.width, (_c = canvasRef.value) === null || _c === void 0 ? void 0 : _c.height);\n        drawStack();\n        ctx === null || ctx === void 0 ? void 0 : ctx.beginPath();\n        var points = triangle({\n          startPoint: startPoint,\n          targetPoint: targetPoint\n        });\n        ctx === null || ctx === void 0 ? void 0 : ctx.moveTo(points[0].x, points[0].y);\n        ctx === null || ctx === void 0 ? void 0 : ctx.lineTo(points[1].x, points[1].y);\n        ctx === null || ctx === void 0 ? void 0 : ctx.lineTo(points[2].x, points[2].y);\n        ctx === null || ctx === void 0 ? void 0 : ctx.closePath();\n        style({\n          lineWidth: lineWidth,\n          strokeStyle: strokeStyle\n        });\n        // 描边\n        ctx === null || ctx === void 0 ? void 0 : ctx.stroke();\n      },\n      drawStack: function drawStack(item) {\n        ctx === null || ctx === void 0 ? void 0 : ctx.beginPath();\n        ctx === null || ctx === void 0 ? void 0 : ctx.moveTo(item.points[0].x, item.points[0].y);\n        ctx === null || ctx === void 0 ? void 0 : ctx.lineTo(item.points[1].x, item.points[1].y);\n        ctx === null || ctx === void 0 ? void 0 : ctx.lineTo(item.points[2].x, item.points[2].y);\n        ctx === null || ctx === void 0 ? void 0 : ctx.closePath();\n        style({\n          lineWidth: item.lineWidth,\n          strokeStyle: item.strokeStyle\n        });\n        ctx === null || ctx === void 0 ? void 0 : ctx.stroke();\n      },\n      mouseup: function mouseup(point) {\n        var points = triangle({\n          startPoint: startPoint,\n          targetPoint: point\n        });\n        stack.push({\n          shape: curShape,\n          lineWidth: ctx === null || ctx === void 0 ? void 0 : ctx.lineWidth,\n          strokeStyle: ctx === null || ctx === void 0 ? void 0 : ctx.strokeStyle,\n          points: points\n        });\n      }\n    }],\n    // 橡皮\n    [types_1.Mode.RUBBER, {\n      draw: function draw(_a) {\n        var sourcePoint = _a.sourcePoint,\n          targetPoint = _a.targetPoint;\n        ctx === null || ctx === void 0 ? void 0 : ctx.beginPath();\n        ctx === null || ctx === void 0 ? void 0 : ctx.moveTo(sourcePoint.x, sourcePoint.y);\n        ctx === null || ctx === void 0 ? void 0 : ctx.lineTo(targetPoint.x, targetPoint.y);\n        stack.push({\n          shape: curShape,\n          sourcePoint: sourcePoint,\n          targetPoint: targetPoint\n        });\n        ctx.lineWidth = 15;\n        ctx.strokeStyle = '#fff';\n        ctx.lineCap = 'round';\n        ctx.lineJoin = 'round';\n        ctx === null || ctx === void 0 ? void 0 : ctx.stroke();\n      },\n      drawStack: function drawStack(item) {\n        ctx === null || ctx === void 0 ? void 0 : ctx.beginPath();\n        ctx === null || ctx === void 0 ? void 0 : ctx.moveTo(item.sourcePoint.x, item.sourcePoint.y);\n        ctx === null || ctx === void 0 ? void 0 : ctx.lineTo(item.targetPoint.x, item.targetPoint.y);\n        ctx.lineWidth = 15;\n        ctx.strokeStyle = '#fff';\n        ctx.lineCap = 'round';\n        ctx.lineJoin = 'round';\n        ctx === null || ctx === void 0 ? void 0 : ctx.stroke();\n      },\n      mouseup: function mouseup(point) {\n        draw({\n          sourcePoint: prePoint,\n          targetPoint: point\n        });\n      }\n    }]]);\n    /**\n     * style\n     * @param lineWidth\n     * @param strokeStyle\n     */\n    function style(_a) {\n      var lineWidth = _a.lineWidth,\n        strokeStyle = _a.strokeStyle;\n      ctx.lineWidth = lineWidth;\n      ctx.strokeStyle = strokeStyle;\n      ctx.lineCap = 'round';\n      ctx.lineJoin = 'round';\n    }\n    /**\n     * triangle - 获取三角形的三个点坐标\n     * @param startPoint\n     * @param targetPoint\n     */\n    function triangle(_a) {\n      var startPoint = _a.startPoint,\n        targetPoint = _a.targetPoint;\n      var s = getPoint({\n        startPoint: startPoint,\n        targetPoint: targetPoint\n      });\n      var w = Math.abs(targetPoint.x - startPoint.x);\n      var h = Math.abs(targetPoint.y - startPoint.y);\n      var point1 = {\n        x: s.x,\n        y: s.y + h\n      };\n      var point2 = {\n        x: s.x + w / 2,\n        y: s.y\n      };\n      var point3 = {\n        x: s.x + w,\n        y: s.y + h\n      };\n      return [point1, point2, point3];\n    }\n    /**\n     * devicePointToCanvasPoint\n     * @param clientX\n     * @param clientY\n     */\n    function devicePointToCanvasPoint(_a) {\n      var _b;\n      var clientX = _a.clientX,\n        clientY = _a.clientY;\n      var _c = (_b = canvasRef === null || canvasRef === void 0 ? void 0 : canvasRef.value) === null || _b === void 0 ? void 0 : _b.getBoundingClientRect(),\n        x = _c.x,\n        y = _c.y;\n      return {\n        x: clientX - x,\n        y: clientY - y\n      };\n    }\n    /**\n     * getDistanceByBetweenPoint\n     * @description 获取p1,p2两点间的距离\n     * @param p1\n     * @param p2\n     */\n    function getDistanceByBetweenPoint(_a) {\n      var p1 = _a.p1,\n        p2 = _a.p2;\n      var Ax1 = p1.x,\n        Ay1 = p1.y;\n      var Ax2 = p2.x,\n        Ay2 = p2.y;\n      return Math.sqrt(Math.pow(Ax2 - Ax1, 2) + Math.pow(Ay2 - Ay1, 2)); // 计算A1A2的长度\n    }\n    /**\n     * drawStack\n     */\n    function drawStack() {\n      for (var i = 0; i < stack.length; i++) {\n        var item = stack[i];\n        config.get(item.shape).drawStack(item);\n      }\n    }\n    /**\n     * getPoint\n     * @param startPoint\n     * @param targetPoint\n     */\n    function getPoint(_a) {\n      var startPoint = _a.startPoint,\n        targetPoint = _a.targetPoint;\n      if (targetPoint.x <= startPoint.x && targetPoint.y <= startPoint.y) {\n        // leftTop\n        return targetPoint;\n      } else if (targetPoint.x <= startPoint.x && targetPoint.y >= startPoint.y) {\n        // leftBottom\n        return {\n          x: targetPoint.x,\n          y: startPoint.y\n        };\n      } else if (targetPoint.x >= startPoint.x && targetPoint.y <= startPoint.y) {\n        // rightTop\n        return {\n          x: startPoint.x,\n          y: targetPoint.y\n        };\n      } else if (targetPoint.x >= startPoint.x && targetPoint.y >= startPoint.y) {\n        // rightBottom\n        return startPoint;\n      }\n    }\n    /**\n     * draw\n     * @param sourcePoint\n     * @param targetPoint\n     */\n    function draw(_a) {\n      var sourcePoint = _a.sourcePoint,\n        targetPoint = _a.targetPoint;\n      var entry = config === null || config === void 0 ? void 0 : config.get(curShape);\n      entry.draw({\n        sourcePoint: sourcePoint,\n        targetPoint: targetPoint\n      });\n    }\n    // 注册事件\n    function onMousemove(e) {\n      move(e);\n    }\n    function onTouchmove(e) {\n      move(tslib_1.__assign(tslib_1.__assign({}, e), {\n        clientX: e.targetTouches[0].clientX,\n        clientY: e.targetTouches[0].clientY\n      }));\n    }\n    function onMouseup(e) {\n      end(e);\n    }\n    function onTouchend(e) {\n      end(tslib_1.__assign(tslib_1.__assign({}, e), {\n        clientX: e.changedTouches[0].clientX,\n        clientY: e.changedTouches[0].clientY\n      }));\n    }\n    function onMousedown(e) {\n      start(e);\n    }\n    function onTouchstart(e) {\n      start(tslib_1.__assign(tslib_1.__assign({}, e), {\n        clientX: e.targetTouches[0].clientX,\n        clientY: e.targetTouches[0].clientY\n      }));\n    }\n    /**\n     * start\n     * @param e\n     */\n    function start(e) {\n      var _a, _b, _c, _d;\n      // 屏幕坐标转换成canvas坐标\n      var clientX = e.clientX,\n        clientY = e.clientY;\n      startPoint = prePoint = devicePointToCanvasPoint({\n        clientX: clientX,\n        clientY: clientY\n      });\n      (_a = containerRef === null || containerRef === void 0 ? void 0 : containerRef.value) === null || _a === void 0 ? void 0 : _a.addEventListener('mousemove', onMousemove);\n      (_b = containerRef === null || containerRef === void 0 ? void 0 : containerRef.value) === null || _b === void 0 ? void 0 : _b.addEventListener('mouseup', onMouseup);\n      (_c = containerRef === null || containerRef === void 0 ? void 0 : containerRef.value) === null || _c === void 0 ? void 0 : _c.addEventListener('touchmove', onTouchmove);\n      (_d = containerRef === null || containerRef === void 0 ? void 0 : containerRef.value) === null || _d === void 0 ? void 0 : _d.addEventListener('touchend', onTouchend);\n    }\n    /**\n     * move\n     * @param e\n     */\n    function move(e) {\n      var clientX = e.clientX,\n        clientY = e.clientY;\n      var point = devicePointToCanvasPoint({\n        clientX: clientX,\n        clientY: clientY\n      });\n      draw({\n        sourcePoint: prePoint,\n        targetPoint: point\n      });\n      prePoint = point;\n    }\n    /**\n     * end\n     * @param e\n     */\n    function end(e) {\n      var _a, _b, _c, _d, _e;\n      var clientX = e.clientX,\n        clientY = e.clientY;\n      var point = devicePointToCanvasPoint({\n        clientX: clientX,\n        clientY: clientY\n      });\n      (_a = config.get(curShape)) === null || _a === void 0 ? void 0 : _a.mouseup(point);\n      startPoint = null;\n      prePoint = null;\n      (_b = containerRef === null || containerRef === void 0 ? void 0 : containerRef.value) === null || _b === void 0 ? void 0 : _b.removeEventListener('mousemove', onMousemove);\n      (_c = containerRef === null || containerRef === void 0 ? void 0 : containerRef.value) === null || _c === void 0 ? void 0 : _c.removeEventListener('mouseup', onMouseup);\n      (_d = containerRef === null || containerRef === void 0 ? void 0 : containerRef.value) === null || _d === void 0 ? void 0 : _d.removeEventListener('touchmove', onTouchmove);\n      (_e = containerRef === null || containerRef === void 0 ? void 0 : containerRef.value) === null || _e === void 0 ? void 0 : _e.removeEventListener('touchend', onTouchend);\n    }\n    /**\n     * clear\n     */\n    function clear() {\n      var _a, _b;\n      ctx === null || ctx === void 0 ? void 0 : ctx.clearRect(0, 0, (_a = canvasRef === null || canvasRef === void 0 ? void 0 : canvasRef.value) === null || _a === void 0 ? void 0 : _a.width, (_b = canvasRef === null || canvasRef === void 0 ? void 0 : canvasRef.value) === null || _b === void 0 ? void 0 : _b.height);\n      prePoint = startPoint = null;\n      stack = [];\n      stackIndex = 0;\n    }\n    /**\n     * toDataURL\n     * @default canvas导出base64\n     * @param backgroundColor\n     * @param type\n     * @param quality\n     */\n    function toDataURL(backgroundColor, type, quality) {\n      var _a, _b, _c, _d, _e, _f, _g;\n      if (backgroundColor) {\n        var _h = adherev_util_1.default.colorToRgb(backgroundColor),\n          R = _h[0],\n          G = _h[1],\n          B = _h[2];\n        var fillsIndex = [];\n        // 先设置背景\n        var imageData_1 = ctx === null || ctx === void 0 ? void 0 : ctx.getImageData(0, 0, (_a = canvasRef === null || canvasRef === void 0 ? void 0 : canvasRef.value) === null || _a === void 0 ? void 0 : _a.width, (_b = canvasRef === null || canvasRef === void 0 ? void 0 : canvasRef.value) === null || _b === void 0 ? void 0 : _b.height);\n        for (var i = 0; i < ((_c = imageData_1 === null || imageData_1 === void 0 ? void 0 : imageData_1.data) === null || _c === void 0 ? void 0 : _c.length); i += 4) {\n          // 当该像素是透明的，则设置成backgroundColor\n          if (imageData_1.data[i + 3] === 0) {\n            imageData_1.data[i] = R; // R\n            imageData_1.data[i + 1] = G; // G\n            imageData_1.data[i + 2] = B; // B\n            imageData_1.data[i + 3] = 255;\n            fillsIndex.push(i);\n            fillsIndex.push(i + 1);\n            fillsIndex.push(i + 2);\n            fillsIndex.push(i + 3);\n          }\n        }\n        ctx === null || ctx === void 0 ? void 0 : ctx.putImageData(imageData_1, 0, 0);\n        // 生成base64字符串\n        var base64 = (_d = canvasRef === null || canvasRef === void 0 ? void 0 : canvasRef.value) === null || _d === void 0 ? void 0 : _d.toDataURL(type || 'image/png', quality);\n        // 删除背景\n        imageData_1 = ctx === null || ctx === void 0 ? void 0 : ctx.getImageData(0, 0, (_e = canvasRef === null || canvasRef === void 0 ? void 0 : canvasRef.value) === null || _e === void 0 ? void 0 : _e.width, (_f = canvasRef === null || canvasRef === void 0 ? void 0 : canvasRef.value) === null || _f === void 0 ? void 0 : _f.height);\n        fillsIndex.forEach(function (index) {\n          imageData_1.data[index] = 0;\n        });\n        ctx === null || ctx === void 0 ? void 0 : ctx.putImageData(imageData_1, 0, 0);\n        return base64;\n      }\n      return (_g = canvasRef === null || canvasRef === void 0 ? void 0 : canvasRef.value) === null || _g === void 0 ? void 0 : _g.toDataURL(type || 'image/png', quality);\n    }\n    expose({\n      setMode: function setMode(mode) {\n        curShape = mode;\n      },\n      setStrokeStyle: function setStrokeStyle(style) {\n        strokeStyle = style;\n      },\n      setLineWidth: function setLineWidth(width) {\n        lineWidth = width;\n      },\n      /**\n       * clear\n       * @description 清除画布\n       */\n      clear: clear,\n      /**\n       * toDataURL\n       * @description 获取base64\n       */\n      toDataURL: toDataURL\n    });\n    (0, vue_1.onMounted)(function () {\n      var _a, _b;\n      ctx = (_a = canvasRef === null || canvasRef === void 0 ? void 0 : canvasRef.value) === null || _a === void 0 ? void 0 : _a.getContext('2d');\n      var onResize = (0, debounce_1.default)(function () {\n        var _a, _b, _c, _d;\n        canvasRef.value.width = (_a = containerRef === null || containerRef === void 0 ? void 0 : containerRef.value) === null || _a === void 0 ? void 0 : _a.offsetWidth;\n        canvasRef.value.height = (_b = containerRef === null || containerRef === void 0 ? void 0 : containerRef.value) === null || _b === void 0 ? void 0 : _b.offsetHeight;\n        ctx === null || ctx === void 0 ? void 0 : ctx.clearRect(0, 0, (_c = canvasRef === null || canvasRef === void 0 ? void 0 : canvasRef.value) === null || _c === void 0 ? void 0 : _c.width, (_d = canvasRef === null || canvasRef === void 0 ? void 0 : canvasRef.value) === null || _d === void 0 ? void 0 : _d.height);\n        drawStack();\n      }, props.resizeTime);\n      ro = new resize_observer_1.ResizeObserver(onResize);\n      (_b = ro === null || ro === void 0 ? void 0 : ro.observe) === null || _b === void 0 ? void 0 : _b.call(ro, document.body);\n    });\n    (0, vue_1.onMounted)(function () {\n      var _a, _b;\n      (_a = containerRef === null || containerRef === void 0 ? void 0 : containerRef.value) === null || _a === void 0 ? void 0 : _a.addEventListener('mousedown', onMousedown);\n      (_b = containerRef === null || containerRef === void 0 ? void 0 : containerRef.value) === null || _b === void 0 ? void 0 : _b.addEventListener('touchstart', onTouchstart);\n    });\n    (0, vue_1.onBeforeUnmount)(function () {\n      var _a, _b;\n      ro === null || ro === void 0 ? void 0 : ro.disconnect();\n      (_a = containerRef === null || containerRef === void 0 ? void 0 : containerRef.value) === null || _a === void 0 ? void 0 : _a.removeEventListener('mousedown', onMousedown);\n      (_b = containerRef === null || containerRef === void 0 ? void 0 : containerRef.value) === null || _b === void 0 ? void 0 : _b.removeEventListener('touchstart', onTouchstart);\n    });\n    return function () {\n      return (0, _vue.createVNode)(\"div\", {\n        \"ref\": containerRef,\n        \"class\": selectorPrefix\n      }, [(0, _vue.createVNode)(\"canvas\", {\n        \"ref\": canvasRef\n      }, null)]);\n    };\n  }\n});"],"names":["_vue","require","tslib_1","Object","defineProperty","exports","value","debounce_1","__importDefault","vue_1","vue_types_1","adherev_util_1","resize_observer_1","types_1","selectorPrefix","props","defaultMode","string","def","Mode","FREE","defaultStrokeStyle","defaultLineWidth","number","resizeTime","default","defineComponent","name","setup","_a","expose","containerRef","ref","canvasRef","ctx","ro","startPoint","prePoint","curShape","lineWidth","strokeStyle","stack","config","Map","draw","sourcePoint","targetPoint","beginPath","moveTo","x","y","lineTo","push","shape","style","stroke","drawStack","item","mouseup","point","LINE","_c","clearRect","_b","width","height","RECTANGLE","rectStart","getPoint","rect","Math","abs","CIRCLE","radius","getDistanceByBetweenPoint","p2","p1","ellipse","PI","radiusX","radiusY","rotation","startAngle","endAngle","center","TRIANGLE","points","triangle","closePath","RUBBER","lineCap","lineJoin","s","w","h","devicePointToCanvasPoint","clientX","clientY","getBoundingClientRect","Ax1","Ay1","Ax2","Ay2","sqrt","pow","i","length","get","onMousemove","e","move","onTouchmove","__assign","targetTouches","onMouseup","end","onTouchend","changedTouches","onMousedown","start","onTouchstart","addEventListener","_d","removeEventListener","_e","setMode","mode","setStrokeStyle","setLineWidth","clear","toDataURL","backgroundColor","type","quality","_g","_h","colorToRgb","R","G","B","fillsIndex","imageData_1","getImageData","data","putImageData","base64","_f","forEach","index","onMounted","getContext","onResize","offsetWidth","offsetHeight","ResizeObserver","observe","call","document","body","onBeforeUnmount","disconnect","createVNode","class"],"mappings":"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"}