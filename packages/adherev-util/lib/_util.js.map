{"version":3,"file":"_util.js","sources":["_util.js"],"sourcesContent":["\"use strict\";\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __rest = (this && this.__rest) || function (s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n};\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.getComponentPropsOption = exports.HOC = exports.HOCFunctional = exports.Fragment = exports.extend = exports.withVue = exports.withInstall = void 0;\r\nvar lodash_merge_1 = __importDefault(require(\"lodash.merge\"));\r\nvar lodash_mergewith_1 = __importDefault(require(\"lodash.mergewith\"));\r\nvar adherev_util_watchmemoized_1 = __importDefault(require(\"@baifendian/adherev-util-watchmemoized\"));\r\nvar memoized = adherev_util_watchmemoized_1.default.memoized;\r\n/**\r\n * withInstall\r\n * @description Vue组件的插件方法\r\n * @param comp\r\n * @return comp\r\n */\r\nexports.withInstall = function (comp) {\r\n    comp.install = function (Vue) {\r\n        Vue.component(comp.displayName || comp.name, comp);\r\n    };\r\n    return comp;\r\n};\r\n/**\r\n * withVue\r\n * @description - 将属性p混入到Vue实例中，在Vue实例的表达式中可以使用this.$adv[p]来进行访问\r\n * @param Vue\r\n * @param p\r\n * @param val\r\n */\r\nexports.withVue = function (Vue, p, val) {\r\n    Vue.prototype.$adv = Vue.prototype.$adv || {};\r\n    Vue.prototype.$adv[p] = val;\r\n};\r\n/**\r\n * extend\r\n * @description - 实现Vue的继承使得可以实现调用父类的方法\r\n * 例如 类名A有一个renderInner方法，则父类的方法是$renderInnerA\r\n * @param options\r\n * @return Omit<ExtendFunction<any>, 'className'>\r\n */\r\nexports.extend = function (options) {\r\n    var className = options.className, vueOptions = __rest(options, [\"className\"]);\r\n    if (!vueOptions)\r\n        return {};\r\n    var methods = vueOptions.methods;\r\n    if (!methods || !className)\r\n        return vueOptions;\r\n    var methodKeys = Object.keys(methods).filter(function (methodKey) {\r\n        return ['$', '_'].every(function (prefix) { return !methodKey.startsWith(prefix); });\r\n    });\r\n    var classNames = !Array.isArray(className) ? [className] : className;\r\n    for (var i = 0; i < methodKeys.length; i++) {\r\n        var methodKey = methodKeys[i];\r\n        var _loop_1 = function (j) {\r\n            var superMethodKey = \"$\" + methodKey + classNames[j];\r\n            vueOptions.methods[superMethodKey] = vueOptions.methods[methodKey];\r\n            vueOptions.methods[methodKey] = function () {\r\n                var params = [];\r\n                for (var _i = 0; _i < arguments.length; _i++) {\r\n                    params[_i] = arguments[_i];\r\n                }\r\n                return this[superMethodKey].apply(this, params || []);\r\n            };\r\n        };\r\n        for (var j = 0; j < classNames.length; j++) {\r\n            _loop_1(j);\r\n        }\r\n    }\r\n    return vueOptions;\r\n};\r\n/**\r\n * Fragment\r\n */\r\nexports.Fragment = {\r\n    render: function (h) {\r\n        var _a;\r\n        // @ts-ignore\r\n        return (_a = this === null || this === void 0 ? void 0 : this.$slots) === null || _a === void 0 ? void 0 : _a.default;\r\n    },\r\n};\r\n/**\r\n * HOCFunctional\r\n * @description 函数组件实现HOC\r\n * @param options\r\n * @param data\r\n * @param name\r\n * @constructor\r\n */\r\nexports.HOCFunctional = function (options, data, name) {\r\n    return {\r\n        functional: true,\r\n        name: name,\r\n        render: function (h, context) {\r\n            return h(options, lodash_merge_1.default(data ? data(h, context) : {}, context.data), context.children);\r\n        },\r\n    };\r\n};\r\n/**\r\n * HOC\r\n * @description 非函数组件实现HOC\r\n * @description HOC是对已有组件的一个扩展，扩展的原则就是render函数中还是用已有组件进行渲染，只是对已有组件的属性和传值进行了扩展而已\r\n * @param component - 组件配置\r\n * @param options - 重写的配置项\r\n * @param dataOptions - 数据对象\r\n * @param children\r\n * @constructor\r\n */\r\nexports.HOC = function (component, options, dataOptions, children) {\r\n    var methods = {};\r\n    var _loop_2 = function (methodName) {\r\n        methods[methodName] = function (params) {\r\n            // @ts-ignore\r\n            return this.$refs.wrapRef[methodName](params);\r\n        };\r\n    };\r\n    for (var methodName in component.methods || {}) {\r\n        _loop_2(methodName);\r\n    }\r\n    var baseOptions = {\r\n        props: component.props,\r\n        methods: methods,\r\n    };\r\n    var Options = options instanceof Function ? options(baseOptions) : lodash_merge_1.default(baseOptions, options || {});\r\n    return __assign({ render: function (h) {\r\n            var _this = this;\r\n            var _a, _b, _c;\r\n            var slots = children\r\n                ? children.call(this, h)\r\n                : Object.keys(this.$slots).reduce(function (arr, key) { return arr.concat(_this.$slots[key]); }, []);\r\n            var baseDataOptions = {\r\n                props: this.$props,\r\n                attrs: this.$attrs,\r\n                on: this.$listeners,\r\n                scopedSlots: __assign({}, (this.$scopedSlots || {})),\r\n            };\r\n            var dataOptionsFun = ('options' in (dataOptions || {}) && ((_a = (dataOptions || {}).options) === null || _a === void 0 ? void 0 : _a.deep)) ||\r\n                !('options' in (dataOptions || {}))\r\n                ? lodash_mergewith_1.default\r\n                : Object.assign;\r\n            var argv = [\r\n                baseDataOptions,\r\n                (_c = (_b = dataOptions === null || dataOptions === void 0 ? void 0 : dataOptions.renderWith) === null || _b === void 0 ? void 0 : _b.call) === null || _c === void 0 ? void 0 : _c.call(_b, this, h, __assign({}, baseDataOptions)),\r\n            ];\r\n            if (dataOptionsFun === lodash_mergewith_1.default) {\r\n                argv.push(function (objValue, srcValue) {\r\n                    if (Array.isArray(objValue))\r\n                        return srcValue;\r\n                });\r\n            }\r\n            var DataOptions = dataOptionsFun.apply(window, argv);\r\n            // console.log(\r\n            //   'HOC',\r\n            //   component.name,\r\n            //   baseDataOptions,\r\n            //   dataOptions?.renderWith?.call?.(this, h, { ...baseDataOptions }),\r\n            // )\r\n            return h(component, __assign(__assign({}, DataOptions), { ref: 'wrapRef' }), slots);\r\n        } }, Options);\r\n};\r\n/**\r\n * getComponentPropsOption\r\n * @description 获取组件的Props定义\r\n * @param Component\r\n * @returns {{}}\r\n */\r\nexports.getComponentPropsOption = memoized.createMemoFun(function (Component) { return (__assign({}, (Component.mixins || []).reduce(function (props, com) { return (__assign(__assign({}, (com.props || {})), props)); }, Component.props))); });\r\n"],"names":["__assign","this","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","__rest","e","indexOf","getOwnPropertySymbols","propertyIsEnumerable","__importDefault","mod","__esModule","default","defineProperty","exports","value","getComponentPropsOption","HOC","HOCFunctional","Fragment","extend","withVue","withInstall","lodash_merge_1","require","lodash_mergewith_1","adherev_util_watchmemoized_1","memoized","comp","install","Vue","component","displayName","name","val","$adv","options","className","vueOptions","methods","methodKeys","keys","filter","methodKey","every","prefix","startsWith","classNames","Array","isArray","j","superMethodKey","params","_i","_loop_1","render","h","_a","$slots","data","functional","context","children","dataOptions","methodName","$refs","wrapRef","_loop_2","baseOptions","props","Options","Function","_b","_c","_this","slots","reduce","arr","key","concat","baseDataOptions","$props","attrs","$attrs","on","$listeners","scopedSlots","$scopedSlots","dataOptionsFun","deep","argv","renderWith","push","objValue","srcValue","DataOptions","window","ref","createMemoFun","Component","mixins","com"],"mappings":"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"}