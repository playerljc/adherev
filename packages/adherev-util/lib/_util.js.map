{"version":3,"file":"_util.js","sources":["_util.js"],"sourcesContent":["\"use strict\";\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __rest = (this && this.__rest) || function (s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n};\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.getComponentPropsOption = exports.HOC = exports.HOCFunctional = exports.Fragment = exports.extend = exports.withVue = exports.withInstall = void 0;\r\nvar lodash_merge_1 = __importDefault(require(\"lodash.merge\"));\r\nvar lodash_mergewith_1 = __importDefault(require(\"lodash.mergewith\"));\r\nvar adherev_util_watchmemoized_1 = __importDefault(require(\"@baifendian/adherev-util-watchmemoized\"));\r\nvar memoized = adherev_util_watchmemoized_1.default.memoized;\r\n/**\r\n * withInstall\r\n * @description Vue组件的插件方法\r\n * @param comp\r\n * @return comp\r\n */\r\nexports.withInstall = function (comp) {\r\n    comp.install = function (Vue) {\r\n        Vue.component(comp.displayName || comp.name, comp);\r\n    };\r\n    return comp;\r\n};\r\n/**\r\n * withVue\r\n * @description - 将属性p混入到Vue实例中，在Vue实例的表达式中可以使用this.$adv[p]来进行访问\r\n * @param Vue\r\n * @param p\r\n * @param val\r\n */\r\nexports.withVue = function (Vue, p, val) {\r\n    Vue.prototype.$adv = Vue.prototype.$adv || {};\r\n    Vue.prototype.$adv[p] = val;\r\n};\r\n/**\r\n * extend\r\n * @description - 实现Vue的继承使得可以实现调用父类的方法\r\n * 例如 类名A有一个renderInner方法，则父类的方法是$renderInnerA\r\n * @param options\r\n * @return Omit<ExtendFunction<any>, 'className'>\r\n */\r\nexports.extend = function (options) {\r\n    var className = options.className, vueOptions = __rest(options, [\"className\"]);\r\n    if (!vueOptions)\r\n        return {};\r\n    var methods = vueOptions.methods;\r\n    if (!methods || !className)\r\n        return vueOptions;\r\n    var methodKeys = Object.keys(methods).filter(function (methodKey) {\r\n        return ['$', '_'].every(function (prefix) { return !methodKey.startsWith(prefix); });\r\n    });\r\n    var classNames = !Array.isArray(className) ? [className] : className;\r\n    for (var i = 0; i < methodKeys.length; i++) {\r\n        var methodKey = methodKeys[i];\r\n        var _loop_1 = function (j) {\r\n            var superMethodKey = \"$\" + methodKey + classNames[j];\r\n            vueOptions.methods[superMethodKey] = vueOptions.methods[methodKey];\r\n            vueOptions.methods[methodKey] = function () {\r\n                var params = [];\r\n                for (var _i = 0; _i < arguments.length; _i++) {\r\n                    params[_i] = arguments[_i];\r\n                }\r\n                return this[superMethodKey].apply(this, params || []);\r\n            };\r\n        };\r\n        for (var j = 0; j < classNames.length; j++) {\r\n            _loop_1(j);\r\n        }\r\n    }\r\n    return vueOptions;\r\n};\r\n/**\r\n * Fragment\r\n */\r\nexports.Fragment = {\r\n    render: function (h) {\r\n        var _a;\r\n        // @ts-ignore\r\n        return (_a = this === null || this === void 0 ? void 0 : this.$slots) === null || _a === void 0 ? void 0 : _a.default;\r\n    },\r\n};\r\n/**\r\n * HOCFunctional\r\n * @description 函数组件实现HOC\r\n * @param options\r\n * @param data\r\n * @param name\r\n * @constructor\r\n */\r\nexports.HOCFunctional = function (options, data, name) {\r\n    return {\r\n        functional: true,\r\n        name: name,\r\n        render: function (h, context) {\r\n            return h(options, lodash_merge_1.default(data ? data(h, context) : {}, context.data), context.children);\r\n        },\r\n    };\r\n};\r\n/**\r\n * HOC\r\n * @description 非函数组件实现HOC\r\n * @description HOC是对已有组件的一个扩展，扩展的原则就是render函数中还是用已有组件进行渲染，只是对已有组件的属性和传值进行了扩展而已\r\n * @param component - 组件配置\r\n * @param options - 重写的配置项\r\n * @param dataOptions - 数据对象\r\n * @param children\r\n * @constructor\r\n */\r\nexports.HOC = function (component, options, dataOptions, children) {\r\n    var methods = {};\r\n    var _loop_2 = function (methodName) {\r\n        methods[methodName] = function (params) {\r\n            // @ts-ignore\r\n            return this.$refs.wrapRef[methodName](params);\r\n        };\r\n    };\r\n    for (var methodName in component.methods || {}) {\r\n        _loop_2(methodName);\r\n    }\r\n    var baseOptions = {\r\n        props: component.props,\r\n        methods: methods,\r\n    };\r\n    var Options = options instanceof Function ? options(baseOptions) : lodash_merge_1.default(baseOptions, options || {});\r\n    return __assign({ render: function (h) {\r\n            var _this = this;\r\n            var _a, _b, _c;\r\n            var slots = children\r\n                ? children.call(this, h)\r\n                : Object.keys(this.$slots).reduce(function (arr, key) { return arr.concat(_this.$slots[key]); }, []);\r\n            var baseDataOptions = {\r\n                props: this.$props,\r\n                attrs: this.$attrs,\r\n                on: this.$listeners,\r\n                scopedSlots: __assign({}, (this.$scopedSlots || {})),\r\n            };\r\n            var dataOptionsFun = ('options' in (dataOptions || {}) && ((_a = (dataOptions || {}).options) === null || _a === void 0 ? void 0 : _a.deep)) ||\r\n                !('options' in (dataOptions || {}))\r\n                ? lodash_mergewith_1.default\r\n                : Object.assign;\r\n            var argv = [\r\n                baseDataOptions,\r\n                (_c = (_b = dataOptions === null || dataOptions === void 0 ? void 0 : dataOptions.renderWith) === null || _b === void 0 ? void 0 : _b.call) === null || _c === void 0 ? void 0 : _c.call(_b, this, h, __assign({}, baseDataOptions)),\r\n            ];\r\n            if (dataOptionsFun === lodash_mergewith_1.default) {\r\n                argv.push(function (objValue, srcValue) {\r\n                    if (Array.isArray(objValue))\r\n                        return srcValue;\r\n                });\r\n            }\r\n            var DataOptions = dataOptionsFun.apply(window, argv);\r\n            // console.log(\r\n            //   'HOC',\r\n            //   component.name,\r\n            //   baseDataOptions,\r\n            //   dataOptions?.renderWith?.call?.(this, h, { ...baseDataOptions }),\r\n            // )\r\n            return h(component, __assign(__assign({}, DataOptions), { ref: 'wrapRef' }), slots);\r\n        } }, Options);\r\n};\r\n/**\r\n * getComponentPropsOption\r\n * @description 获取组件的Props定义\r\n * @param Component\r\n * @returns {{}}\r\n */\r\nexports.getComponentPropsOption = memoized.createMemoFun(function (Component) { return (__assign({}, (Component.mixins || []).reduce(function (props, com) { return (__assign(__assign({}, (com.props || {})), props)); }, Component.props))); });\r\n"],"names":["__assign","this","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","__rest","e","indexOf","getOwnPropertySymbols","propertyIsEnumerable","__importDefault","mod","__esModule","default","lodash_merge_1","defineProperty","exports","value","getComponentPropsOption","HOC","HOCFunctional","Fragment","extend","withVue","withInstall","require","lodash_mergewith_1","adherev_util_watchmemoized_1","memoized","comp","install","Vue","component","displayName","name","val","$adv","options","className","vueOptions","methods","methodKeys","keys","filter","methodKey","every","prefix","startsWith","classNames","Array","isArray","j","_loop_1","superMethodKey","params","_i","render","h","_a","$slots","data","functional","context","children","dataOptions","methodName","_loop_2","$refs","wrapRef","baseOptions","props","Options","Function","_this","slots","reduce","arr","key","concat","baseDataOptions","$props","attrs","$attrs","on","$listeners","scopedSlots","$scopedSlots","dataOptionsFun","deep","argv","_c","_b","renderWith","DataOptions","push","objValue","srcValue","window","ref","createMemoFun","Component","mixins","com"],"mappings":"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"}