{"version":3,"file":"_util.js","sources":["_util.js"],"sourcesContent":["var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __rest = (this && this.__rest) || function (s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n};\r\nimport merge from 'lodash.merge';\r\nimport mergeWidth from 'lodash.mergewith';\r\nimport WatchMemoized from '@baifendian/adherev-util-watchmemoized';\r\nvar memoized = WatchMemoized.memoized;\r\n/**\r\n * withInstall\r\n * @description Vue组件的插件方法\r\n * @param comp\r\n * @return comp\r\n */\r\nexport var withInstall = function (comp) {\r\n    comp.install = function (Vue) {\r\n        Vue.component(comp.displayName || comp.name, comp);\r\n    };\r\n    return comp;\r\n};\r\n/**\r\n * withVue\r\n * @description - 将属性p混入到Vue实例中，在Vue实例的表达式中可以使用this.$adv[p]来进行访问\r\n * @param Vue\r\n * @param p\r\n * @param val\r\n */\r\nexport var withVue = function (Vue, p, val) {\r\n    Vue.prototype.$adv = Vue.prototype.$adv || {};\r\n    Vue.prototype.$adv[p] = val;\r\n};\r\n/**\r\n * extend\r\n * @description - 实现Vue的继承使得可以实现调用父类的方法\r\n * 例如 类名A有一个renderInner方法，则父类的方法是$renderInnerA\r\n * @param options\r\n * @return Omit<ExtendFunction<any>, 'className'>\r\n */\r\nexport var extend = function (options) {\r\n    var className = options.className, vueOptions = __rest(options, [\"className\"]);\r\n    if (!vueOptions)\r\n        return {};\r\n    var methods = vueOptions.methods;\r\n    if (!methods || !className)\r\n        return vueOptions;\r\n    var methodKeys = Object.keys(methods).filter(function (methodKey) {\r\n        return ['$', '_'].every(function (prefix) { return !methodKey.startsWith(prefix); });\r\n    });\r\n    var classNames = !Array.isArray(className) ? [className] : className;\r\n    for (var i = 0; i < methodKeys.length; i++) {\r\n        var methodKey = methodKeys[i];\r\n        var _loop_1 = function (j) {\r\n            var superMethodKey = \"$\" + methodKey + classNames[j];\r\n            vueOptions.methods[superMethodKey] = vueOptions.methods[methodKey];\r\n            vueOptions.methods[methodKey] = function () {\r\n                var params = [];\r\n                for (var _i = 0; _i < arguments.length; _i++) {\r\n                    params[_i] = arguments[_i];\r\n                }\r\n                return this[superMethodKey].apply(this, params || []);\r\n            };\r\n        };\r\n        for (var j = 0; j < classNames.length; j++) {\r\n            _loop_1(j);\r\n        }\r\n    }\r\n    return vueOptions;\r\n};\r\n/**\r\n * Fragment\r\n */\r\nexport var Fragment = {\r\n    render: function (h) {\r\n        var _a;\r\n        // @ts-ignore\r\n        return (_a = this === null || this === void 0 ? void 0 : this.$slots) === null || _a === void 0 ? void 0 : _a.default;\r\n    },\r\n};\r\n/**\r\n * HOCFunctional\r\n * @description 函数组件实现HOC\r\n * @param options\r\n * @param data\r\n * @param name\r\n * @constructor\r\n */\r\nexport var HOCFunctional = function (options, data, name) {\r\n    return {\r\n        functional: true,\r\n        name: name,\r\n        render: function (h, context) {\r\n            return h(options, merge(data ? data(h, context) : {}, context.data), context.children);\r\n        },\r\n    };\r\n};\r\n/**\r\n * HOC\r\n * @description 非函数组件实现HOC\r\n * @description HOC是对已有组件的一个扩展，扩展的原则就是render函数中还是用已有组件进行渲染，只是对已有组件的属性和传值进行了扩展而已\r\n * @param component - 组件配置\r\n * @param options - 重写的配置项\r\n * @param dataOptions - 数据对象\r\n * @param children\r\n * @constructor\r\n */\r\nexport var HOC = function (component, options, dataOptions, children) {\r\n    var methods = {};\r\n    var _loop_2 = function (methodName) {\r\n        methods[methodName] = function (params) {\r\n            // @ts-ignore\r\n            return this.$refs.wrapRef[methodName](params);\r\n        };\r\n    };\r\n    for (var methodName in component.methods || {}) {\r\n        _loop_2(methodName);\r\n    }\r\n    var baseOptions = {\r\n        props: component.props,\r\n        methods: methods,\r\n    };\r\n    var Options = options instanceof Function ? options(baseOptions) : merge(baseOptions, options || {});\r\n    return __assign({ render: function (h) {\r\n            var _this = this;\r\n            var _a, _b, _c;\r\n            var slots = children\r\n                ? children.call(this, h)\r\n                : Object.keys(this.$slots).reduce(function (arr, key) { return arr.concat(_this.$slots[key]); }, []);\r\n            var baseDataOptions = {\r\n                props: this.$props,\r\n                attrs: this.$attrs,\r\n                on: this.$listeners,\r\n                scopedSlots: __assign({}, (this.$scopedSlots || {})),\r\n            };\r\n            var dataOptionsFun = ('options' in (dataOptions || {}) && ((_a = (dataOptions || {}).options) === null || _a === void 0 ? void 0 : _a.deep)) ||\r\n                !('options' in (dataOptions || {}))\r\n                ? mergeWidth\r\n                : Object.assign;\r\n            var argv = [\r\n                baseDataOptions,\r\n                (_c = (_b = dataOptions === null || dataOptions === void 0 ? void 0 : dataOptions.renderWith) === null || _b === void 0 ? void 0 : _b.call) === null || _c === void 0 ? void 0 : _c.call(_b, this, h, __assign({}, baseDataOptions)),\r\n            ];\r\n            if (dataOptionsFun === mergeWidth) {\r\n                argv.push(function (objValue, srcValue) {\r\n                    if (Array.isArray(objValue))\r\n                        return srcValue;\r\n                });\r\n            }\r\n            var DataOptions = dataOptionsFun.apply(window, argv);\r\n            // console.log(\r\n            //   'HOC',\r\n            //   component.name,\r\n            //   baseDataOptions,\r\n            //   dataOptions?.renderWith?.call?.(this, h, { ...baseDataOptions }),\r\n            // )\r\n            return h(component, __assign(__assign({}, DataOptions), { ref: 'wrapRef' }), slots);\r\n        } }, Options);\r\n};\r\n/**\r\n * getComponentPropsOption\r\n * @description 获取组件的Props定义\r\n * @param Component\r\n * @returns {{}}\r\n */\r\nexport var getComponentPropsOption = memoized.createMemoFun(function (Component) { return (__assign({}, (Component.mixins || []).reduce(function (props, com) { return (__assign(__assign({}, (com.props || {})), props)); }, Component.props))); });\r\n"],"names":["__assign","this","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","__rest","e","indexOf","getOwnPropertySymbols","propertyIsEnumerable","merge","mergeWidth","WatchMemoized","memoized","withInstall","comp","install","Vue","component","displayName","name","withVue","val","$adv","extend","options","className","vueOptions","methods","methodKeys","keys","filter","methodKey","every","prefix","startsWith","classNames","Array","isArray","j","_loop_1","superMethodKey","params","_i","Fragment","render","h","_a","$slots","default","HOCFunctional","data","functional","context","children","HOC","dataOptions","methodName","_loop_2","$refs","wrapRef","baseOptions","props","Options","Function","_this","slots","reduce","arr","key","concat","baseDataOptions","$props","attrs","$attrs","on","$listeners","scopedSlots","$scopedSlots","dataOptionsFun","deep","argv","_c","_b","renderWith","DataOptions","push","objValue","srcValue","window","ref","getComponentPropsOption","createMemoFun","Component","mixins","com"],"mappings":"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"}