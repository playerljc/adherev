{"version":3,"file":"ContextMenu.js","sources":["ContextMenu.js"],"sourcesContent":["import { createVNode as _createVNode } from \"vue\";\nimport { __assign } from \"tslib\";\nimport { computed, createApp, defineComponent, onMounted, provide, reactive, ref } from 'vue';\nimport { array, object } from 'vue-types';\nimport Menu from './Menu';\nvar selectorPrefix = 'adherev-ui-contextmenu';\nvar props = {\n  data: array().def([]),\n  config: object().def(),\n  el: object().def()\n};\n/**\n * ContextMenuComponent\n * @class ContextMenuComponent\n * @classdesc ContextMenuComponent\n */\n\nvar ContextMenuComponent = defineComponent({\n  props: props,\n  setup: function setup(props, _a) {\n    var expose = _a.expose;\n    var menuIns = ref(null);\n    var context = reactive({\n      config: props.config,\n      el: props.el\n    });\n    var getStyle = computed(function () {\n      return {\n        zIndex: 9999 * 2\n      };\n    });\n    onMounted(function () {\n      return mount();\n    });\n\n    var onClick = function onClick(e) {\n      var _a, _b, _c;\n\n      e.stopPropagation();\n      (_c = (_b = (_a = props.el) === null || _a === void 0 ? void 0 : _a.parentElement) === null || _b === void 0 ? void 0 : _b.removeChild) === null || _c === void 0 ? void 0 : _c.call(_b, props.el);\n    };\n\n    var onContextMenu = function onContextMenu(e) {\n      var _a, _b, _c;\n\n      e.preventDefault();\n      (_c = (_b = (_a = props.el) === null || _a === void 0 ? void 0 : _a.parentElement) === null || _b === void 0 ? void 0 : _b.removeChild) === null || _c === void 0 ? void 0 : _c.call(_b, props.el);\n    };\n\n    var mount = function mount() {\n      return menuIns.value.mount();\n    };\n\n    provide('context', context);\n    expose({\n      mount: mount\n    });\n    return function () {\n      return _createVNode(\"div\", {\n        \"class\": selectorPrefix,\n        \"style\": getStyle.value,\n        \"onClick\": onClick,\n        \"onContextMenu\": onContextMenu\n      }, [_createVNode(Menu, {\n        \"data\": props.data,\n        \"className\": props.config.className,\n        \"style\": props.config.style,\n        \"ref\": menuIns\n      }, null)]);\n    };\n  }\n});\nvar ContextMenu = {\n  /**\n   * config\n   * {\n   *   name - {String} 名字\n   *   icon - {String} 图标\n   *   id - {String} 唯一的id\n   *   disabled - {Boolean} 不可用\n   *   separation - {Bolean} 分割线\n   *   attribute - {Object} 自定义属性\n   *   children - {Array<Object> 孩子\n   * }\n   *{\n   *   width - {Number} 宽度\n   *   x - {Number} 显示的x坐标 相对于body\n   *   y - {Number} 现实的y坐标 相对于body\n   *   maskClosable - {Boolean} 点击其他位置是否关闭菜单\n   *   handler - {Function} 点击的事件句柄\n   * }\n   * @return {HTMLDivElement}\n   * @param data\n   * @param defaultConfig\n   */\n  open: function open(data, defaultConfig) {\n    var config = __assign(__assign({}, defaultConfig), {\n      width: 200,\n      maskClosable: true\n    });\n\n    var parentEl = document.createElement('div');\n    document.body.appendChild(parentEl);\n    var app = createApp({\n      setup: function setup() {\n        var root = ref(null);\n        onMounted(function () {\n          root.value.mount();\n        });\n        provide('root', {\n          unmount: function unmount() {\n            var _a, _b;\n\n            console.log('app', app, parentEl);\n\n            try {\n              // @ts-ignore\n              app.unmount();\n            } catch (err) {\n              (_b = (_a = parentEl) === null || _a === void 0 ? void 0 : _a.parentElement) === null || _b === void 0 ? void 0 : _b.removeChild(parentEl);\n            }\n          }\n        }); // @ts-ignore\n\n        return function () {\n          return _createVNode(ContextMenuComponent, {\n            \"ref\": root,\n            \"data\": data,\n            \"config\": config,\n            \"el\": parentEl\n          }, null);\n        };\n      }\n    }).mount(parentEl);\n    return {\n      vm: app,\n      el: parentEl\n    };\n  },\n\n  /**\n   * close\n   * @param vm\n   * @param el\n   */\n  close: function close(_a) {\n    var _b, _c;\n\n    var vm = _a.vm,\n        el = _a.el;\n\n    try {\n      vm.unmount();\n    } catch (err) {\n      (_c = (_b = el) === null || _b === void 0 ? void 0 : _b.parentElement) === null || _c === void 0 ? void 0 : _c.removeChild(el);\n    }\n  }\n};\nexport default ContextMenu;"],"names":["_createVNode","__assign","computed","createApp","defineComponent","onMounted","provide","reactive","ref","array","object","Menu","selectorPrefix","props","data","def","config","el","ContextMenuComponent","setup","_a","onClick","e","_c","stopPropagation","_b","parentElement","removeChild","call","onContextMenu","preventDefault","expose","menuIns","context","getStyle","zIndex","mount","value","class","style","className","ContextMenu","open","defaultConfig","width","maskClosable","parentEl","document","createElement","app","body","appendChild","root","unmount","console","log","err","vm","close"],"mappings":"OAAwBA,6CACfC,4BACAC,SAAUC,UAAWC,gBAAiBC,UAAWC,QAASC,SAAUC,qBACpEC,MAAOC,8BACTC,kBACP,IAAIC,eAAiB,yBACjBC,MAAQ,CACVC,KAAML,QAAQM,IAAI,IAClBC,OAAQN,SAASK,MACjBE,GAAIP,SAASK,OAQXG,qBAAuBd,gBAAgB,CACzCS,MAAOA,MACPM,MAAO,SAAeN,EAAOO,GAgBb,SAAVC,EAA2BC,GAC7B,IAAYC,EAEZD,EAAEE,kBAC0I,QAA3ID,EAAsF,QAAhFE,EAAyB,QAAnBL,EAAKP,EAAMI,UAAuB,IAAPG,OAAgB,EAASA,EAAGM,qBAAkC,IAAPD,OAAgB,EAASA,EAAGE,mBAAgC,IAAPJ,GAAyBA,EAAGK,KAAKH,EAAIZ,EAAMI,IAG7K,SAAhBY,EAAuCP,GACzC,IAAYC,EAEZD,EAAEQ,iBAC0I,QAA3IP,EAAsF,QAAhFE,EAAyB,QAAnBL,EAAKP,EAAMI,UAAuB,IAAPG,OAAgB,EAASA,EAAGM,qBAAkC,IAAPD,OAAgB,EAASA,EAAGE,mBAAgC,IAAPJ,GAAyBA,EAAGK,KAAKH,EAAIZ,EAAMI,IA1BjM,IAAIc,EAASX,EAAGW,OACZC,EAAUxB,IAAI,MACdyB,EAAU1B,SAAS,CACrBS,OAAQH,EAAMG,OACdC,GAAIJ,EAAMI,KAERiB,EAAWhC,SAAS,WACtB,MAAO,CACLiC,OAAQ,SAqBRC,GAlBJ/B,UAAU,WACR,OAAO+B,MAiBG,WACV,OAAOJ,EAAQK,MAAMD,UAOvB,OAJA9B,QAAQ,UAAW2B,GACnBF,EAAO,CACLK,MAAOA,IAEF,WACL,OAAOpC,aAAa,MAAO,CACzBsC,MAAS1B,eACT2B,MAASL,EAASG,MAClBhB,QAAWA,EACXQ,cAAiBA,GAChB,CAAC7B,aAAaW,KAAM,CACrBG,KAAQD,EAAMC,KACd0B,UAAa3B,EAAMG,OAAOwB,UAC1BD,MAAS1B,EAAMG,OAAOuB,MACtB/B,IAAOwB,GACN,YAILS,YAAc,CAuBhBC,KAAM,SAAc5B,EAAM6B,GACxB,IAAI3B,EAASf,SAASA,SAAS,GAAI0C,GAAgB,CACjDC,MAAO,IACPC,cAAc,IAGZC,EAAWC,SAASC,cAAc,OAElCC,GADJF,SAASG,KAAKC,YAAYL,GAChB3C,UAAU,CAClBgB,MAAO,WACL,IAAIiC,EAAO5C,IAAI,MAmBf,OAlBAH,UAAU,WACR+C,EAAKf,MAAMD,UAEb9B,QAAQ,OAAQ,CACd+C,QAAS,WACP,IAAQ5B,EAER6B,QAAQC,IAAI,MAAON,EAAKH,GAExB,IAEEG,EAAII,UACJ,MAAOG,GAC0E,QAAhF/B,EAAyB,OAAdqB,QAA6B,IAA7BA,OAAsC,EAAtCA,EAAkDpB,qBAAkC,IAAPD,GAAyBA,EAAGE,YAAYmB,OAKhI,WACL,OAAO9C,aAAakB,qBAAsB,CACxCV,IAAO4C,EACPtC,KAAQA,EACRE,OAAUA,EACVC,GAAM6B,GACL,UAGNV,MAAMU,IACT,MAAO,CACLW,GAAIR,EACJhC,GAAI6B,IASRY,MAAO,SAAetC,GACpB,IAEIqC,EAAKrC,EAAGqC,GACRxC,EAAKG,EAAGH,GAEZ,IACEwC,EAAGJ,UACH,MAAOG,GACoE,QAA1EjC,EAAmB,OAARN,QAAuB,IAAvBA,OAAgC,EAAhCA,EAA4CS,qBAAkC,IAAPH,GAAyBA,EAAGI,YAAYV,qBAIlHwB"}