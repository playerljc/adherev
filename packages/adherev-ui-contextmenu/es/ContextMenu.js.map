{"version":3,"file":"ContextMenu.js","sources":["ContextMenu.js"],"sourcesContent":["import { createVNode as _createVNode } from \"vue\";\nimport { __assign } from \"tslib\";\nimport { computed, createApp, defineComponent, onMounted, provide, reactive, ref } from 'vue';\nimport { array, object } from 'vue-types';\nimport Menu from './Menu';\nvar selectorPrefix = 'adherev-ui-contextmenu';\nvar props = {\n  data: array().def([]),\n  config: object().def(),\n  el: object().def()\n};\n/**\n * ContextMenuComponent\n * @class ContextMenuComponent\n * @classdesc ContextMenuComponent\n */\nvar ContextMenuComponent = defineComponent({\n  props: props,\n  setup: function setup(props, _a) {\n    var expose = _a.expose;\n    var menuIns = ref(null);\n    var context = reactive({\n      config: props.config,\n      el: props.el\n    });\n    var getStyle = computed(function () {\n      return {\n        zIndex: 9999 * 2\n      };\n    });\n    var onClick = function onClick(e) {\n      var _a, _b, _c;\n      e.stopPropagation();\n      (_c = (_b = (_a = props.el) === null || _a === void 0 ? void 0 : _a.parentElement) === null || _b === void 0 ? void 0 : _b.removeChild) === null || _c === void 0 ? void 0 : _c.call(_b, props.el);\n    };\n    var onContextMenu = function onContextMenu(e) {\n      var _a, _b, _c;\n      e.preventDefault();\n      (_c = (_b = (_a = props.el) === null || _a === void 0 ? void 0 : _a.parentElement) === null || _b === void 0 ? void 0 : _b.removeChild) === null || _c === void 0 ? void 0 : _c.call(_b, props.el);\n    };\n    var mount = function mount() {\n      return menuIns.value.mount();\n    };\n    provide('context', context);\n    expose({\n      mount: mount\n    });\n    onMounted(function () {\n      return mount();\n    });\n    return function () {\n      return _createVNode(\"div\", {\n        \"class\": selectorPrefix,\n        \"style\": getStyle.value,\n        \"onClick\": onClick,\n        \"onContextmenu\": onContextMenu\n      }, [_createVNode(Menu, {\n        \"data\": props.data,\n        \"className\": props.config.className,\n        \"style\": props.config.style,\n        \"ref\": menuIns\n      }, null)]);\n    };\n  }\n});\nvar ContextMenu = {\n  /**\n   * config\n   * {\n   *   name - {String} 名字\n   *   icon - {String} 图标\n   *   id - {String} 唯一的id\n   *   disabled - {Boolean} 不可用\n   *   separation - {Bolean} 分割线\n   *   attribute - {Object} 自定义属性\n   *   children - {Array<Object> 孩子\n   * }\n   *{\n   *   width - {Number} 宽度\n   *   x - {Number} 显示的x坐标 相对于body\n   *   y - {Number} 现实的y坐标 相对于body\n   *   maskClosable - {Boolean} 点击其他位置是否关闭菜单\n   *   handler - {Function} 点击的事件句柄\n   * }\n   * @return {HTMLDivElement}\n   * @param data\n   * @param defaultConfig\n   */\n  open: function open(data, defaultConfig) {\n    var config = __assign(__assign({}, defaultConfig), {\n      width: 200,\n      maskClosable: true\n    });\n    var parentEl = document.createElement('div');\n    document.body.appendChild(parentEl);\n    var app = createApp({\n      setup: function setup() {\n        var root = ref(null);\n        onMounted(function () {\n          root.value.mount();\n        });\n        provide('root', {\n          unmount: function unmount() {\n            var _a;\n            try {\n              // @ts-ignore\n              app.unmount();\n            } catch (err) {\n              (_a = parentEl === null || parentEl === void 0 ? void 0 : parentEl.parentElement) === null || _a === void 0 ? void 0 : _a.removeChild(parentEl);\n            }\n          }\n        });\n        return function () {\n          return _createVNode(ContextMenuComponent, {\n            \"ref\": root,\n            \"data\": data,\n            \"config\": config,\n            \"el\": parentEl\n          }, null);\n        };\n      }\n    }).mount(parentEl);\n    return {\n      vm: app,\n      el: parentEl\n    };\n  },\n  /**\n   * close\n   * @param vm\n   * @param el\n   */\n  close: function close(_a) {\n    var _b;\n    var vm = _a.vm,\n      el = _a.el;\n    try {\n      vm.unmount();\n    } catch (err) {\n      (_b = el === null || el === void 0 ? void 0 : el.parentElement) === null || _b === void 0 ? void 0 : _b.removeChild(el);\n    }\n  }\n};\nexport default ContextMenu;"],"names":["_createVNode","__assign","computed","createApp","defineComponent","onMounted","provide","reactive","ref","array","object","Menu","selectorPrefix","props","data","def","config","el","ContextMenuComponent","setup","_a","onClick","e","_c","stopPropagation","_b","parentElement","removeChild","call","onContextMenu","preventDefault","mount","menuIns","value","expose","context","getStyle","zIndex","class","style","onContextmenu","className","ContextMenu","open","defaultConfig","width","maskClosable","parentEl","document","createElement","app","body","appendChild","root","unmount","err","vm","close"],"mappings":"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"}