{"version":3,"file":"ContextMenu.js","sources":["ContextMenu.js"],"sourcesContent":["\"use strict\";\n\nvar _vue = require(\"vue\");\nrequire(\"core-js/modules/es.object.define-property.js\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar tslib_1 = require(\"tslib\");\nvar vue_1 = require(\"vue\");\nvar vue_types_1 = require(\"vue-types\");\nvar Menu_1 = tslib_1.__importDefault(require(\"./Menu\"));\nvar selectorPrefix = 'adherev-ui-contextmenu';\nvar props = {\n  data: (0, vue_types_1.array)().def([]),\n  config: (0, vue_types_1.object)().def(),\n  el: (0, vue_types_1.object)().def()\n};\n/**\n * ContextMenuComponent\n * @class ContextMenuComponent\n * @classdesc ContextMenuComponent\n */\nvar ContextMenuComponent = (0, vue_1.defineComponent)({\n  props: props,\n  setup: function setup(props, _a) {\n    var expose = _a.expose;\n    var menuIns = (0, vue_1.ref)(null);\n    var context = (0, vue_1.reactive)({\n      config: props.config,\n      el: props.el\n    });\n    var getStyle = (0, vue_1.computed)(function () {\n      return {\n        zIndex: 9999 * 2\n      };\n    });\n    var onClick = function onClick(e) {\n      var _a, _b, _c;\n      e.stopPropagation();\n      (_c = (_b = (_a = props.el) === null || _a === void 0 ? void 0 : _a.parentElement) === null || _b === void 0 ? void 0 : _b.removeChild) === null || _c === void 0 ? void 0 : _c.call(_b, props.el);\n    };\n    var onContextMenu = function onContextMenu(e) {\n      var _a, _b, _c;\n      e.preventDefault();\n      (_c = (_b = (_a = props.el) === null || _a === void 0 ? void 0 : _a.parentElement) === null || _b === void 0 ? void 0 : _b.removeChild) === null || _c === void 0 ? void 0 : _c.call(_b, props.el);\n    };\n    var mount = function mount() {\n      return menuIns.value.mount();\n    };\n    (0, vue_1.provide)('context', context);\n    expose({\n      mount: mount\n    });\n    (0, vue_1.onMounted)(function () {\n      return mount();\n    });\n    return function () {\n      return (0, _vue.createVNode)(\"div\", {\n        \"class\": selectorPrefix,\n        \"style\": getStyle.value,\n        \"onClick\": onClick,\n        \"onContextmenu\": onContextMenu\n      }, [(0, _vue.createVNode)(Menu_1.default, {\n        \"data\": props.data,\n        \"className\": props.config.className,\n        \"style\": props.config.style,\n        \"ref\": menuIns\n      }, null)]);\n    };\n  }\n});\nvar ContextMenu = {\n  /**\n   * config\n   * {\n   *   name - {String} 名字\n   *   icon - {String} 图标\n   *   id - {String} 唯一的id\n   *   disabled - {Boolean} 不可用\n   *   separation - {Bolean} 分割线\n   *   attribute - {Object} 自定义属性\n   *   children - {Array<Object> 孩子\n   * }\n   *{\n   *   width - {Number} 宽度\n   *   x - {Number} 显示的x坐标 相对于body\n   *   y - {Number} 现实的y坐标 相对于body\n   *   maskClosable - {Boolean} 点击其他位置是否关闭菜单\n   *   handler - {Function} 点击的事件句柄\n   * }\n   * @return {HTMLDivElement}\n   * @param data\n   * @param defaultConfig\n   */\n  open: function open(data, defaultConfig) {\n    var config = tslib_1.__assign(tslib_1.__assign({}, defaultConfig), {\n      width: 200,\n      maskClosable: true\n    });\n    var parentEl = document.createElement('div');\n    document.body.appendChild(parentEl);\n    var app = (0, vue_1.createApp)({\n      setup: function setup() {\n        var root = (0, vue_1.ref)(null);\n        (0, vue_1.onMounted)(function () {\n          root.value.mount();\n        });\n        (0, vue_1.provide)('root', {\n          unmount: function unmount() {\n            var _a;\n            try {\n              // @ts-ignore\n              app.unmount();\n            } catch (err) {\n              (_a = parentEl === null || parentEl === void 0 ? void 0 : parentEl.parentElement) === null || _a === void 0 ? void 0 : _a.removeChild(parentEl);\n            }\n          }\n        });\n        return function () {\n          return (0, _vue.createVNode)(ContextMenuComponent, {\n            \"ref\": root,\n            \"data\": data,\n            \"config\": config,\n            \"el\": parentEl\n          }, null);\n        };\n      }\n    }).mount(parentEl);\n    return {\n      vm: app,\n      el: parentEl\n    };\n  },\n  /**\n   * close\n   * @param vm\n   * @param el\n   */\n  close: function close(_a) {\n    var _b;\n    var vm = _a.vm,\n      el = _a.el;\n    try {\n      vm.unmount();\n    } catch (err) {\n      (_b = el === null || el === void 0 ? void 0 : el.parentElement) === null || _b === void 0 ? void 0 : _b.removeChild(el);\n    }\n  }\n};\nexports.default = ContextMenu;"],"names":["_vue","require","tslib_1","Object","defineProperty","exports","value","vue_1","vue_types_1","Menu_1","__importDefault","selectorPrefix","props","data","array","def","config","object","el","ContextMenuComponent","defineComponent","setup","_a","onClick","e","_c","stopPropagation","_b","parentElement","removeChild","call","onContextMenu","preventDefault","mount","menuIns","expose","ref","context","reactive","getStyle","computed","zIndex","provide","onMounted","createVNode","class","style","onContextmenu","default","className","ContextMenu","open","defaultConfig","__assign","width","maskClosable","parentEl","document","createElement","app","body","appendChild","createApp","root","unmount","err","vm","close"],"mappings":"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"}