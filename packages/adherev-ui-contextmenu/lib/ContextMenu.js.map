{"version":3,"file":"ContextMenu.js","sources":["ContextMenu.js"],"sourcesContent":["\"use strict\";\n\nvar _vue = require(\"vue\");\n\nrequire(\"core-js/modules/es.object.define-property.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar tslib_1 = require(\"tslib\");\n\nvar vue_1 = require(\"vue\");\n\nvar vue_types_1 = require(\"vue-types\");\n\nvar Menu_1 = (0, tslib_1.__importDefault)(require(\"./Menu\"));\nvar selectorPrefix = 'adherev-ui-contextmenu';\nvar props = {\n  data: (0, vue_types_1.array)().def([]),\n  config: (0, vue_types_1.object)().def(),\n  el: (0, vue_types_1.object)().def()\n};\n/**\n * ContextMenuComponent\n * @class ContextMenuComponent\n * @classdesc ContextMenuComponent\n */\n\nvar ContextMenuComponent = (0, vue_1.defineComponent)({\n  props: props,\n  setup: function setup(props, _a) {\n    var expose = _a.expose;\n    var menuIns = (0, vue_1.ref)(null);\n    var context = (0, vue_1.reactive)({\n      config: props.config,\n      el: props.el\n    });\n    var getStyle = (0, vue_1.computed)(function () {\n      return {\n        zIndex: 9999 * 2\n      };\n    });\n    (0, vue_1.onMounted)(function () {\n      return mount();\n    });\n\n    var onClick = function onClick(e) {\n      var _a, _b, _c;\n\n      e.stopPropagation();\n      (_c = (_b = (_a = props.el) === null || _a === void 0 ? void 0 : _a.parentElement) === null || _b === void 0 ? void 0 : _b.removeChild) === null || _c === void 0 ? void 0 : _c.call(_b, props.el);\n    };\n\n    var onContextMenu = function onContextMenu(e) {\n      var _a, _b, _c;\n\n      e.preventDefault();\n      (_c = (_b = (_a = props.el) === null || _a === void 0 ? void 0 : _a.parentElement) === null || _b === void 0 ? void 0 : _b.removeChild) === null || _c === void 0 ? void 0 : _c.call(_b, props.el);\n    };\n\n    var mount = function mount() {\n      return menuIns.value.mount();\n    };\n\n    (0, vue_1.provide)('context', context);\n    expose({\n      mount: mount\n    });\n    return function () {\n      return (0, _vue.createVNode)(\"div\", {\n        \"class\": selectorPrefix,\n        \"style\": getStyle.value,\n        \"onClick\": onClick,\n        \"onContextMenu\": onContextMenu\n      }, [(0, _vue.createVNode)(Menu_1.default, {\n        \"data\": props.data,\n        \"className\": props.config.className,\n        \"style\": props.config.style,\n        \"ref\": menuIns\n      }, null)]);\n    };\n  }\n});\nvar ContextMenu = {\n  /**\n   * config\n   * {\n   *   name - {String} 名字\n   *   icon - {String} 图标\n   *   id - {String} 唯一的id\n   *   disabled - {Boolean} 不可用\n   *   separation - {Bolean} 分割线\n   *   attribute - {Object} 自定义属性\n   *   children - {Array<Object> 孩子\n   * }\n   *{\n   *   width - {Number} 宽度\n   *   x - {Number} 显示的x坐标 相对于body\n   *   y - {Number} 现实的y坐标 相对于body\n   *   maskClosable - {Boolean} 点击其他位置是否关闭菜单\n   *   handler - {Function} 点击的事件句柄\n   * }\n   * @return {HTMLDivElement}\n   * @param data\n   * @param defaultConfig\n   */\n  open: function open(data, defaultConfig) {\n    var config = (0, tslib_1.__assign)((0, tslib_1.__assign)({}, defaultConfig), {\n      width: 200,\n      maskClosable: true\n    });\n    var parentEl = document.createElement('div');\n    document.body.appendChild(parentEl);\n    var app = (0, vue_1.createApp)({\n      setup: function setup() {\n        var root = (0, vue_1.ref)(null);\n        (0, vue_1.onMounted)(function () {\n          root.value.mount();\n        });\n        (0, vue_1.provide)('root', {\n          unmount: function unmount() {\n            var _a, _b;\n\n            console.log('app', app, parentEl);\n\n            try {\n              // @ts-ignore\n              app.unmount();\n            } catch (err) {\n              (_b = (_a = parentEl) === null || _a === void 0 ? void 0 : _a.parentElement) === null || _b === void 0 ? void 0 : _b.removeChild(parentEl);\n            }\n          }\n        }); // @ts-ignore\n\n        return function () {\n          return (0, _vue.createVNode)(ContextMenuComponent, {\n            \"ref\": root,\n            \"data\": data,\n            \"config\": config,\n            \"el\": parentEl\n          }, null);\n        };\n      }\n    }).mount(parentEl);\n    return {\n      vm: app,\n      el: parentEl\n    };\n  },\n\n  /**\n   * close\n   * @param vm\n   * @param el\n   */\n  close: function close(_a) {\n    var _b, _c;\n\n    var vm = _a.vm,\n        el = _a.el;\n\n    try {\n      vm.unmount();\n    } catch (err) {\n      (_c = (_b = el) === null || _b === void 0 ? void 0 : _b.parentElement) === null || _c === void 0 ? void 0 : _c.removeChild(el);\n    }\n  }\n};\nexports.default = ContextMenu;"],"names":["_vue","require","tslib_1","Object","defineProperty","exports","value","vue_1","vue_types_1","Menu_1","__importDefault","selectorPrefix","props","data","array","def","config","object","el","ContextMenuComponent","defineComponent","setup","_a","onClick","e","_c","stopPropagation","_b","parentElement","removeChild","call","onContextMenu","preventDefault","expose","menuIns","ref","context","reactive","getStyle","computed","zIndex","mount","onMounted","provide","createVNode","class","style","default","className","ContextMenu","open","defaultConfig","__assign","width","maskClosable","parentEl","document","createElement","app","body","appendChild","createApp","root","unmount","console","log","err","vm","close"],"mappings":"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"}