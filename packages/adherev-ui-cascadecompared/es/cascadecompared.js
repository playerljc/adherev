import{isVNode as _isVNode,createVNode as _createVNode,Fragment as _Fragment}from"vue";import"core-js/modules/es.object.define-property.js";import"core-js/modules/es.array.find.js";import"core-js/modules/es.object.to-string.js";import"core-js/modules/es.array.map.js";import"core-js/modules/es.array.filter.js";import"core-js/modules/es.array.concat.js";import{__assign}from"tslib";import classNames from"classnames";import IScroll from"iscroll/build/iscroll-probe";import{computed,defineComponent,onMounted,onUpdated,ref}from"vue";import{array,number,object,oneOfType,string}from"vue-types";import StickupLayout from"@baifendian/adherev-ui-stickuplayout";import Util from"@baifendian/adherev-util";function _isSlot(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!_isVNode(e)}var selectorPrefix="adherev-ui-cascadecompared",defaultCellWidth=120;function initTouch(){document.addEventListener("touchmove",function(e){e.preventDefault()},!!function(){var e=!1;try{addEventListener("test",null,Object.defineProperty({},"passive",{get:function(){e=!0}}))}catch(e){}return e}()&&{capture:!1,passive:!1})}initTouch();var cascadeComparedProps={className:string().def(""),indicatorClassName:string().def(""),indicatorStyle:object().def({}),indicatorFixedWrapClassName:string().def(""),indicatorFixedWrapStyle:object().def({}),indicatorAutoWrapClassName:string().def(""),indicatorAutoWrapStyle:object().def({}),masterClassName:string().def(""),masterStyle:object().def({}),masterInnerClassName:string().def(""),masterInnerStyle:object().def({}),masterStickFixedClassName:string().def(""),masterStickFixedStyle:object().def({}),masterStickInnerClassName:string().def(""),masterStickInnerStyle:object().def({}),indicator:object().def(function(){return{columns:[],dataSource:[]}}),master:array().def(function(){return[]}),defaultCellWidth:oneOfType([number(),string()]).def(defaultCellWidth)};export default defineComponent({name:"adv-cascadecompared",props:cascadeComparedProps,slots:["masterGroupTitle","cell"],emits:["stickChange"],setup:function(r,e){function t(){for(var r=c.value.querySelectorAll(".".concat(selectorPrefix,"-autoWrap")),e=0;e<l.length;e++)l[e].destroy();for(l=[],e=0;e<r.length;e++)!function(e){var t=new IScroll(r[e],{probeType:3,eventPassthrough:!0,scrollX:!0,scrollY:!1,preventDefault:!1});l.push(t),t.on("scroll",function(){for(var e=0;e<l.length;e++)l[e]!==t&&l[e].scrollTo(t.x,t.y)})}(e)}function u(e){var t=e.find(function(e){return e.isFixed});return t||(e.length?e[0]:null)}function d(e,t,r,a,o){return s.cell?s.cell({config:e,dataSource:t,groupIndex:r,rowIndex:a,columnIndex:o}):t[e.dataIndex]}function a(){var e;return _createVNode("div",{class:x.value,style:r.masterStyle},[_createVNode(StickupLayout,{ref:i,class:S.value,style:r.masterInnerStyle,fixedClassName:g.value,fixedStyle:r.masterStickFixedStyle,innerClassName:C.value,innerStyle:r.masterStickInnerStyle,onChange:function(){return o("stickChange")}},_isSlot(e=r.master.map(function(e,t){return a=t,t=(r=e).className,e=void 0===(e=r.style)?"":e,_createVNode(StickupLayout.Item,{key:a,class:classNames((void 0===t?"":t)||""),style:e},{default:function(){return h(r,a)},title:function(){return _(r,a)}});var r,a}))?e:{default:function(){return[e]}})])}var o=e.emit,n=e.expose,s=e.slots,c=ref(null),i=ref(null),l=[],f=computed(function(){return classNames("".concat(selectorPrefix,"-indicator"),r.indicatorClassName||"")}),m=computed(function(){return function(e){return classNames("".concat(selectorPrefix,"-fixedWrap"),e||"")}}),p=computed(function(){return function(e,t){return __assign(__assign({},e),{width:"".concat(t||defaultCellWidth,"px")})}}),v=computed(function(){return function(e){return classNames("".concat(selectorPrefix,"-cell"),(null==e?void 0:e.className)||"")}}),y=computed(function(){return function(e){return classNames("".concat(selectorPrefix,"-autoWrap"),e||"")}}),N=computed(function(){return function(e){return classNames("".concat(selectorPrefix,"-autoInner"),e||"")}}),x=computed(function(){return classNames("".concat(selectorPrefix,"-master"),r.masterClassName||"")}),S=computed(function(){return classNames("".concat(selectorPrefix,"-master-inner"),r.masterInnerClassName||"")}),g=computed(function(){return classNames(r.masterStickFixedClassName||"")}),C=computed(function(){return classNames(r.masterStickInnerClassName||"")}),_=function(e,t){var r,a=e.title;return(!a||null==(r=null==Util?void 0:Util.isString)||!r.call(Util,a))&&s.masterGroupTitle?s.masterGroupTitle({config:e,groupIndex:t}):a},h=function(e,o){var t=e.dataSource,t=void 0===t?[]:t,r=e.columns,n=void 0===r?[]:r,r=e.fixedWrapClassName,r=void 0===r?"":r,a=e.fixedWrapStyle,a=void 0===a?{}:a,s=e.autoWrapClassName,s=void 0===s?"":s,c=e.autoWrapStyle,c=void 0===c?{}:c,i=e.autoInnerClassName,i=void 0===i?"":i,e=e.autoInnerStyle,e=void 0===e?{}:e,l=u(n);return _createVNode(_Fragment,null,[_createVNode("div",{class:m.value(r),style:p.value(a,l?null==l?void 0:l.width:0)},[t.map(function(e,t){return _createVNode("div",{key:t,class:"".concat(selectorPrefix,"-item")},[_createVNode("div",{class:v.value(l),style:null==l?void 0:l.style},[d(l,e,o,t,-1)])])})]),_createVNode("div",{class:y.value(s),style:c},[_createVNode("div",{class:N.value(i),style:e},[t.map(function(r,a){return _createVNode("div",{key:a,class:"".concat(selectorPrefix,"-item")},[n.filter(function(e){return e!==l}).map(function(e,t){return _createVNode("div",{key:e.dataIndex,class:v.value(e),style:p.value(e.style,null==e?void 0:e.width)},[d(e,r,o,a,t)])})])})])])])};return onMounted(function(){i.value.refresh(),t()}),onUpdated(function(){i.value.refresh(),t()}),n({scrollToByIndex:function(e,t){i.value.scrollToByIndex(e,t=void 0===t?300:t)},scrollToByColumn:function(e){var t=l[0],e=t.wrapper.querySelector(".".concat(selectorPrefix,"-item .").concat(selectorPrefix,"-cell:nth-of-type(").concat(e,")"));t.scrollToElement(e)},scrollToByHeaderEl:function(e,t){i.value.scrollToByHeaderEl(e,t=void 0===t?300:t)}}),function(){return _createVNode("div",{class:selectorPrefix,ref:c},[(t=u(r.indicator.columns),_createVNode("div",{class:f.value,style:r.indicatorStyle},[_createVNode("div",{class:m.value(r.indicatorFixedWrapClassName),style:p.value(r.indicatorFixedWrapStyle,t?null==t?void 0:t.width:0)},[_createVNode("div",{class:"".concat(selectorPrefix,"-item")},[_createVNode("div",{class:v.value(t),style:null==t?void 0:t.style},[d(t,r.indicator.dataSource,-1,-1,-1)])])]),_createVNode("div",{class:y.value(r.indicatorAutoWrapClassName),style:r.indicatorAutoWrapStyle},[_createVNode("div",{class:"".concat(selectorPrefix,"-item")},[r.indicator.columns.filter(function(e){return e!==t}).map(function(e,t){return _createVNode("div",{key:e.dataIndex,class:v.value(e),style:p.value(e.style,e.width)},[d(e,r.indicator.dataSource,-1,-1,t)])})])])])),a()]);var t}}});export{cascadeComparedProps};
//# sourceMappingURL=cascadecompared.js.map
