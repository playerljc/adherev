{"version":3,"file":"configprovider.js","sources":["configprovider.js"],"sourcesContent":["\"use strict\";\n\nrequire(\"core-js/modules/es.object.define-property.js\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.configProviderProps = void 0;\nvar tslib_1 = require(\"tslib\");\nvar vue_1 = require(\"vue\");\nvar vue_types_1 = require(\"vue-types\");\nvar lodash_debounce_1 = tslib_1.__importDefault(require(\"lodash.debounce\"));\nvar adherev_ui_hooks_1 = tslib_1.__importDefault(require(\"@baifendian/adherev-ui-hooks\"));\nvar adherev_util_intl_1 = tslib_1.__importDefault(require(\"@baifendian/adherev-util-intl\"));\nvar adherev_util_mixins_1 = tslib_1.__importDefault(require(\"@baifendian/adherev-util-mixins\"));\nvar adherev_util_resource_1 = tslib_1.__importDefault(require(\"@baifendian/adherev-util-resource\"));\nexports.configProviderProps = {\n  intl: (0, vue_types_1.object)().def(function () {\n    return {\n      lang: 'zh_CN',\n      locales: {},\n      prefix: 'local',\n      mainLanguage: 'zh_CN'\n    };\n  })\n};\nvar forceUpdate = adherev_util_mixins_1.default.forceUpdate;\nvar useForceUpdate = adherev_ui_hooks_1.default.useForceUpdate;\nvar ConfigProvider = (0, vue_1.defineComponent)({\n  name: 'adv-configprovider',\n  mixins: [forceUpdate],\n  props: exports.configProviderProps,\n  emits: ['intlInit', 'propsChange'],\n  setup: function setup(props, _a) {\n    var slots = _a.slots,\n      emit = _a.emit;\n    var isIntlInit = (0, vue_1.ref)(false);\n    var $forceUpdate = useForceUpdate();\n    var propsChangeHandler = (0, lodash_debounce_1.default)(function () {\n      emit('propsChange');\n    }, 200);\n    var init = function init() {\n      return adherev_util_intl_1.default.init({\n        prefix: props.intl.prefix || 'local',\n        currentLocale: props.intl.lang,\n        locales: props.intl.locales || {},\n        mainLanguage: props.intl.mainLanguage || 'zh_CN'\n      }, adherev_util_intl_1.default.isInit()).then(function () {\n        adherev_util_resource_1.default.Dict.value.LocalsMoment.value[props.intl.lang]();\n        if (!isIntlInit.value) {\n          isIntlInit.value = true;\n          (0, vue_1.nextTick)(function () {\n            emit('intlInit');\n          });\n        } else {\n          $forceUpdate();\n          (0, vue_1.nextTick)(propsChangeHandler);\n        }\n      });\n    };\n    (0, vue_1.watch)([function () {\n      return props.intl.lang;\n    }, function () {\n      return props.intl.locales;\n    }, function () {\n      return props.intl.prefix;\n    }, function () {\n      return props.intl.mainLanguage;\n    }], function () {\n      return init();\n    });\n    (0, vue_1.onMounted)(function () {\n      return init();\n    });\n    return function () {\n      var _a;\n      return isIntlInit.value ? (_a = slots === null || slots === void 0 ? void 0 : slots.default) === null || _a === void 0 ? void 0 : _a.call(slots) : null;\n    };\n  }\n});\nexports.default = ConfigProvider;"],"names":["require","Object","defineProperty","exports","value","configProviderProps","tslib_1","vue_1","vue_types_1","lodash_debounce_1","__importDefault","adherev_ui_hooks_1","adherev_util_intl_1","adherev_util_mixins_1","adherev_util_resource_1","forceUpdate","intl","object","def","lang","locales","prefix","mainLanguage","default","useForceUpdate","ConfigProvider","defineComponent","name","mixins","props","emits","setup","_a","init","currentLocale","isInit","then","Dict","LocalsMoment","isIntlInit","$forceUpdate","nextTick","propsChangeHandler","emit","slots","ref","watch","onMounted","call"],"mappings":"AAAA,aAEAA,QAAQ,8CAA8C,EACtDC,OAAOC,eAAeC,QAAS,aAAc,CAC3CC,MAAO,CAAA,CACT,CAAC,EACDD,QAAQE,oBAAsB,KAAA,EAC9B,IAAIC,QAAUN,QAAQ,OAAO,EACzBO,MAAQP,QAAQ,KAAK,EACrBQ,YAAcR,QAAQ,WAAW,EACjCS,kBAAoBH,QAAQI,gBAAgBV,QAAQ,iBAAiB,CAAC,EACtEW,mBAAqBL,QAAQI,gBAAgBV,QAAQ,8BAA8B,CAAC,EACpFY,oBAAsBN,QAAQI,gBAAgBV,QAAQ,+BAA+B,CAAC,EACtFa,sBAAwBP,QAAQI,gBAAgBV,QAAQ,iCAAiC,CAAC,EAC1Fc,wBAA0BR,QAAQI,gBAAgBV,QAAQ,mCAAmC,CAAC,EAW9Fe,aAVJZ,QAAQE,oBAAsB,CAC5BW,MAAM,EAAIR,YAAYS,QAAQ,EAAEC,IAAI,WAClC,MAAO,CACLC,KAAM,QACNC,QAAS,GACTC,OAAQ,QACRC,aAAc,OAChB,CACF,CAAC,CACH,EACkBT,sBAAsBU,QAAQR,aAC5CS,eAAiBb,mBAAmBY,QAAQC,eAC5CC,gBAAiB,EAAIlB,MAAMmB,iBAAiB,CAC9CC,KAAM,qBACNC,OAAQ,CAACb,aACTc,MAAO1B,QAAQE,oBACfyB,MAAO,CAAC,WAAY,eACpBC,MAAO,SAAeF,EAAOG,GAQhB,SAAPC,IACF,OAAOrB,oBAAoBW,QAAQU,KAAK,CACtCZ,OAAQQ,EAAMb,KAAKK,QAAU,QAC7Ba,cAAeL,EAAMb,KAAKG,KAC1BC,QAASS,EAAMb,KAAKI,SAAW,GAC/BE,aAAcO,EAAMb,KAAKM,cAAgB,OAC3C,EAAGV,oBAAoBW,QAAQY,OAAO,CAAC,EAAEC,KAAK,WAC5CtB,wBAAwBS,QAAQc,KAAKjC,MAAMkC,aAAalC,MAAMyB,EAAMb,KAAKG,MAAM,EAC1EoB,EAAWnC,OAMdoC,EAAa,GACb,EAAIjC,MAAMkC,UAAUC,CAAkB,IANtCH,EAAWnC,MAAQ,CAAA,GACnB,EAAIG,MAAMkC,UAAU,WAClBE,EAAK,UAAU,CACjB,CAAC,EAKL,CAAC,CACH,CAzBA,IAAIC,EAAQZ,EAAGY,MACbD,EAAOX,EAAGW,KACRJ,GAAa,EAAIhC,MAAMsC,KAAK,CAAA,CAAK,EACjCL,EAAehB,eAAe,EAC9BkB,GAAqB,EAAIjC,kBAAkBc,SAAS,WACtDoB,EAAK,aAAa,CACpB,EAAG,GAAG,EAkCN,OAdA,EAAIpC,MAAMuC,OAAO,CAAC,WAChB,OAAOjB,EAAMb,KAAKG,IACpB,EAAG,WACD,OAAOU,EAAMb,KAAKI,OACpB,EAAG,WACD,OAAOS,EAAMb,KAAKK,MACpB,EAAG,WACD,OAAOQ,EAAMb,KAAKM,YACpB,GACSW,CACR,GACD,EAAI1B,MAAMwC,WACDd,CACR,EACM,WACL,IAAID,EACJ,OAAOO,EAAWnC,MAAQ,OAAC4B,EAAKY,MAAAA,EAAqC,KAAA,EAASA,EAAMrB,SAAqC,KAAA,EAASS,EAAGgB,KAAKJ,CAAK,EAAI,IACrJ,CACF,CACF,CAAC,EACDzC,QAAQoB,QAAUE"}